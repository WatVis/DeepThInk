{"ast":null,"code":"import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";import _assertThisInitialized from\"@babel/runtime/helpers/assertThisInitialized\";import _inherits from\"@babel/runtime/helpers/inherits\";import _possibleConstructorReturn from\"@babel/runtime/helpers/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/getPrototypeOf\";function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect===\"undefined\"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy===\"function\")return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true;}catch(e){return false;}}import React,{Component,useRef}from'react';import Text from\"react-native-web/dist/exports/Text\";import View from\"react-native-web/dist/exports/View\";import Platform from\"react-native-web/dist/exports/Platform\";import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import Dimensions from\"react-native-web/dist/exports/Dimensions\";import Canvas,{Image as CanvasImage}from'react-native-canvas';import{generateStyle}from\"../styles/styles\";import Point from\"../classes/Point\";var device=Dimensions.get('window');var styles=StyleSheet.create(generateStyle(device));var DrawCanvas=function(_Component){_inherits(DrawCanvas,_Component);var _super=_createSuper(DrawCanvas);function DrawCanvas(props){var _this;_classCallCheck(this,DrawCanvas);_this=_super.call(this,props);_this.state={strokes:[]};_this.onDrawMove=function(event){var posX=event.nativeEvent.locationX;var posY=event.nativeEvent.locationY;var p=new Point(posX,posY,_this.props.thickness,\"move\");_this.updateCanvas(p);_this.setState({strokes:_this.state.strokes.concat(p)});};_this.onDrawStart=function(event){console.log(\"Got start\");var posX=event.nativeEvent.locationX;var posY=event.nativeEvent.locationY;var p=new Point(posX,posY,_this.props.thickness,\"start\");_this.updateCanvas(p);_this.setState({strokes:_this.state.strokes.concat(p)});};_this.onDrawEnd=function(event){var posX=event.nativeEvent.locationX;var posY=event.nativeEvent.locationY;var p=new Point(posX,posY,_this.props.thickness,\"end\");_this.updateCanvas(p);_this.setState({strokes:_this.state.strokes.concat(p)});};_this.updateCanvas=function(point){if(!_this.canvasRef){return;}var canvas=_this.canvasRef.current;var len=_this.state.strokes.length;console.log(\"canvas is\",canvas==null);if(canvas&&len>0){var lastPoint=_this.state.strokes[len-1];var secondLastPoint=_this.state.strokes[len-2];var x=point.x,y=point.y,type=point.type,thickness=point.thickness;console.log(\"thickness is\",thickness);var ctx=canvas.getContext(\"2d\");ctx.lineWidth=thickness;switch(type){case\"start\":ctx.moveTo(x,y);ctx.beginPath();ctx.lineTo(x,y);break;case\"end\":break;case\"move\":ctx.beginPath();ctx.moveTo(lastPoint.x,lastPoint.y);ctx.globalCompositeOperation='source-over';ctx.lineTo(x,y);break;}ctx.fillStyle='black';ctx.strokeStyle='black';ctx.lineJoin=ctx.lineCap='round';ctx.closePath();ctx.stroke();}};_this.handleCanvas=function(canvas){console.log(\"handling canvas\",canvas);var ctx=canvas.getContext('2d');canvas.width=styles.drawBox.width;canvas.height=styles.drawBox.height;_this.canvasRef=canvas;_this.canvasRef.current=canvas;};_this.handleCanvas=_this.handleCanvas.bind(_assertThisInitialized(_this));_this.thickness=props.thickness;_this.canvasRef=null;return _this;}_createClass(DrawCanvas,[{key:\"render\",value:function render(){if(Platform.OS===\"web\"){React.createElement(View,{style:styles.drawBox,onTouchMove:this.onDrawMove},\"onTouchStart=\",this.onDrawStart,\"onTouchEnd=\",this.onDrawEnd,\"onClick=\",this.onDrawStart,\">\",React.createElement(\"canvas\",{style:{\"borderWidth\":20,\"border\":\"black\"},width:styles.drawBox.width,height:styles.drawBox.height,ref:this.handleCanvas}));}return React.createElement(View,{onTouchMove:this.onDrawMove,onTouchStart:this.onDrawStart,onTouchEnd:this.onDrawEnd,style:styles.drawBox},React.createElement(Canvas,{style:{\"borderWidth\":20},width:styles.drawBox.width,height:styles.drawBox.height,ref:this.handleCanvas}));}}]);return DrawCanvas;}(Component);export{DrawCanvas as default};","map":{"version":3,"sources":["/mnt/427bdd3d-17db-4d44-b722-f3e4fd35d808/projects/gauGAN/hai-art/client-expo/components/DrawCanvas.js"],"names":["React","Component","useRef","Canvas","Image","CanvasImage","generateStyle","Point","device","Dimensions","get","styles","StyleSheet","create","DrawCanvas","props","state","strokes","onDrawMove","event","posX","nativeEvent","locationX","posY","locationY","p","thickness","updateCanvas","setState","concat","onDrawStart","console","log","onDrawEnd","point","canvasRef","canvas","current","len","length","lastPoint","secondLastPoint","x","y","type","ctx","getContext","lineWidth","moveTo","beginPath","lineTo","globalCompositeOperation","fillStyle","strokeStyle","lineJoin","lineCap","closePath","stroke","handleCanvas","width","drawBox","height","bind","Platform","OS"],"mappings":"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","sourcesContent":["import React, { Component, useRef } from 'react';\nimport {Text, View, Platform, StyleSheet, Dimensions} from 'react-native';\nimport Canvas, {Image as CanvasImage} from 'react-native-canvas';\nimport { generateStyle } from '../styles/styles';\nimport Point from \"../classes/Point\";\n\nvar device = Dimensions.get('window');\n\n\nconst styles = StyleSheet.create(generateStyle(device));\n\nexport default class DrawCanvas extends Component {\n\n\n\tstate = {\n\t\tstrokes: []\n\t}\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.handleCanvas = this.handleCanvas.bind(this);\n\t\tthis.thickness = props.thickness\n\t\tthis.canvasRef = null;\n\n\t  }\n\t\n    onDrawMove = (event) => {\n\t\t// console.log(event.nativeEvent)\n        // console.log(\"hello\");\n\t\tvar posX = event.nativeEvent.locationX\n\t\tvar posY = event.nativeEvent.locationY\n\n\t\tvar p = new Point(posX, posY, this.props.thickness, \"move\")\n\t\tthis.updateCanvas(p)\n\n\t\t// Create stroke move object\n\t\tthis.setState({\n\t\t\tstrokes: this.state.strokes.concat(p)\n\t\t})\n\n\t\t\n    }\n\n\tonDrawStart = (event) => {\n\t\tconsole.log(\"Got start\")\n\t\tvar posX = event.nativeEvent.locationX\n\t\tvar posY = event.nativeEvent.locationY\n\n\t\t// Create stroke move object\n\t\tvar p = new Point(posX, posY, this.props.thickness, \"start\")\n\t\tthis.updateCanvas(p)\n\n\t\tthis.setState({\n\t\t\tstrokes: this.state.strokes.concat(p)\n\t\t} )\n\n\t}\n\n\tonDrawEnd = (event) => {\n\t\tvar posX = event.nativeEvent.locationX\n\t\tvar posY = event.nativeEvent.locationY\n\n\t\t// Create stroke move object\n\t\tvar p = new Point(posX, posY, this.props.thickness, \"end\")\n\t\tthis.updateCanvas(p)\n\n\t\tthis.setState({\n\t\t\tstrokes: this.state.strokes.concat(p)\n\t\t} )\n\t}\n\n\tupdateCanvas = (point) => {\n\t// draw a point\n\t\tif (!this.canvasRef) {\n\t\t\treturn;\n\t\t}\n\t\tvar canvas = this.canvasRef.current\n\t\tvar len = this.state.strokes.length\n\t\tconsole.log(\"canvas is\", canvas == null)\n\n\t\tif (canvas && len > 0) {\n\t\t\tvar lastPoint = this.state.strokes[len-1]\n\t\t\tvar secondLastPoint = this.state.strokes[len-2]\n\t\t\tvar {x, y, type, thickness} = point\n\t\t\tconsole.log(\"thickness is\", thickness)\n\t\t\tvar ctx = canvas.getContext(\"2d\");\n\t\t\tctx.lineWidth = thickness\n\n\t\t\tswitch (type) {\n\t\t\t\tcase \"start\":\n\t\t\t\t\tctx.moveTo(x, y)\n\t\t\t\t\tctx.beginPath();\n\t\t\t\t\tctx.lineTo(x, y);\n\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"end\":\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"move\":\n\t\t\t\t\tctx.beginPath();\n\n\t\t\t\t\tctx.moveTo(lastPoint.x, lastPoint.y)\n\t\t\t\t\tctx.globalCompositeOperation = 'source-over';\n\t\t\t\t\tctx.lineTo(x, y);\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tctx.fillStyle = 'black';\n\t\t\tctx.strokeStyle = 'black';\n\t\t\tctx.lineJoin = ctx.lineCap = 'round';\n\t\t\tctx.closePath()\n\t\t\tctx.stroke();\t\t\t\n\n\t\t}\n\n\t}\n\n\thandleCanvas = (canvas) => {\n\t\tconsole.log(\"handling canvas\", canvas)\n\n\t\tconst ctx = canvas.getContext('2d');\n\t\tcanvas.width = styles.drawBox.width;\n\t\tcanvas.height = styles.drawBox.height;\n\n\t\tthis.canvasRef = canvas;\n\t\tthis.canvasRef.current = canvas;\n\n\t}\n   \n    render() {\n      if (Platform.OS === \"web\") {\n\t\t<View\n\t\tstyle= {styles.drawBox}\n\t\tonTouchMove={this.onDrawMove}>\n\t\tonTouchStart={this.onDrawStart}\n\t\tonTouchEnd={this.onDrawEnd}\n      \tonClick={this.onDrawStart}\n\t\t>\n\t\n\n        <canvas style={{\"borderWidth\": 20, \"border\":\"black\"}} width={styles.drawBox.width} height={styles.drawBox.height} ref={this.handleCanvas} />\n\t\t</View>\n\t}\n    \n    return (\n\t\t<View\n\t\tonTouchMove={this.onDrawMove}\n\t\tonTouchStart={this.onDrawStart}\n\t\tonTouchEnd={this.onDrawEnd}\n\t\tstyle= {styles.drawBox}\n\t\t>\n        <Canvas style={{\"borderWidth\": 20}}width={styles.drawBox.width} height={styles.drawBox.height} ref={this.handleCanvas} />\n\t\t</View>\n    )\n    }\n   \n    \n  }\n\n"]},"metadata":{},"sourceType":"module"}