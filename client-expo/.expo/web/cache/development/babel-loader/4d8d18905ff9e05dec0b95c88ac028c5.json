{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nvar _jsxFileName = \"C:\\\\Users\\\\aapri\\\\Repo\\\\draw-therapy\\\\client-expo\\\\App.js\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component } from 'react';\nimport AppRegistry from \"react-native-web/dist/exports/AppRegistry\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport Dimensions from \"react-native-web/dist/exports/Dimensions\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport Platform from \"react-native-web/dist/exports/Platform\";\nimport DrawCanvas from \"./components/DrawCanvas\";\nimport Slider from '@react-native-community/slider';\nimport axios from 'axios';\nimport colorMap from \"./constants/colorMap.js\";\nimport styleTransferOptions from \"./constants/styleTransferOptions.js\";\nimport messageKinds from \"./constants/messageKinds.js\";\nimport { onOpen, onClose, onMessage, onError, sendStroke, sendStrokeEnd, sendStrokeStart } from \"./api/websocketApi.js\";\nimport { sendRequest, sendRequestStyle } from \"./api/modelApi.js\";\nimport { hello, generateStyle } from \"./styles/styles.js\";\nimport Point from \"./classes/Point\";\nvar device = Dimensions.get('window');\n\nvar App = function (_Component) {\n  _inherits(App, _Component);\n\n  var _super = _createSuper(App);\n\n  function App(props) {\n    var _this;\n\n    _classCallCheck(this, App);\n\n    _this = _super.call(this, props);\n    _this.state = {\n      imageData: 'data:image/png;base64,',\n      generatedImageData: 'data:image/png;base64,',\n      stylizedImageData: 'data:image/png;base64,',\n      displayedImageData: 'data:image/png;base64,',\n      style: 'none',\n      color: '#384f83',\n      thickness: 10,\n      ownStroke: [],\n      collaboratorStroke: [],\n      socket: Platform.OS === \"web\" ? new WebSocket('ws://localhost:8080/ws') : new WebSocket('ws://10.0.2.2:8080/ws')\n    };\n\n    _this.grabPixels = function _callee() {\n      var getImage;\n      return _regeneratorRuntime.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              getImage = _this.refs.drawCanvasRef.getBase64().then(function (value) {\n                var resultImage = value.split(';base64,')[1];\n                console.log(\"result image is\", resultImage);\n\n                _this.setState(function (prevState) {\n                  return _objectSpread(_objectSpread({}, prevState), {}, {\n                    imageData: resultImage\n                  });\n                }, _this.sendRequestHelper);\n              });\n\n            case 1:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    _this.sendRequestHelper = function _callee2() {\n      return _regeneratorRuntime.async(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _this.state.socket.send(JSON.stringify({\n                kind: messageKinds.MESSAGE_GENERATE,\n                data: {\n                  imageData: _this.state.imageData\n                }\n              }));\n\n            case 1:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    _this.sendRequestStyleHelper = function _callee3(newStyle) {\n      return _regeneratorRuntime.async(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _this.state.socket.send(JSON.stringify({\n                kind: messageKinds.MESSAGE_STYLIZE,\n                data: {\n                  imageData: _this.state.generatedImageData,\n                  style: newStyle\n                }\n              }));\n\n            case 1:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    _this.handleThickness = function (sliderValue) {\n      _this.setState(function (prevState) {\n        return _objectSpread(_objectSpread({}, prevState), {}, {\n          thickness: sliderValue\n        });\n      });\n\n      console.log('thickness is now', sliderValue);\n    };\n\n    _this.onMesageHandler = function (event) {\n      var messages = event.data.split('\\n');\n\n      for (var i = 0; i < messages.length; i++) {\n        var message = JSON.parse(messages[i]);\n\n        _this.executeMessage(message);\n      }\n    };\n\n    _this.executeMessage = function (message) {\n      switch (message.kind) {\n        case messageKinds.MESSAGE_STROKE_START:\n          console.log(\"RECEIVED STROKE STARTT\", message);\n\n          _this.setState(function (prevState) {\n            return _objectSpread(_objectSpread({}, prevState), {}, {\n              collaboratorStroke: [].concat(_toConsumableArray(prevState.collaboratorStroke), [new Point(message.point.x, message.point.y, message.thickness, message.color, \"start\")])\n            });\n          });\n\n          break;\n\n        case messageKinds.MESSAGE_STROKE:\n          _this.setState(function (prevState) {\n            return _objectSpread(_objectSpread({}, prevState), {}, {\n              collaboratorStroke: [].concat(_toConsumableArray(prevState.collaboratorStroke), [new Point(message.point.x, message.point.y, message.thickness, message.color, \"move\")])\n            });\n          });\n\n          break;\n\n        case messageKinds.MESSAGE_STROKE_END:\n          _this.setState(function (prevState) {\n            return _objectSpread(_objectSpread({}, prevState), {}, {\n              collaboratorStroke: []\n            });\n          });\n\n          break;\n\n        case messageKinds.MESSAGE_GENERATE:\n          console.log('got generate mesage here', message);\n\n          _this.setState(function (prevState) {\n            return _objectSpread(_objectSpread({}, prevState), {}, {\n              generatedImageData: message.imageData,\n              displayedImageData: message.imageData\n            });\n          });\n\n          break;\n\n        case messageKinds.MESSAGE_STYLIZE:\n          console.log('image stylize', message);\n\n          _this.setState(function (prevState) {\n            return _objectSpread(_objectSpread({}, prevState), {}, {\n              style: message.style,\n              stylizedImageData: message.imageData,\n              displayedImageData: message.imageData\n            });\n          });\n\n          break;\n      }\n    };\n\n    _this.sendRequestHelper = _this.sendRequestHelper.bind(_assertThisInitialized(_this));\n    return _this;\n  }\n\n  _createClass(App, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      console.log('Attempting connection');\n\n      this.state.socket.onopen = function () {\n        onOpen(_this2.state.socket, {\n          canvasWidth: styles.drawBox.width,\n          canvasHeight: styles.drawBox.height\n        });\n      };\n\n      this.state.socket.onclose = function (event) {\n        onClose(event);\n      };\n\n      this.state.socket.onerror = function (error) {\n        onError(error);\n      };\n\n      this.state.socket.onmessage = function (event) {\n        _this2.onMesageHandler(event);\n      };\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      return React.createElement(View, {\n        style: styles.container,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 213,\n          columnNumber: 7\n        }\n      }, React.createElement(View, {\n        style: styles.drawGroup,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 214,\n          columnNumber: 9\n        }\n      }, React.createElement(DrawCanvas, {\n        ref: \"drawCanvasRef\",\n        style: {\n          flex: 1\n        },\n        thickness: this.state.thickness,\n        color: this.state.color,\n        socket: this.state.socket,\n        otherStrokes: this.state.collaboratorStroke,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 216,\n          columnNumber: 13\n        }\n      }), React.createElement(View, {\n        style: styles.toolGroup,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 225,\n          columnNumber: 13\n        }\n      }, React.createElement(View, {\n        style: styles.strokeGroup,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 227,\n          columnNumber: 15\n        }\n      }, React.createElement(Text, {\n        style: {\n          color: '#07235c',\n          fontWeight: 'bold',\n          fontSize: device.height * 0.023\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 228,\n          columnNumber: 17\n        }\n      }, \"Stroke size:\"), React.createElement(Slider, {\n        style: {\n          width: device.width * 0.15,\n          height: device.height * 0.03,\n          marginBottom: 10\n        },\n        minimumValue: 1,\n        maximumValue: device.width * device.height * (1 / Math.pow(10, 4)),\n        minimumTrackTintColor: \"#000000\",\n        maximumTrackTintColor: \"#000000\",\n        onSlidingComplete: this.handleThickness,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 236,\n          columnNumber: 17\n        }\n      })), React.createElement(View, {\n        style: styles.tempButtons,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 252,\n          columnNumber: 15\n        }\n      }, React.createElement(View, {\n        style: {\n          justifyContent: 'flex-end',\n          paddingHorizontal: 5\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 253,\n          columnNumber: 17\n        }\n      }, React.createElement(Button, {\n        color: \"#073ead\",\n        title: \"undo!\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 255,\n          columnNumber: 19\n        }\n      })), React.createElement(View, {\n        style: {\n          justifyContent: 'flex-end',\n          paddingHorizontal: 5\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 257,\n          columnNumber: 17\n        }\n      }, React.createElement(Button, {\n        color: \"#073ead\",\n        title: \"redo!\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 259,\n          columnNumber: 19\n        }\n      })), React.createElement(View, {\n        style: {\n          justifyContent: 'flex-end',\n          paddingHorizontal: 5\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 261,\n          columnNumber: 17\n        }\n      }, React.createElement(Button, {\n        color: \"#07235c\",\n        title: \"erase\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 263,\n          columnNumber: 19\n        }\n      })))), React.createElement(View, {\n        style: {\n          flexDirection: 'row',\n          justifyContent: 'space-around',\n          alignItems: 'center'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 268,\n          columnNumber: 11\n        }\n      }, React.createElement(View, {\n        style: {\n          flexDirection: 'row'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 274,\n          columnNumber: 13\n        }\n      }, colorMap.colors.map(function (obj) {\n        return React.createElement(View, {\n          style: {\n            margin: 2\n          },\n          __self: _this3,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 277,\n            columnNumber: 19\n          }\n        }, React.createElement(TouchableOpacity, {\n          style: [styles.functionButton, {\n            backgroundColor: obj.color\n          }],\n          onPress: function onPress() {\n            _this3.setState({\n              color: obj.color\n            });\n          },\n          __self: _this3,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 278,\n            columnNumber: 21\n          }\n        }, React.createElement(Text, {\n          style: {\n            color: 'white',\n            fontSize: device.height * 0.025\n          },\n          __self: _this3,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 286,\n            columnNumber: 23\n          }\n        }, obj.label)));\n      })), React.createElement(Text, {\n        style: {\n          marginRight: 8,\n          fontSize: device.height * 0.025\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 298,\n          columnNumber: 13\n        }\n      }, this.state.message)), React.createElement(View, {\n        style: {\n          flexDirection: 'row',\n          justifyContent: 'space-around',\n          alignItems: 'center'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 303,\n          columnNumber: 11\n        }\n      }, React.createElement(View, {\n        style: {\n          flexDirection: 'row'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 309,\n          columnNumber: 13\n        }\n      }, React.createElement(View, {\n        style: {\n          margin: 2\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 311,\n          columnNumber: 15\n        }\n      }, React.createElement(TouchableOpacity, {\n        style: [styles.functionButton, {\n          backgroundColor: 'gray'\n        }],\n        onPress: function onPress() {\n          _this3.setState(function (prevState) {\n            return _objectSpread(_objectSpread({}, prevState), {}, {\n              displayedImageData: _this3.state.generatedImageData\n            });\n          });\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 312,\n          columnNumber: 17\n        }\n      }, React.createElement(Text, {\n        style: {\n          color: 'white',\n          fontSize: 20\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 320,\n          columnNumber: 19\n        }\n      }, \" None \"))), styleTransferOptions.styles.map(function (obj) {\n        return React.createElement(View, {\n          style: {\n            margin: 2\n          },\n          __self: _this3,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 326,\n            columnNumber: 19\n          }\n        }, React.createElement(TouchableOpacity, {\n          style: [styles.functionButton, {\n            backgroundColor: 'gray'\n          }],\n          onPress: function onPress() {\n            _this3.sendRequestStyleHelper(obj.name);\n          },\n          __self: _this3,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 327,\n            columnNumber: 21\n          }\n        }, React.createElement(Text, {\n          style: {\n            color: 'white',\n            fontSize: device.height * 0.024\n          },\n          __self: _this3,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 332,\n            columnNumber: 23\n          }\n        }, obj.label)));\n      })), React.createElement(Text, {\n        style: {\n          marginRight: 8,\n          fontSize: device.height * 0.024\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 344,\n          columnNumber: 13\n        }\n      }, this.state.message))), React.createElement(View, {\n        style: styles.genGroup,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 350,\n          columnNumber: 9\n        }\n      }, React.createElement(View, {\n        style: styles.generatedImageBox,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 352,\n          columnNumber: 11\n        }\n      }, this.state.displayedImageData != null ? React.createElement(Image, {\n        style: styles.generatedImage,\n        source: {\n          uri: this.state.displayedImageData\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 354,\n          columnNumber: 15\n        }\n      }) : null), React.createElement(View, {\n        style: styles.genButton,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 361,\n          columnNumber: 11\n        }\n      }, React.createElement(TouchableOpacity, {\n        style: [styles.functionButton, {\n          backgroundColor: \"#841584\"\n        }],\n        onPress: this.grabPixels.bind(this),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 362,\n          columnNumber: 13\n        }\n      }, React.createElement(Text, {\n        style: {\n          color: 'white',\n          fontSize: device.height * 0.024\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 366,\n          columnNumber: 15\n        }\n      }, \"Generate!\")))));\n    }\n  }]);\n\n  return App;\n}(Component);\n\nexport { App as default };\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    flexDirection: 'row',\n    justifyContent: 'space-evenly',\n    backgroundColor: 'skyblue',\n    paddingTop: device.height * 0.02\n  },\n  drawBox: {\n    backgroundColor: 'white',\n    borderColor: 'lightblue',\n    borderWidth: 10,\n    width: device.width * 0.5,\n    height: device.height * 0.85\n  },\n  generatedImageBox: {\n    borderWidth: 10,\n    borderColor: 'lightblue',\n    width: device.width * 0.45,\n    height: device.height * 0.85\n  },\n  generatedImage: {\n    width: device.width * 0.45,\n    height: device.height * 0.85\n  },\n  functionButton: {\n    padding: 4,\n    borderRadius: 5\n  },\n  drawGroup: {\n    flexDirection: 'column'\n  },\n  genGroup: {\n    flexDirection: 'column'\n  },\n  genButton: {\n    margin: 2,\n    width: 200\n  },\n  strokeGroup: {\n    flexDirection: 'column',\n    alignItems: 'center'\n  },\n  tempButtons: {\n    height: 40,\n    width: 70,\n    flexDirection: 'row'\n  },\n  toolGroup: {\n    flexDirection: 'row'\n  }\n});","map":{"version":3,"sources":["C:/Users/aapri/Repo/draw-therapy/client-expo/App.js"],"names":["React","Component","DrawCanvas","Slider","axios","colorMap","styleTransferOptions","messageKinds","onOpen","onClose","onMessage","onError","sendStroke","sendStrokeEnd","sendStrokeStart","sendRequest","sendRequestStyle","hello","generateStyle","Point","device","Dimensions","get","App","props","state","imageData","generatedImageData","stylizedImageData","displayedImageData","style","color","thickness","ownStroke","collaboratorStroke","socket","Platform","OS","WebSocket","grabPixels","getImage","refs","drawCanvasRef","getBase64","then","value","resultImage","split","console","log","setState","prevState","sendRequestHelper","send","JSON","stringify","kind","MESSAGE_GENERATE","data","sendRequestStyleHelper","newStyle","MESSAGE_STYLIZE","handleThickness","sliderValue","onMesageHandler","event","messages","i","length","message","parse","executeMessage","MESSAGE_STROKE_START","point","x","y","MESSAGE_STROKE","MESSAGE_STROKE_END","bind","onopen","canvasWidth","styles","drawBox","width","canvasHeight","height","onclose","onerror","error","onmessage","container","drawGroup","flex","toolGroup","strokeGroup","fontWeight","fontSize","marginBottom","Math","pow","tempButtons","justifyContent","paddingHorizontal","flexDirection","alignItems","colors","map","obj","margin","functionButton","backgroundColor","label","marginRight","name","genGroup","generatedImageBox","generatedImage","uri","genButton","StyleSheet","create","paddingTop","borderColor","borderWidth","padding","borderRadius"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\r\nimport {\r\n  AppRegistry,\r\n  StyleSheet,\r\n  View,\r\n  Button,\r\n  Alert,\r\n  Dimensions,\r\n  Image,\r\n  TouchableOpacity,\r\n  Text,\r\n  Platform\r\n} from 'react-native';\r\n\r\nimport DrawCanvas from './components/DrawCanvas';\r\n\r\nimport Slider from '@react-native-community/slider';\r\n// import Snackbar from 'react-native-snackbar';\r\nimport axios from 'axios';\r\nimport colorMap from './constants/colorMap.js';\r\nimport styleTransferOptions from './constants/styleTransferOptions.js';\r\nimport messageKinds from './constants/messageKinds.js';\r\nimport {\r\n  onOpen,\r\n  onClose,\r\n  onMessage,\r\n  onError,\r\n  sendStroke,\r\n  sendStrokeEnd,\r\n  sendStrokeStart,\r\n} from './api/websocketApi.js';\r\nimport {sendRequest, sendRequestStyle} from './api/modelApi.js';\r\nimport {hello, generateStyle} from './styles/styles.js';\r\nimport Point from './classes/Point';\r\nvar device = Dimensions.get('window');\r\n\r\n\r\n// Connect to Go backend\r\n// for web\r\n// for android\r\n// let this.state.socket = new WebSocket('ws://10.0.2.2:8080/ws');\r\n\r\n// Create dynamic style based on device width/height\r\n// const styles = StyleSheet.create(generateStyle(device));\r\n\r\nexport default class App extends Component {\r\n  // React state: store the image data\r\n  state = {\r\n    imageData: 'data:image/png;base64,', // raw image data of the segmentation image\r\n    generatedImageData: 'data:image/png;base64,', // raw image data of the generated image\r\n    stylizedImageData: 'data:image/png;base64,', // raw image data of stylized generated image\r\n    displayedImageData: 'data:image/png;base64,', // raw image data of displayed image\r\n    style: 'none', // selected style\r\n    color: '#384f83', // pen color\r\n    thickness: 10, // stroke thickness\r\n    ownStroke: [], // client stroke data\r\n    collaboratorStroke: [], // collaborator data\r\n    // socket: new WebSocket('ws://localhost:8080/ws')\r\n    socket:  Platform.OS === \"web\" ? new WebSocket('ws://localhost:8080/ws') : new WebSocket('ws://10.0.2.2:8080/ws')\r\n\r\n  };\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.sendRequestHelper = this.sendRequestHelper.bind(this);\r\n  }\r\n\r\n  // Run when component is first rendered\r\n  componentDidMount() {\r\n    console.log('Attempting connection');\r\n\r\n    // Setup this.state.socket handlers\r\n    this.state.socket.onopen = () => {\r\n      onOpen(this.state.socket, {\r\n        canvasWidth: styles.drawBox.width,\r\n        canvasHeight: styles.drawBox.height,\r\n      });\r\n    };\r\n    this.state.socket.onclose = event => {\r\n      onClose(event);\r\n    };\r\n    this.state.socket.onerror = error => {\r\n      onError(error);\r\n    };\r\n\r\n    this.state.socket.onmessage = event => {\r\n      this.onMesageHandler(event);\r\n    };\r\n  }\r\n\r\n  // Fetch image data from canvas\r\n  // Then call sendRequest to send the data to backend\r\n  grabPixels = async () => {\r\n    var getImage = this.refs.drawCanvasRef.getBase64().then((value) => {\r\n      var resultImage = value.split(';base64,')[1];\r\n      console.log(\"result image is\", resultImage)\r\n        this.setState(\r\n          prevState => ({\r\n            ...prevState,\r\n            imageData: resultImage,\r\n          }),\r\n          // Do callback to send to server after the imageData is set\r\n          this.sendRequestHelper,\r\n        );\r\n    })\r\n    \r\n  };\r\n\r\n  // Send request to model server to generate painting\r\n  sendRequestHelper = async () => {\r\n    this.state.socket.send(\r\n      JSON.stringify({\r\n        kind: messageKinds.MESSAGE_GENERATE,\r\n        data: {\r\n          imageData: this.state.imageData,\r\n        },\r\n      }),\r\n    );\r\n  };\r\n  // Send a request to the model server to stylize the generated painting\r\n  sendRequestStyleHelper = async newStyle => {\r\n    this.state.socket.send(\r\n      JSON.stringify({\r\n        kind: messageKinds.MESSAGE_STYLIZE,\r\n        data: {\r\n          imageData: this.state.generatedImageData,\r\n          style: newStyle,\r\n        },\r\n      }),\r\n    );\r\n  };\r\n\r\n  handleThickness = sliderValue => {\r\n    this.setState(prevState => ({\r\n      ...prevState,\r\n      thickness: sliderValue,\r\n    }));\r\n    console.log('thickness is now', sliderValue);\r\n  };\r\n\r\n\r\n\r\n  onMesageHandler = event => {\r\n    var messages = event.data.split('\\n');\r\n\r\n    for (var i = 0; i < messages.length; i++) {\r\n      var message = JSON.parse(messages[i]);\r\n      // console.log('Received message is', message);\r\n      this.executeMessage(message);\r\n    }\r\n    // console.log('B stringified is', JSON.stringify(this.canvas.getPaths()));\r\n  };\r\n\r\n  executeMessage = message => {\r\n    switch (message.kind) {\r\n      case messageKinds.MESSAGE_STROKE_START:\r\n        console.log(\"RECEIVED STROKE STARTT\", message)\r\n        // Append collaborator stroke\r\n        this.setState(prevState => ({\r\n          ...prevState,\r\n          collaboratorStroke: [\r\n            ...prevState.collaboratorStroke,\r\n            new Point(message.point.x, message.point.y, message.thickness, message.color, \"start\"),\r\n          ],\r\n        }));\r\n      \r\n        break;\r\n      case messageKinds.MESSAGE_STROKE:\r\n        \r\n        // console.log(\"received collaborator point\", message)\r\n        // Append collaborator stroke\r\n        this.setState(prevState => ({\r\n          ...prevState,\r\n          collaboratorStroke: [\r\n            ...prevState.collaboratorStroke,\r\n            new Point(message.point.x, message.point.y, message.thickness, message.color, \"move\"),\r\n          ],\r\n        }));\r\n        break;\r\n      case messageKinds.MESSAGE_STROKE_END:\r\n        this.setState(prevState => ({\r\n          ...prevState,\r\n          collaboratorStroke: [],\r\n        }));\r\n\r\n        break;\r\n      // User receives a generated image broadcasted from another user\r\n      case messageKinds.MESSAGE_GENERATE:\r\n        console.log('got generate mesage here', message);\r\n        this.setState(prevState => ({\r\n          ...prevState,\r\n          generatedImageData: message.imageData,\r\n          displayedImageData: message.imageData,\r\n        }));\r\n        break;\r\n      // User received a stylized image broadcasted from another user\r\n      case messageKinds.MESSAGE_STYLIZE:\r\n        console.log('image stylize', message);\r\n        this.setState(prevState => ({\r\n          ...prevState,\r\n          style: message.style,\r\n          stylizedImageData: message.imageData,\r\n          displayedImageData: message.imageData,\r\n        }));\r\n        break;\r\n    }\r\n  };\r\n\r\n\r\n\r\n  render() {\r\n    return (\r\n      <View style={styles.container}>\r\n        <View style={styles.drawGroup}>\r\n            {/* Main canvas */}\r\n            <DrawCanvas\r\n              ref=\"drawCanvasRef\"\r\n              style={{flex: 1}}\r\n              thickness={this.state.thickness}\r\n              color={this.state.color}\r\n              socket={this.state.socket}\r\n              otherStrokes={this.state.collaboratorStroke}\r\n            />\r\n\r\n            <View style={styles.toolGroup}>\r\n              {/* Thickness slider */}\r\n              <View style={styles.strokeGroup}>\r\n                <Text\r\n                  style={{\r\n                    color: '#07235c',\r\n                    fontWeight: 'bold',\r\n                    fontSize: device.height * 0.023,\r\n                  }}>\r\n                  Stroke size:\r\n                </Text>\r\n                <Slider\r\n                  style={{\r\n                    width: device.width * 0.15,\r\n                    height: device.height * 0.03,\r\n                    marginBottom: 10,\r\n                  }}\r\n                  minimumValue={1}\r\n                  maximumValue={\r\n                    device.width * device.height * (1 / Math.pow(10, 4))\r\n                  }\r\n                  minimumTrackTintColor=\"#000000\"\r\n                  maximumTrackTintColor=\"#000000\"\r\n                  onSlidingComplete={this.handleThickness}\r\n                />\r\n              </View>\r\n\r\n              <View style={styles.tempButtons}>\r\n                <View\r\n                  style={{justifyContent: 'flex-end', paddingHorizontal: 5}}>\r\n                  <Button color=\"#073ead\" title=\"undo!\" />\r\n                </View>\r\n                <View\r\n                  style={{justifyContent: 'flex-end', paddingHorizontal: 5}}>\r\n                  <Button color=\"#073ead\" title=\"redo!\" />\r\n                </View>\r\n                <View\r\n                  style={{justifyContent: 'flex-end', paddingHorizontal: 5}}>\r\n                  <Button color=\"#07235c\" title=\"erase\" />\r\n                </View>\r\n              </View>\r\n            </View>\r\n          {/* Color palette buttons */}\r\n          <View\r\n            style={{\r\n              flexDirection: 'row',\r\n              justifyContent: 'space-around',\r\n              alignItems: 'center',\r\n            }}>\r\n            <View style={{flexDirection: 'row'}}>\r\n              {colorMap.colors.map(obj => {\r\n                return (\r\n                  <View style={{margin: 2}}>\r\n                    <TouchableOpacity\r\n                      style={[\r\n                        styles.functionButton,\r\n                        {backgroundColor: obj.color},\r\n                      ]}\r\n                      onPress={() => {\r\n                        this.setState({color: obj.color});\r\n                      }}>\r\n                      <Text\r\n                        style={{\r\n                          color: 'white',\r\n                          fontSize: device.height * 0.025,\r\n                        }}>\r\n                        {obj.label}\r\n                      </Text>\r\n                    </TouchableOpacity>\r\n                  </View>\r\n                );\r\n              })}\r\n            </View>\r\n            <Text style={{marginRight: 8, fontSize: device.height * 0.025}}>\r\n              {this.state.message}\r\n            </Text>\r\n          </View>\r\n          {/* Style buttons */}\r\n          <View\r\n            style={{\r\n              flexDirection: 'row',\r\n              justifyContent: 'space-around',\r\n              alignItems: 'center',\r\n            }}>\r\n            <View style={{flexDirection: 'row'}}>\r\n              {/* None style button */}\r\n              <View style={{margin: 2}}>\r\n                <TouchableOpacity\r\n                  style={[styles.functionButton, {backgroundColor: 'gray'}]}\r\n                  onPress={() => {\r\n                    this.setState(prevState => ({\r\n                      ...prevState,\r\n                      displayedImageData: this.state.generatedImageData,\r\n                    }));\r\n                  }}>\r\n                  <Text style={{color: 'white', fontSize: 20}}> None </Text>\r\n                </TouchableOpacity>\r\n              </View>\r\n              {/* Programmatically render all style options */}\r\n              {styleTransferOptions.styles.map(obj => {\r\n                return (\r\n                  <View style={{margin: 2}}>\r\n                    <TouchableOpacity\r\n                      style={[styles.functionButton, {backgroundColor: 'gray'}]}\r\n                      onPress={() => {\r\n                        this.sendRequestStyleHelper(obj.name);\r\n                      }}>\r\n                      <Text\r\n                        style={{\r\n                          color: 'white',\r\n                          fontSize: device.height * 0.024,\r\n                        }}>\r\n                        {obj.label}\r\n                      </Text>\r\n                    </TouchableOpacity>\r\n                  </View>\r\n                );\r\n              })}\r\n            </View>\r\n            <Text style={{marginRight: 8, fontSize: device.height * 0.024}}>\r\n              {this.state.message}\r\n            </Text>\r\n          </View>\r\n        </View>\r\n\r\n        <View style={styles.genGroup}>\r\n          {/* Displayed image */}\r\n          <View style={styles.generatedImageBox}>\r\n            {this.state.displayedImageData != null ? (\r\n              <Image\r\n                style={styles.generatedImage}\r\n                source={{uri: this.state.displayedImageData}}\r\n              />\r\n            ) : null}\r\n          </View>\r\n          {/* Generate button */}\r\n          <View style={styles.genButton}>\r\n            <TouchableOpacity\r\n              style={[styles.functionButton, {backgroundColor: \"#841584\"}]}\r\n                onPress={this.grabPixels.bind(this)}\r\n              >\r\n              <Text\r\n                style={{\r\n                  color: 'white',\r\n                  fontSize: device.height * 0.024,\r\n                }}>\r\n                {\"Generate!\"}\r\n              </Text>\r\n            </TouchableOpacity>\r\n          </View>\r\n        </View>\r\n      </View>\r\n    );\r\n  }\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-evenly',\r\n    backgroundColor: 'skyblue',\r\n    paddingTop: device.height * 0.02,\r\n  },\r\n\r\n  drawBox: {\r\n    backgroundColor: 'white',\r\n    borderColor: 'lightblue',\r\n    borderWidth: 10,\r\n    width: device.width * 0.5,\r\n    height: device.height * 0.85,\r\n  },\r\n  generatedImageBox: {\r\n    borderWidth: 10,\r\n    borderColor: 'lightblue',\r\n\r\n    width: device.width * 0.45,\r\n    height: device.height * 0.85,\r\n  },\r\n  generatedImage: {\r\n    width: device.width * 0.45,\r\n    height: device.height * 0.85,\r\n  },\r\n  functionButton: {\r\n    padding: 4,\r\n    borderRadius: 5,\r\n  },\r\n  drawGroup: {\r\n    flexDirection: 'column',\r\n  },\r\n  genGroup: {\r\n    flexDirection: 'column',\r\n  },\r\n  genButton: {\r\n    margin: 2,\r\n    width: 200,\r\n  },\r\n  strokeGroup: {\r\n    flexDirection: 'column',\r\n    alignItems: 'center',\r\n  },\r\n  tempButtons: {\r\n    height: 40,\r\n    width: 70,\r\n    flexDirection: 'row',\r\n  },\r\n  toolGroup: {\r\n    flexDirection: 'row',\r\n  },\r\n});\r\n"]},"metadata":{},"sourceType":"module"}