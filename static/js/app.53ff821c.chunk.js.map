{"version":3,"sources":["resources/none_style.png","resources/seaLogo.png","resources/cloudLogo.png","resources/dirtLogo.png","resources/bushLogo.png","resources/mountainLogo.png","resources/skyLogo.png","resources/treeLogo.png","resources/hillLogo.png","resources/riverLogo.png","resources/kanagawa.jpg","resources/starry_night.jpg","resources/rain_princess.jpg","resources/candy.jpg","resources/mosaic.jpg","resources/udnie.jpg","resources/brushes/Eraser.png","resources/brushes/Marker.png","resources/brushes/Highlighter.png","resources/brushes/Splotch.png","resources/brushes/Crayon.png","resources/brushes/Charcoal.png","resources/brushes/Ballpoint.png","resources/brushes/Chalk.png","resources/filters/blur.png","resources/filters/sepia.png","resources/filters/grey.png","resources/filters/contrast.png","resources/filters/fade.png","resources/filters/invert.png","resources/AIBrush.png","resources/styleBrush.png","resources/filterBrush.png","resources/userBrush.png","styles/styles.js","classes/Point.js","constants/messageKinds.js","constants/brushTypes.js","components/DrawCanvas.js","constants/backendUrl.js","constants/userBrushes.js","components/UserCanvas.js","constants/colorMap.js","constants/styleTransferOptions.js","constants/userBrushesOptions.js","constants/filterBrushOptions.js","App.js","index.js"],"names":["module","exports","generateStyle","device","drawBox","borderColor","borderWidth","position","top","left","drawBoxInner","backgroundColor","width","height","userDrag","userSelect","Point","x","y","thickness","color","type","canvasType","this","messageKinds","MESSAGE_CONNECTED","MESSAGE_USER_JOINED","MESSAGE_USER_LEFT","MESSAGE_STROKE","MESSAGE_CLEAR","MESSAGE_CLIENT_SEND_INFO","MESSAGE_STROKE_START","MESSAGE_STROKE_END","MESSAGE_GENERATE","MESSAGE_STYLIZE","MESSAGE_SAVE","MESSAGE_SWITCH_BRUSH","MESSAGE_SWITCH_FILTER","MESSAGE_SWITCH_USER_BRUSH","Dimensions","get","styles","StyleSheet","create","DrawCanvas","props","state","strokes","loadData","imageData","canvas","canvasRef","current","ctx","getContext","image","Image","src","save","drawImage","restore","onDrawMove","event","disable","brushType","brushTypes","posX","nativeEvent","locationX","posY","locationY","p","updateCanvas","setState","concat","onDrawStart","onDrawEnd","point","client","lastPoint","length","otherStrokes","len","lineWidth","moveTo","beginPath","lineTo","globalCompositeOperation","fillStyle","strokeStyle","lineJoin","lineCap","closePath","stroke","clearCanvas","fillRect","isFirstLoadDrawCanvas","handleCanvas","getPathData","drawer","size","_size","path","data","toString","id","parseInt","Math","random","getPathDataArray","parsedArr","i","push","getBase64","a","async","ret","toDataURL","prevState","imagedata","Promise","resolve","bind","canvasOpacity","prevProps","newStroke","setClickClear","Platform","OS","View","style","opacity","onStartShouldSetResponder","onMoveShouldSetResponder","onResponderStart","onResponderMove","onResponderRelease","draggable","ref","Component","UserCanvas","imageBrush","hexToRGB","hex","alpha","r","slice","g","b","myRand","min","max","myRand2","val","range","makeBrushColor","currentComponent","console","log","fetch","backendConstants","headers","method","body","JSON","stringify","userBrushType","then","res","json","parsedJson","catch","clearRect","clearCanvasKeepState","offset","userBrushes","arc","PI","fill","includes","globalAlpha","translate","angle","atan2","rotate","onStrokeEndHandler","onStrokeStartHandler","defaultWhiteCanvas","colors","label","logo","require","labelColor","name","image_url","filters","filter","CANVASWIDTH","CANVASHEIGHT","App","showAICanvas","showUserCanvas","rightColumnWidth","rightColumnMargin","leftColumnWidth","leftColumnLeftMargin","AI_CANVASWIDTH","AI_CANVASHEIGHT","USER_CANVASWIDTH","USER_CANVASHEIGHT","aiCanvasImageData","generatedImageData","stylizedImageData","displayedImageData","finalImageData","imageFilter","userBrushColor","colorPickerDisplay","userBrushBase64","styleBrushType","filterBrushType","ownStroke","collaboratorStroke","displayColorPicker","disableDrawing","disableButtons","canvasWidth","canvasHeight","currentBrush","showImageForEyeDropper","showPreview","isLoading","isChangeSize","grabPixels","refs","drawCanvasRef","value","resultImage","split","sendRequestHelper","response","msg","sendRequestStyleHelper","newStyle","saveGeneratedImage","userCanvasRef","foregroundImageDataStripped","socket","send","kind","userCanvasImageData","alert","handleThickness","sliderValue","handleThicknessEnd","handleOpacity","rgbToHex","d","hex2rgb","enableAICanvas","usercanvas","setTimeout","loadUserCanvas","enableUserCanvas","aicanvas","disableUserCanvas","switchToAICanvas","switchToStyleBrush","switchToFilterBrush","switchToUserBrush","brushSlider","marginLeft","borderRadius","flexDirection","padding","Text","textAlign","fontWeight","fontSize","margin","minimumValue","maximumValue","thumbTintColor","minimumTrackTintColor","maximumTrackTintColor","onValueChange","onSlidingComplete","document","documentElement","overflow","container","TouchableOpacity","onPress","disabled","brushes","source","marginBottom","onChange","paddingTop","alignContent","shadowBoxAICanvas","marginRight","ImageBackground","drawGroup","click","clearChildAIBrush","background","generatedImageBox","generatedImage","uri","shadowBox","clearChildUserBrush","justifyContent","Button","marginTop","title","mode","brushesContainer","colorMap","map","obj","functionButton","styleTransferOptions","filterOptions","userBrushesOptions","spinnerContainer","ActivityIndicator","animating","transform","scale","circleContainer","Ionicons","alignItems","flex","shadowColor","shadowRadius","strokeGroup","toolGroup","donwloadButton","borderLeftColor","borderLeftWidth","spinnerTextStyle","swatch","boxShadow","display","cursor","popover","zIndex","cover","right","bottom","Cat","registerRootComponent"],"mappings":"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","file":"static/js/app.53ff821c.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/none_style.70a5cb7e.png\";","module.exports = __webpack_public_path__ + \"static/media/seaLogo.2178ea2a.png\";","module.exports = __webpack_public_path__ + \"static/media/cloudLogo.5b6fe413.png\";","module.exports = __webpack_public_path__ + \"static/media/dirtLogo.438a7bc6.png\";","module.exports = __webpack_public_path__ + \"static/media/bushLogo.c006aa6c.png\";","module.exports = __webpack_public_path__ + \"static/media/mountainLogo.b051e5b2.png\";","module.exports = __webpack_public_path__ + \"static/media/skyLogo.9f0d6c2c.png\";","module.exports = __webpack_public_path__ + \"static/media/treeLogo.fcc942ee.png\";","module.exports = __webpack_public_path__ + \"static/media/hillLogo.ef3c29a3.png\";","module.exports = __webpack_public_path__ + \"static/media/riverLogo.de091209.png\";","module.exports = __webpack_public_path__ + \"static/media/kanagawa.51983c91.jpg\";","module.exports = __webpack_public_path__ + \"static/media/starry_night.b0b90aef.jpg\";","module.exports = __webpack_public_path__ + \"static/media/rain_princess.1726f27b.jpg\";","module.exports = __webpack_public_path__ + \"static/media/candy.fb7d8168.jpg\";","module.exports = __webpack_public_path__ + \"static/media/mosaic.3cf26242.jpg\";","module.exports = __webpack_public_path__ + \"static/media/udnie.edc8dab6.jpg\";","module.exports = __webpack_public_path__ + \"static/media/Eraser.962677a5.png\";","module.exports = __webpack_public_path__ + \"static/media/Marker.baa7318e.png\";","module.exports = __webpack_public_path__ + \"static/media/Highlighter.8b1ee5a5.png\";","module.exports = __webpack_public_path__ + \"static/media/Splotch.abef5126.png\";","module.exports = __webpack_public_path__ + \"static/media/Crayon.6bcf61dc.png\";","module.exports = __webpack_public_path__ + \"static/media/Charcoal.4df64008.png\";","module.exports = __webpack_public_path__ + \"static/media/Ballpoint.6fc6ee6b.png\";","module.exports = __webpack_public_path__ + \"static/media/Chalk.7ca67c72.png\";","module.exports = __webpack_public_path__ + \"static/media/blur.f3ebcb97.png\";","module.exports = __webpack_public_path__ + \"static/media/sepia.d6640e01.png\";","module.exports = __webpack_public_path__ + \"static/media/grey.0d865fb4.png\";","module.exports = __webpack_public_path__ + \"static/media/contrast.3ca02fc7.png\";","module.exports = __webpack_public_path__ + \"static/media/fade.4d0a33d7.png\";","module.exports = __webpack_public_path__ + \"static/media/invert.9671eb87.png\";","module.exports = __webpack_public_path__ + \"static/media/AIBrush.eb0b1fec.png\";","module.exports = __webpack_public_path__ + \"static/media/styleBrush.299130c8.png\";","module.exports = __webpack_public_path__ + \"static/media/filterBrush.29a7a130.png\";","module.exports = __webpack_public_path__ + \"static/media/userBrush.e241a684.png\";","// import { autocrop } from \"jimp\";\n\nexport function generateStyle(device) {\n  return {\n    drawBox: {\n      borderColor: 'black',\n      borderWidth: 2,\n      // padding: 10,\n      position: 'absolute',\n      top: 0,\n      left: 0,\n    },\n    drawBoxInner: {\n      backgroundColor: 'transparent',\n      position:\"absolute\", left: 0, top: 0,\n      // padding: 10,\n      width: device.width * 0.33,\n      height: device.width * 0.33,\n      userDrag: 'none',\n      userSelect: 'none'\n    },\n  };\n}\n","export default class Point {\n    constructor(x, y, thickness, color, type, canvasType) {\n      this.x = x;\n      this.y = y;\n      this.thickness = thickness;\n      this.color = color;\n      this.type = type;\n      this.canvasType = canvasType;\n    }\n  }\n","const messageKinds = {\n  MESSAGE_CONNECTED: 1,\n  MESSAGE_USER_JOINED: 2,\n  MESSAGE_USER_LEFT: 3,\n  MESSAGE_STROKE: 4,\n  MESSAGE_CLEAR: 5,\n  MESSAGE_CLIENT_SEND_INFO: 6,\n  MESSAGE_STROKE_START: 7,\n  MESSAGE_STROKE_END: 8,\n  MESSAGE_GENERATE: 9,\n  MESSAGE_STYLIZE: 10,\n  MESSAGE_SAVE: 11,\n  MESSAGE_SWITCH_BRUSH: 12,\n  MESSAGE_SWITCH_FILTER: 13,\n  MESSAGE_SWITCH_USER_BRUSH: 14\n};\n\nexport default messageKinds;\n","export default {\n        AI: \"ai\",\n        STYLE: \"style\",\n        USER: \"user\",\n        FILTER: \"filter\"\n}\n","import React, { Component, useRef } from 'react';\nimport {Text, View, Platform, StyleSheet, Dimensions} from 'react-native';\nimport Canvas, {Image as CanvasImage} from 'react-native-canvas';\nimport { generateStyle } from '../styles/styles';\nimport Point from \"../classes/Point\";\nimport {\n\tsendStroke,\n\tsendStrokeEnd,\n\tsendStrokeStart,\n  } from '../api/websocketApi.js';\nimport brushTypes from \"../constants/brushTypes.js\"\n  \nvar device = Dimensions.get('window');\n\n\nconst styles = StyleSheet.create(generateStyle(device));\n\n\n\nexport default class DrawCanvas extends Component {\n\n\n\tstate = {\n\t\tstrokes: []\n\t}\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.handleCanvas = this.handleCanvas.bind(this);\n\t\tthis.thickness = props.thickness\n\t\tthis.color = props.color\n\t\tthis.canvasRef = null;\n\t\tthis.width = props.width;\n\t\tthis.height = props.height;\n\t\tthis.canvasOpacity = props.canvasOpacity;\n\t\tthis.clearCanvas = this.clearCanvas.bind(this);\n\n\t\tthis.imagedata = \"\";\n\t}\n\n\tcomponentDidUpdate(prevProps) {\n\t\tif (prevProps.otherStrokes != this.props.otherStrokes) {\n\t\t\tif (this.props.otherStrokes.length > 0) {\n\t\t\t\tvar newStroke = this.props.otherStrokes[this.props.otherStrokes.length-1]\n\t\t\t\tif (newStroke.canvasType == brushTypes.AI)\n\t\t\t\t{\n\t\t\t\t\tthis.updateCanvas(newStroke, \"other\")\t\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// // If canvas size has changed\n\t\t// if (prevProps.width != this.props.width) {\n\n\t\t// \t// Get the current canvas data\n\t\t// \tthis.getBase64().then(value => {\n\t\t// \t\tvar canvas = this.canvasRef.current\n\n\n\n\t\t// \t\tcanvas.width = this.props.width;\n\t\t// \t\tcanvas.height = this.props.height;\n\t\t\n\t\t// \t\tthis.canvasRef.current = canvas;\n\t\t// \t\tthis.clearCanvas();\n\n\t\t// \t\tthis.loadData();\n\t\t// \t})\n\t\t// }\n\t\t\n\t}\n\n\tloadData = (imageData) => {\n\t\tvar canvas = this.canvasRef.current\n\n\t\tvar ctx = canvas.getContext(\"2d\");\n\t\tconst image = new Image(canvas);\n\n\t\t// console.log(this.state.imagedata)\n\n\t\timage.src = imageData;\n\t\tctx.save();\n\t\tctx.drawImage(image,0,0, this.props.width, this.props.height);\n\t\tctx.restore();\n\t}\n\t\n    onDrawMove = (event) => {\n\t\tif (this.props.disable ||  this.props.brushType !== brushTypes.AI) {\n\t\t\treturn\n\t\t}\n\t\t// console.log(event.nativeEvent)\n        // console.log(\"hello\");\n\t\tvar posX = event.nativeEvent.locationX\n\t\tvar posY = event.nativeEvent.locationY\n\n\t\tvar p = new Point(posX, posY, this.props.thickness, this.props.color, \"move\", \"ai\")\n\t\tthis.updateCanvas(p, \"self\")\n\n\t\t// Create stroke move object\n\t\tthis.setState({\n\t\t\tstrokes: this.state.strokes.concat(p)\n\t\t})\n\t\t// sendStroke(this.props.socket, {x: posX/this.props.width, y: posY/this.props.height, canvasType: \"ai\"}, this.props.color, this.props.thickness)\n\t\t\n    }\n\n\tonDrawStart = (event) => {\n\t\tif (this.props.disable ||  this.props.brushType !== brushTypes.AI) {\n\t\t\treturn\n\t\t}\n\t\t// console.log(\"Got start event:\", event)\n\t\tvar posX = event.nativeEvent.locationX\n\t\tvar posY = event.nativeEvent.locationY\n\n\t\t// Create stroke move object\n\t\tvar p = new Point(posX, posY, this.props.thickness, this.props.color, \"start\", \"ai\")\n\t\tthis.updateCanvas(p, \"self\")\n\n\t\tthis.setState({\n\t\t\tstrokes: this.state.strokes.concat(p)\n\t\t} )\n\t\t// socket: start stroke\n\t\t// sendStrokeStart(this.props.socket, {x: p.x/this.width, y: p.y/this.height}, p.thickness, p.color);\n\n\t}\n\n\tonDrawEnd = (event) => {\n\t\tif (this.props.disable || this.props.brushType !== brushTypes.AI) {\n\t\t\treturn\n\t\t}\n\t\tvar posX = event.nativeEvent.locationX\n\t\tvar posY = event.nativeEvent.locationY\n\n\t\t// Create stroke move object\n\t\tvar p = new Point(posX, posY, this.props.thickness, this.props.color,  \"end\", \"ai\")\n\t\tthis.updateCanvas(p, \"self\")\n\n\t\tthis.setState({\n\t\t\tstrokes: this.state.strokes.concat(p)\n\t\t})\n\t\t// socket: end stroke\n\t\t// sendStrokeEnd(this.props.socket, this.props.color, this.props.thickness);\n\t}\n\n\tupdateCanvas = (point, client) => {\n\t\t// client: \"self\" | \"other\"\n\t\t// point: Point\n\n\t\t// draw a point\n\t\tif (!this.canvasRef) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar strokes;\n\t\tvar lastPoint;\n\t\t// Error checking\n\t\tif (client == \"self\")\n\t\t{\n\t\t\tif (!this.state.strokes || this.state.strokes.length < 1)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tstrokes = this.state.strokes\n\t\t\t\tlastPoint = strokes[strokes.length-1]\t\n\t\t\t}\n\t\t} else\n\t\t{\n\t\t\tif (!this.props.otherStrokes || this.props.otherStrokes.length < 3)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t} else {\n\t\t\t\tstrokes = this.props.otherStrokes\n\t\t\t\tlastPoint = strokes[strokes.length-2]\t\n\t\t\t}\n\t\t}\n\t\t\n\n\n\n\t\tvar canvas = this.canvasRef.current\n\t\tvar len = strokes.length\n\t\t// console.log(\"canvas is\", canvas == null)\n\n\t\tif (canvas && len > 0) {\n\t\t\tvar {x, y, type, thickness} = point\n\t\t\t// console.log(\"lastpoint is\", lastPoint, \"point is\",)\n\t\t\tvar ctx = canvas.getContext(\"2d\");\n\t\t\tctx.lineWidth = thickness\n\n\t\t\tswitch (type) {\n\t\t\t\tcase \"start\":\n\t\t\t\t\tctx.moveTo(x, y)\n\t\t\t\t\tctx.beginPath();\n\t\t\t\t\tctx.lineTo(x, y);\n\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"end\":\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"move\":\n\t\t\t\t\tctx.beginPath();\n\n\t\t\t\t\tctx.moveTo(lastPoint.x, lastPoint.y)\n\n\t\t\t\t\tctx.globalCompositeOperation = 'source-over';\n\t\t\t\t\tctx.lineTo(x, y);\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\t\t\tctx.fillStyle = point.color;\n\t\t\tctx.strokeStyle = point.color;\n\t\t\tctx.lineJoin = ctx.lineCap = 'round';\n\t\t\tctx.closePath()\n\t\t\tctx.stroke();\t\t\t\n\n\t\t}\n\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.props.setClickClear(this.clearCanvas);\n\t }\n\t clearCanvas = () => {\n\t\tvar canvas = this.canvasRef.current\n\t\tvar ctx = canvas.getContext(\"2d\");\n\n\t\t// Fill upper half of the canvas with sky\n\t\tctx.fillStyle = \"#759edf\";\n\t\tctx.fillRect(0, 0, canvas.width, canvas.height);\n\t\tif (this.props.isFirstLoadDrawCanvas)\n\t\t{\n\t\t\t// Fill bottom half of canvas with sea\n\t\t\tctx.fillStyle = \"#384f83\";\n\t\t\tctx.fillRect(0, 3*canvas.height/4, canvas.width, canvas.height/4);\n\t\t}\n\t}\n\n\n\n\thandleCanvas = (canvas) => {\n\t\t// console.log(\"handling canvas\", canvas)\n\t\tif (canvas === null) {\n\t\t\treturn \n\t\t}\n\n\t\tconst ctx = canvas.getContext('2d');\n\t\tcanvas.width = this.props.width;\n\t\tcanvas.height = this.props.height;\n\n\t\tthis.canvasRef = canvas;\n\t\tthis.canvasRef.current = canvas;\n\n\t\tthis.clearCanvas();\n\t}\n\n\n\tgetPathData = (x, y, width, color) => {\n\t\treturn {\n\t\t  drawer: null,\n\t\t  size: {\n\t\t\twidth: this.canvas._size.width,\n\t\t\theight: this.canvas._size.height,\n\t\t  },\n\t\t  path: {\n\t\t\tdata: [`${x.toString()},${y.toString()}`],\n\t\t\t// eslint-disable-next-line radix\n\t\t\twidth: width,\n\t\t\tcolor: color,\n\t\t\tid: parseInt(Math.random() * 100000000),\n\t\t  },\n\t\t};\n\t  };\n\t\n\t  getPathDataArray = (data, width, color) => {\n\t\tparsedArr = [];\n\t\tfor (var i = 0; i < data.length; i++) {\n\t\t  parsedArr.push(`${data[i].x},${data[i].y}`);\n\t\t}\n\t\treturn {\n\t\t  drawer: null,\n\t\t  size: {\n\t\t\twidth: this.canvas._size.width,\n\t\t\theight: this.canvas._size.height,\n\t\t  },\n\t\t  path: {\n\t\t\tdata: parsedArr,\n\t\t\t// eslint-disable-next-line radix\n\t\t\twidth: width,\n\t\t\tcolor: color,\n\t\t\tid: parseInt(Math.random() * 100000000),\n\t\t  },\n\t\t};\n\t  };\n\n\tgetBase64 = async () => {\n\t\tvar canvas = this.canvasRef.current\n\t\t// console.log(\"Getting base64 is\", canvas.toDataURL());\n\n\t\t// toDataURL is a string on web, and a promise on android/ios\n\t\tvar ret = canvas.toDataURL(1.0) \n\n\t\t// web\n\t\tif (typeof(ret) == \"string\") {\n\t\t\tthis.setState((prevState) => ({\n\t\t\t\t...prevState,\n\t\t\t\timagedata: ret,\n\t\t\t}))\n\n\t\t\treturn Promise.resolve(ret)\n\n\n\t\t\t// android/ios\n\t\t} else {\n\t\t\treturn ret;\n\t\t}\n\t}\n\n\t// Send stroke point data\n\t// onStrokeChangeHandler = (x, y) => {\n\t// \tsendStroke(this.props.socket, {x: x, y: y, canvasType: \"ai\"}, this.props.color, this.props.thickness);\n\t// };\n\n\t// Send stroke end signal\n\t// onStrokeEndHandler = () => {\n\t// \tsendStrokeEnd(this.props.socket, this.props.color, this.props.thickness);\n\t// };\n\t// onStrokeStartHandler = (x, y) => {\n\t// \tsendStrokeStart(this.props.socket);\n\t// };\n   \n    render() {\n      if (Platform.OS === \"web\") {\n\t\treturn (\n\t\t<View\n\t\t\tstyle= {[styles.drawBoxInner, {width: this.props.width, height: this.props.height, opacity: this.props.opacity}]}\n\t\t\tonStartShouldSetResponder={(event) => {return true;}}\n\t\t\tonMoveShouldSetResponder={(event) => {return true;}}\n\t\t\tonResponderStart={this.onDrawStart}\n\t\t\tonResponderMove={this.onDrawMove}\n\t\t\tonResponderRelease={this.onDrawEnd}\n\t\t>\n        <canvas \n\t\tdraggable={false}\n\n\t\tref={this.handleCanvas}/>\n\t\t</View>\n\t\t)\n\t} else {\n\t\treturn (\n\t\t\t<View\n\t\t\tonStartShouldSetResponder={(event) => {return true;}}\n\t\t\tonMoveShouldSetResponder={(event) => {return true;}}\n\t\t\tonResponderStart={this.onDrawStart}\n\t\t\tonResponderMove={this.onDrawMove}\n\t\t\tonResponderRelease={this.onDrawEnd}\n\t\t\tstyle= {styles.drawBox}\n\t\t\t>\n\t\t\t<Canvas \n\t\t\tdraggable={false}\n\t\t\t\n\t\t\twidth={styles.drawBox.width}\n\t\t\t\t\theight={styles.drawBox.height} \n\t\t\t\t\tref={this.handleCanvas} \n\t\t\t/>\n\t\t\t</View>\n\t\t)\n\t}\n    }\n  }\n\n","export default {\n    // BACKEND_URL: \"104.154.79.84\"\n    BACKEND_URL: \"localhost\"\n}\n","export default {\n        ERASER: \"eraser\",\n        PENCIL: \"pencil\",\n        PAINT: \"paint\",\n        SPLOTCH: \"splotch\",\n        IMAGE_BRUSH: \"image_brush\",\n        IMAGE_CHARCOAL: \"image_charcoal\",\n        IMAGE_BALLPOINT: \"image_ballpoint\",\n        IMAGE_CHALK: \"image_chalk\",\n}\n","import React, { Component, useRef } from 'react';\nimport { Text, View, Platform, StyleSheet, Dimensions } from 'react-native';\nimport Canvas, { Image as CanvasImage } from 'react-native-canvas';\nimport { generateStyle } from '../styles/styles';\nimport Point from \"../classes/Point\";\nimport backendConstants from \"../constants/backendUrl\"\nimport { Asset } from 'expo-asset';\nimport {\n\tsendStroke,\n\tsendStrokeEnd,\n\tsendStrokeStart,\n} from '../api/websocketApi.js';\nimport brushTypes from \"../constants/brushTypes.js\"\nimport userBrushes from \"../constants/userBrushes.js\"\nvar device = Dimensions.get('window');\n\nconst styles = StyleSheet.create(generateStyle(device));\n\n\nexport default class UserCanvas extends Component {\n\n\n\tstate = {\n\t\tstrokes: [],\n\t\timageBrush: 'data:image/png;base64,', // raw image data of the image brush\n\t\timagedata: \"\",\n\t}\n\n\thexToRGB = (hex, alpha) => {\n\n\t\tconst r = parseInt(hex.slice(1, 3), 16);\n\t\tconst g = parseInt(hex.slice(3, 5), 16);\n\t\tconst b = parseInt(hex.slice(5, 7), 16);\n\n\t\tif (alpha) {\n\t\t\treturn `rgba(${r}, ${g}, ${b}, ${alpha})`;\n\t\t}\n\n\t\treturn `rgb(${r}, ${g}, ${b})`;\n\t}\n\n\tmyRand = (min, max) => {\n\t\treturn Math.random() * (max - min) + min;\n\t}\n\tmyRand2 = (val, range) => {\n\t\treturn this.myRand(val - range * val, val + range * val)\n\t}\n\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.handleCanvas = this.handleCanvas.bind(this);\n\t\tthis.thickness = props.thickness\n\t\tthis.color = props.color\n\t\tthis.canvasRef = null;\n\t\tthis.width = props.width;\n\t\tthis.height = props.height;\n\t\tthis.canvasOpacity = props.canvasOpacity;\n\n\t\tthis.state = {\n\t\t\tstrokes: [],\n\t\t\timageBrush: 'data:image/png;base64,', // raw image data of the image brush\n\t\t}\n\t\tthis.clearCanvas = this.clearCanvas.bind(this);\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.props.setClickClear(this.clearCanvas);\n\t\tthis.defaultWhiteCanvas()\n\t }\n\t makeBrushColor = (color) => {\n\t\tlet currentComponent = this;\n\t\tconsole.log(\"Making newbrush\")\n\n\t\tfetch(`http://${backendConstants.BACKEND_URL}:8000/makeBrush`,\n\t\t\t{\n\t\t\t\theaders: {\n\t\t\t\t\t'Accept': 'application/json',\n\t\t\t\t\t'Content-Type': 'application/json'\n\t\t\t\t},\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tbody: JSON.stringify(\n\t\t\t\t\t{\n\t\t\t\t\t\t\"brushType\": this.props.userBrushType,\n\t\t\t\t\t\t\"color\": color\n\t\t\t\t\t})\n\n\t\t\t\t\t\n\t\t\t})\n\t\t\t.then(function (res) {\n\t\t\t\tres.json().then(parsedJson => {\n\t\t\t\t\t// image.src = asset.uri ;\n\t\t\t\t\tcurrentComponent.setState((prevState, props) => {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t...prevState,\n\t\t\t\t\t\timageBrush: parsedJson.data.imageData\n\t\t\t\t\t}})\n\t\t\t  \n\n\t\t\t\t})\n\n\n\t\t\t})\n\t\t\t.catch(function (res) { console.log(res) })\n\n\t }\n\n\n\tcomponentDidUpdate(prevProps) {\n\t\tif (prevProps.otherStrokes != this.props.otherStrokes) {\n\t\t\tif (this.props.otherStrokes.length > 0) {\n\t\t\t\tvar newStroke = this.props.otherStrokes[this.props.otherStrokes.length-1]\n\t\t\t\tif (newStroke.canvasType == brushTypes.USER)\n\t\t\t\t{\n\t\t\t\t\tthis.updateCanvas(newStroke, \"other\")\t\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\n\t\t// If canvas size has changed\n\t\tif (prevProps.width != this.props.width || prevProps.height != this.props.height) {\n\n\t\n\t\t\t\tthis.canvasRef.current.width = this.props.width;\n\t\t\t\tthis.canvasRef.current.height = this.props.height;\n\n\t\t\t\t// this.clearCanvasKeepState();\n\t\t\t\tconsole.log(\"RESIZING CANVAS\")\n\t\t\t\t// this.loadData();\n\t\t}\n\n\t\tlet currentComponent = this;\n\t\t// If user changed the brush type to image brush changed color, request a new brush image\n\t\tif (this.props.brushType === brushTypes.USER && \n\t\t\t(this.props.userBrushType.includes(\"image\") &&\n\t\t\tprevProps.userBrushType !== this.props.userBrushType) ||\n\t\t\tprevProps.color !== this.props.color) {\n\t\t\t\tconsole.log(\"Making newbrush\")\n\n\t\t\t\tfetch(`http://${backendConstants.BACKEND_URL}:8000/makeBrush`,\n\t\t\t\t\t{\n\t\t\t\t\t\theaders: {\n\t\t\t\t\t\t\t'Accept': 'application/json',\n\t\t\t\t\t\t\t'Content-Type': 'application/json'\n\t\t\t\t\t\t},\n\t\t\t\t\t\tmethod: \"POST\",\n\t\t\t\t\t\tbody: JSON.stringify(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\"brushType\": this.props.userBrushType,\n\t\t\t\t\t\t\t\t\"color\": this.props.color\n\t\t\t\t\t\t\t})\n\t\t\t\t\t})\n\t\t\t\t\t.then(function (res) {\n\t\t\t\t\t\tres.json().then(parsedJson => {\n\t\t\t\t\t\t\t// image.src = asset.uri ;\n\t\t\t\t\t\t\tcurrentComponent.setState((prevState, props) => {\n\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t...prevState,\n\t\t\t\t\t\t\t\timageBrush: parsedJson.data.imageData\n\t\t\t\t\t\t\t}})\n\t\t\t\t\t  \n\n\t\t\t\t\t\t})\n\n\n\t\t\t\t\t})\n\t\t\t\t\t.catch(function (res) { console.log(res) })\n\n\t\t\t}\n\n\n\n\n\n\n\t\t// Update collaborator's drawings\n\t\t// DEPRECATED FOR NOW\n\t\t// if (prevProps.otherStrokes != this.props.otherStrokes) {\n\t\t// \t//   console.log(\"collaborator\", prevProps.otherStrokes, \"new:\", this.props.otherStrokes)\n\t\t// \tif (this.props.otherStrokes.length > 0) {\n\t\t// \t\tvar newStroke = this.props.otherStrokes[this.props.otherStrokes.length - 1]\n\t\t// \t\tthis.updateCanvas(newStroke, \"other\")\n\t\t// \t}\n\t\t// }\n\t}\n\n\tonDrawMove = (event) => {\n\t\t// Disable drawing on this canvas if brush type not selected\n\t\tif (this.props.disable ||  this.props.brushType !== brushTypes.USER) {\n\t\t\treturn;\n\t\t}\n\t\tvar posX = event.nativeEvent.locationX\n\t\tvar posY = event.nativeEvent.locationY\n\n\t\tvar p = new Point(posX, posY, this.props.thickness, this.hexToRGB(this.props.color, this.props.opacity), \"move\")\n\t\tthis.updateCanvas(p, \"self\")\n\n\t\t// Deprecated multi-brush\n\t\t// var q = new Point(posX, posY, this.props.thickness, this.hexToRGB(this.props.color,0.9), \"move\")\n\t\t// q.offset = this.props.thickness*0.5\n\t\t// this.updateCanvas(q, \"self\")\n\n\t\t// var q = new Point(posX, posY, this.props.thickness*0.4, this.hexToRGB(this.props.color,0.9), \"move\")\n\t\t// q.offset = -this.props.thickness*0.4\n\t\t// this.updateCanvas(q, \"self\")\n\n\t\t// var q = new Point(posX, posY, this.props.thickness*0.4, this.hexToRGB(this.props.color,0.95), \"move\")\n\t\t// q.offset = this.props.thickness*0.4\n\t\t// this.updateCanvas(q, \"self\")\n\n\n\t\t// var r = new Point(posX, posY+this.props.thickness*0.8, this.props.thickness, this.hexToRGB(this.props.color,0.4), \"move\")\n\t\t// this.updateCanvas(r, \"self\")\n\n\n\t\t// Create stroke move object\n\t\tthis.setState(prevState => ({\n\t\t\t...prevState,\n\t\t\tstrokes: this.state.strokes.concat(p)\n\t\t}))\n\t\t// sendStroke(this.props.socket, {x: posX/this.width, y: posY/this.height, canvasType: \"user\"}, this.props.color, this.props.thickness)\n\n\t}\n\n\tonDrawStart = (event) => {\n\t\t// Disable drawing on this canvas if brush type not selected\n\t\tif (this.props.disable ||  this.props.brushType !== brushTypes.USER) {\n\t\t\treturn;\n\t\t}\n\t\t// console.log(\"Got start event:\", event)\n\t\tvar posX = event.nativeEvent.locationX\n\t\tvar posY = event.nativeEvent.locationY\n\n\t\t// Create stroke move object\n\t\tvar p = new Point(posX, posY, this.props.thickness, this.props.color, \"start\", \"user\")\n\t\tthis.updateCanvas(p, \"self\")\n\n\t\tthis.setState(prevState => ({\n\t\t\t...prevState,\n\t\t\tstrokes: this.state.strokes.concat(p)\n\t\t}))\n\t\t// socket: start stroke\n\t\t// sendStrokeStart(this.props.socket, {x: p.x, y: p.y}, p.thickness, p.color);\n\n\t}\n\n\tonDrawEnd = (event) => {\n\t\t// Disable drawing on this canvas if brush type not selected\n\t\tif (this.props.disable ||  this.props.brushType !== brushTypes.USER) {\n\t\t\treturn;\n\t\t}\n\t\tvar posX = event.nativeEvent.locationX\n\t\tvar posY = event.nativeEvent.locationY\n\n\t\t// Create stroke move object\n\t\tvar p = new Point(posX, posY, this.props.thickness, this.props.color, \"end\", \"user\")\n\t\tthis.updateCanvas(p, \"self\")\n\n\t\tthis.setState(prevState => ({\n\t\t\t...prevState,\n\t\t\tstrokes: this.state.strokes.concat(p)\n\t\t}))\n\t\t// socket: end stroke\n\t\t// sendStrokeEnd(this.props.socket, this.props.color, this.props.thickness);\n\t}\n\n\tclearCanvas = () => {\n\n\t\tthis.setState(prevState => ({\n\t\t\t...prevState,\n\t\t\timagedata: \"\"\n\t\t}))\n\t\tvar canvas = this.canvasRef.current\n\t\tvar ctx = canvas.getContext(\"2d\");\n\t\tctx.clearRect(0, 0, canvas.width, canvas.height);\n\t}\n\n\tclearCanvasKeepState = () => {\n\t\tvar canvas = this.canvasRef.current\n\t\tvar ctx = canvas.getContext(\"2d\");\n\t\tctx.clearRect(0, 0, canvas.width, canvas.height);\n\t}\n\n\tupdateCanvas = (point, client) => {\n\t\t// client: \"self\" | \"other\"\n\t\t// point: Point\n\n\t\t// draw a point\n\t\tif (!this.canvasRef) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar offset = point.offset || 0;\n\n\t\tvar strokes;\n\t\tvar lastPoint;\n\t\t// Error checking\n\t\tif (client == \"self\") {\n\t\t\tif (!this.state.strokes || this.state.strokes.length < 1) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tstrokes = this.state.strokes\n\t\t\t\tlastPoint = strokes[strokes.length - 1]\n\t\t\t}\n\t\t} else {\n\t\t\tif (!this.props.otherStrokes || this.props.otherStrokes.length < 3) {\n\t\t\t\treturn;\n\t\t\t} else {\n\t\t\t\tstrokes = this.props.otherStrokes\n\t\t\t\tlastPoint = strokes[strokes.length - 2]\n\t\t\t}\n\t\t}\n\n\n\n\n\t\tvar canvas = this.canvasRef.current\n\t\tvar len = strokes.length\n\t\t// console.log(\"canvas is\", canvas == null)\n\n\t\tif (canvas && len > 0) {\n\t\t\tvar { x, y, type, thickness } = point\n\t\t\t// console.log(\"lastpoint is\", lastPoint, \"point is\",)\n\t\t\tvar ctx = canvas.getContext(\"2d\");\n\t\t\tctx.lineWidth = thickness\n\n\t\t\tswitch (type) {\n\t\t\t\tcase \"start\":\n\t\t\t\t\tctx.moveTo(x - offset, y - offset)\n\t\t\t\t\tctx.beginPath();\n\t\t\t\t\tctx.lineTo(x - offset, y - offset);\n\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"end\":\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"move\":\n\t\t\t\t\tctx.beginPath();\n\n\t\t\t\t\tctx.moveTo(lastPoint.x - offset, lastPoint.y - offset)\n\n\t\t\t\t\tctx.lineTo(x - offset, y - offset);\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tif (this.props.userBrushType == userBrushes.PAINT) {\n\t\t\t\tctx.fillStyle = this.hexToRGB(this.props.color, this.props.opacity);\n\t\t\t\tctx.strokeStyle = this.hexToRGB(this.props.color, this.props.opacity);\n\t\t\t\tctx.lineJoin = 'miter';\n\t\t\t\tctx.lineCap = \"butt\";\n\t\t\t\tconsole.log(\"IANTNT\", ctx.lineJoin, ctx.lineCap)\n\n\t\t\t\tctx.closePath()\n\t\t\t\tctx.stroke();\n\t\t\t}\n\n\t\t\telse if (this.props.userBrushType == userBrushes.PENCIL) {\n\t\t\t\tctx.fillStyle = this.hexToRGB(this.props.color, this.props.opacity);\n\t\t\t\tctx.strokeStyle = this.hexToRGB(this.props.color, this.props.opacity);\n\t\t\t\tctx.lineJoin = ctx.lineCap = 'round';\n\t\t\t\tctx.closePath()\n\t\t\t\tctx.stroke();\n\t\t\t}\n\n\t\t\telse if (this.props.userBrushType == userBrushes.ERASER) {\n\t\t\t\tctx.globalCompositeOperation = \"destination-out\";  \n\t\t\t\tctx.lineJoin = ctx.lineCap = 'round';\n\n\t\t\t\tctx.strokeStyle = \"rgba(255,255,255,1)\";\n\t\t\t\tctx.closePath()\n\t\t\t\tctx.stroke();\n\t\t\t\tctx.globalCompositeOperation = \"source-over\"; // reset to default  \n\n\t\t\t}\n\n\n\n\t\t\t// SPLOTCH BRUSH\n\t\t\telse if (this.props.userBrushType == userBrushes.SPLOTCH) {\n\t\t\t\tif (Math.random() < 0.99) {\n\t\t\t\t\t// ctx.stroke();\t\t\t\n\t\t\t\t\tctx.beginPath()\n\t\t\t\t\tctx.arc(x - offset, y - offset, Math.random() * thickness/2, false, Math.PI * 2, false);\n\t\t\t\t\tctx.fillStyle = this.hexToRGB(this.props.color, Math.random());\n\n\t\t\t\t\tctx.fill();\n\n\t\t\t\t}\n\t\t\t}\n\n\t\t\telse if (this.props.userBrushType.includes(\"image\")) {\n\t\t\t\t// IMAGE BRUSH\n\t\t\t\tctx.globalAlpha = this.props.opacity\n\n\t\t\t\tconst image = new Image(canvas);\n\t\t\t\timage.src = this.state.imageBrush\n\n\t\t\t\tctx.save();\n\n\t\t\t\tctx.translate((x - offset - thickness / 2)+thickness/2, (y - offset - thickness / 2)+thickness/2);\n\t\t\t\tvar angle = Math.atan2(y-lastPoint.y, x-lastPoint.x) * 180 / Math.PI;\n\t\t\t\tctx.rotate(angle*Math.PI/180.0);\n\t\t\t\tctx.translate(-(x - offset - thickness / 2)-thickness/2, -(y - offset - thickness / 2)-thickness/2);\n\t\t\t\tctx.drawImage(image, x - offset - thickness / 2, y - offset - thickness / 2, thickness, thickness);\n\t\t\t\tctx.restore();\n\n\t\t\t\tctx.globalAlpha = 1\n\n\t\t\t}\n\n\n\n\n\n\t\t}\n\n\t}\n\tloadData = (imageData) => {\n\t\t\tvar canvas = this.canvasRef.current\n\n\t\t\tvar ctx = canvas.getContext(\"2d\");\n\t\t\tconst image = new Image(canvas);\n\t\n\t\t\timage.src = imageData\n\t\t\tctx.save();\n\t\t\tctx.drawImage(image,0,0, this.props.width, this.props.height);\n\t\t\tctx.restore();\n\t\t\n\t}\n\n\n\thandleCanvas = (canvas) => {\n\t\tif (canvas === null) {\n\t\t\treturn \n\t\t}\n\t\t// console.log(\"handling canvas\", canvas)\n\n\t\tconst ctx = canvas.getContext('2d');\n\t\tcanvas.width = this.props.width;\n\t\tcanvas.height = this.props.height;\n\n\n\n\t\tthis.canvasRef = canvas;\n\t\tthis.canvasRef.current = canvas;\n\n\n\n\t}\n\n\n\tgetPathData = (x, y, width, color) => {\n\t\treturn {\n\t\t\tdrawer: null,\n\t\t\tsize: {\n\t\t\t\twidth: this.canvas._size.width,\n\t\t\t\theight: this.canvas._size.height,\n\t\t\t},\n\t\t\tpath: {\n\t\t\t\tdata: [`${x.toString()},${y.toString()}`],\n\t\t\t\t// eslint-disable-next-line radix\n\t\t\t\twidth: width,\n\t\t\t\tcolor: color,\n\t\t\t\tid: parseInt(Math.random() * 100000000),\n\t\t\t},\n\t\t};\n\t};\n\n\tgetPathDataArray = (data, width, color) => {\n\t\tparsedArr = [];\n\t\tfor (var i = 0; i < data.length; i++) {\n\t\t\tparsedArr.push(`${data[i].x},${data[i].y}`);\n\t\t}\n\t\treturn {\n\t\t\tdrawer: null,\n\t\t\tsize: {\n\t\t\t\twidth: this.canvas._size.width,\n\t\t\t\theight: this.canvas._size.height,\n\t\t\t},\n\t\t\tpath: {\n\t\t\t\tdata: parsedArr,\n\t\t\t\t// eslint-disable-next-line radix\n\t\t\t\twidth: width,\n\t\t\t\tcolor: color,\n\t\t\t\tid: parseInt(Math.random() * 100000000),\n\t\t\t},\n\t\t};\n\t};\n\n\tgetBase64 = async () => {\n\t\tvar canvas = this.canvasRef.current\n\t\t// console.log(\"Getting base64 is\", canvas.toDataURL());\n\n\t\tvar ret = canvas.toDataURL()\n\n\t\t// web\n\t\tif (typeof (ret) == \"string\") {\n\t\t// toDataURL is a string on web, and a promise on android/ios\n\t\tthis.setState((prevState) => ({\n\t\t\t...prevState,\n\t\t\timagedata: ret,\n\t\t}))\n\t\t\treturn Promise.resolve(ret)\n\t\t\t// android/ios\n\t\t} else {\n\t\t\treturn ret;\n\t\t}\n\t}\n\n\n\t// FOR COLLABORATIVE DRAWING \n\t// DISABLED FOR NOW\n\n\t// Send stroke point data\n\t// onStrokeChangeHandler = (x, y) => {\n\t// \tsendStroke(this.props.socket, { x: x, y: y, canvasType: \"user\"}, this.props.color, this.props.thickness);\n\t// };\n\n\t// Send stroke end signal\n\tonStrokeEndHandler = () => {\n\t\t// sendStrokeEnd(this.props.socket, this.props.color, this.props.thickness);\n\t};\n\tonStrokeStartHandler = (x, y) => {\n\t\t// sendStrokeStart(this.props.socket);\n\t};\n\n\tdefaultWhiteCanvas = () => {\n\t\tvar canvas = this.canvasRef.current\n\t\tvar ctx = canvas.getContext(\"2d\");\n\n\t\t// Fill upper half of the canvas with sky\n\t\tctx.fillStyle = \"rgba(255,255,255,0.0)\";\n\t\tctx.fillRect(0, 0, canvas.width, canvas.height);\n\n\t}\n\n\trender() {\n\t\tif (Platform.OS === \"web\") {\n\t\t\treturn (\n\t\t\t\t<View\n\t\t\t\t\tstyle={[styles.drawBoxInner, { width: this.props.width, height: this.props.height }]}\n\t\t\t\t\tonStartShouldSetResponder={(event) => { return true; }}\n\t\t\t\t\tonMoveShouldSetResponder={(event) => { return true; }}\n\t\t\t\t\tonResponderStart={this.onDrawStart}\n\t\t\t\t\tonResponderMove={this.onDrawMove}\n\t\t\t\t\tonResponderRelease={this.onDrawEnd}\n\t\t\t\t>\n\t\t\t\t\t<canvas \n\t\t\t\t\tdraggable={false}\n\t\t\t\t\tref={this.handleCanvas} id=\"mycanvas\"\n\t\t\t\t\twidth={this.props.width}\n\t\t\t\t\theight={this.props.height}\n\t\t\t\t\t />\n\t\t\t\t</View>\n\t\t\t)\n\t\t} else {\n\t\t\treturn (\n\t\t\t\t<View\n\t\t\t\t\tonStartShouldSetResponder={(event) => { return true; }}\n\t\t\t\t\tonMoveShouldSetResponder={(event) => { return true; }}\n\t\t\t\t\tonResponderStart={this.onDrawStart}\n\t\t\t\t\tonResponderMove={this.onDrawMove}\n\t\t\t\t\tonResponderRelease={this.onDrawEnd}\n\t\t\t\t\tstyle={styles.drawBox}\n\t\t\t\t>\n\t\t\t\t\t<Canvas width={styles.drawBox.width}\n\t\t\t\t\t\theight={styles.drawBox.height}\n\t\t\t\t\t\tref={this.handleCanvas}\n\t\t\t\t\t\tid=\"mycanvas\"\n\t\t\t\t\t\tdraggable={false}\n\t\t\t\t\t/>\n\t\t\t\t</View>\n\t\t\t)\n\t\t}\n\t}\n}\n\n","export default {\n  colors: [\n    {\n      color: '#384f83',\n      id: 154,\n      label: 'Sea',\n      logo: require('../resources/seaLogo.png'),\n      // logo: require('../resources/tmp/seaLogo2.png'),\n    },\n    {\n      color: '#efefef',\n      id: 105,\n      label: 'Cloud',\n      logo: require('../resources/cloudLogo.png'),\n      // logo: require('../resources/tmp/cloudLogo2.png'),\n      labelColor: \"#d3d3d3\"\n    },\n    {\n      color: '#2c1e16',\n      id: 110,\n      label: 'Dirt',\n      logo: require('../resources/dirtLogo.png'),\n      // logo: require('../resources/tmp/dirtLogo2.png'),\n    },\n    {\n      color: '#5d6e32',\n      id: 96,\n      label: 'Bush',\n      logo: require('../resources/bushLogo.png'),\n      // logo: require('../resources/tmp/bushLogo2.png'),\n    },\n    // {\n    //   color: '#b7d24e',\n    //   id: 123,\n    //   label: 'grass',\n    //   labelColor: 'black',\n    //   logo: require('../resources/grassLogo.png'),\n    // },\n    {\n      color: '#3c3b4b',\n      id: 134,\n      label: 'Mountain',\n      logo: require('../resources/mountainLogo.png'),\n      // logo: require('../resources/tmp/mountainLogo2.png'),\n    },\n    // {\n    //   color: '#987e6a',\n    //   id: 148,\n    //   label: 'road',\n    //   logo: './resources/roadLogo.png',\n    // },\n    {\n      color: '#759edf',\n      id: 156,\n      label: 'Sky',\n      logo: require('../resources/skyLogo.png'),\n      // logo: require('../resources/tmp/skyLogo2.png'),\n    },\n    {\n      color: '#352613',\n      id: 168,\n      label: 'Tree',\n      logo: require('../resources/treeLogo.png'),\n      // logo: require('../resources/tmp/treeLogo2.png'),\n    },\n    // {\n    //   color: '#e670b6',\n    //   id: 118,\n    //   label: 'flower',\n    //   logo: './resources/flowerLogo.png',\n    // },\n    // {\n    //   color: '#c1c3c9',\n    //   id: 119,\n    //   label: 'fog',\n    //   logo: './resources/fogLogo.png',\n    // },\n    {\n      color: '#776c2d',\n      id: 126,\n      label: 'Hill',\n      logo: require('../resources/hillLogo.png'),\n      // logo: require('../resources/tmp/hillLogo2.png'),\n    },\n    // {\n    //   color: '#bf602c', \n    //   id: 128,\n    //   label: 'leaves',\n    //   logo: './resources/leavesLogo.png',\n    // },\n    {\n      color: '#32604d',\n      id: 147,\n      label: 'River',\n      logo: require('../resources/riverLogo.png'),\n      // logo: require('../resources/tmp/riverLogo2.png'),\n    },\n    // {\n    //   color: '#fafafa',\n    //   id: 158,\n    //   label: 'snow',\n    //   labelColor: 'black',\n    //   logo: './resources/snowLogo.png',\n    // },\n  ],\n};\n","export default {\n  styles: [\n    {\n      name: 'kanagawa',\n      label: 'Kanagawa',\n      image_url: require('../resources/kanagawa.jpg'),\n    },\n    {\n      name: 'starry_night',\n      label: 'Starry Night',\n      image_url: require('../resources/starry_night.jpg'),\n    },\n    {\n      name: 'rain_princess',\n      label: 'Rain Princess',\n      image_url: require('../resources/rain_princess.jpg'),\n    },\n    {\n      name: 'candy',\n      label: 'Candy',\n      image_url: require('../resources/candy.jpg'),\n    },\n    {\n      name: 'mosaic',\n      label: 'Mosaic',\n      image_url: require('../resources/mosaic.jpg'),\n    },\n    {\n      name: 'udnie',\n      label: 'Udnie',\n      image_url: require('../resources/udnie.jpg'),\n    },\n  ],\n};\n","export default {\n  userBrushes: [\n    {\n      name: 'eraser',\n      label: 'Eraser',\n      image_url: require('../resources/brushes/Eraser.png'),\n    },\n    {\n      name: 'pencil',\n      label: 'Marker',\n      image_url: require('../resources/brushes/Marker.png'),\n    },\n    {\n      name: 'paint',\n      label: 'Highlighter',\n      image_url: require('../resources/brushes/Highlighter.png'),\n    },\n    {\n      name: 'splotch',\n      label: 'Splotch',\n      image_url: require('../resources/brushes/Splotch.png'),\n    },\n    {\n      name: 'image_brush',\n      label: 'Crayon',\n      image_url: require('../resources/brushes/Crayon.png'),\n    },\n    {\n      name: 'image_charcoal',\n      label: 'Charcoal',\n      image_url: require('../resources/brushes/Charcoal.png'),\n    },\n    {\n      name: 'image_ballpoint',\n      label: 'Ballpoint',\n      image_url: require('../resources/brushes/Ballpoint.png'),\n    },\n    {\n      name: 'image_chalk',\n      label: 'Chalk',\n      image_url: require('../resources/brushes/Chalk.png'),\n    },\n    ],\n};\n","export default {\n        filters: [\n                {\n                        name: 'blur',\n                        label: 'Blur',\n                        filter: \"blur(2px)\",\n                        image_url: require('../resources/filters/blur.png'),\n                },\n                {\n                        name: 'sepia',\n                        label: 'Sepia',\n                        filter: \"sepia(100)\",\n                        image_url: require('../resources/filters/sepia.png'),\n                },\n                {\n                        name: 'grey',\n                        label: 'Grey',\n                        filter: \"grayscale(80%)\",\n                        image_url: require('../resources/filters/grey.png'),\n                },\n                {\n                        name: 'contrast',\n                        label: 'Contrast',\n                        filter: \"contrast(150%)\",\n                        image_url: require('../resources/filters/contrast.png'),\n                },\n                {\n                        name: 'fade',\n                        label: 'Fade',\n                        filter: \"blur(0.2px) brightness(110%) hue-rotate(5deg) saturate(0.5) opacity(85%)\",\n                        //                         filter: \"blur('0.2px'),brightness(110%),hue-rotate('5deg') opacity(0.9) saturate(1.3) sepia(40)\",\n\n                        image_url: require('../resources/filters/fade.png'),\n                },\n                {\n                        name: 'invert',\n                        label: 'Invert',\n                        filter: \"invert(100%) hue-rotate(90deg)\",\n                        image_url: require('../resources/filters/invert.png'),\n                }\n        ],\n};\n","import React, { Component } from \"react\";\nimport {\n  ActivityIndicator,\n  StyleSheet,\n  View,\n  Button,\n  Dimensions,\n  Image,\n  TouchableOpacity,\n  Text,\n  ImageBackground,\n} from \"react-native\";\nimport DrawCanvas from \"./components/DrawCanvas\";\nimport UserCanvas from \"./components/UserCanvas\";\n\nimport Slider from \"@react-native-community/slider\";\n// import Snackbar from 'react-native-snackbar';\nimport colorMap from \"./constants/colorMap.js\";\nimport brushTypes from \"./constants/brushTypes.js\";\nimport userBrushes from \"./constants/userBrushes.js\";\nimport styleTransferOptions from \"./constants/styleTransferOptions.js\";\nimport userBrushesOptions from \"./constants/userBrushesOptions.js\";\nimport filterOptions from \"./constants/filterBrushOptions.js\";\n\nimport messageKinds from \"./constants/messageKinds.js\";\nimport { ScrollView } from \"react-native-gesture-handler\";\nimport { Ionicons } from \"@expo/vector-icons\";\nimport { RgbaColorPicker } from \"react-colorful\";\n\nvar device = Dimensions.get(\"window\");\nconst CANVASWIDTH = device.height * 0.8;\nconst CANVASHEIGHT = device.height * 0.8;\n\n// Connect to Go backend\n// for web\n// for android\n// let this.state.socket = new WebSocket('ws://10.0.2.2:8080/ws');\n\n// Create dynamic style based on device width/height\n// const styles = StyleSheet.create(generateStyle(device));\n\nexport default class App extends Component {\n  // React state: store the image data\n  state = {\n    showAICanvas: true,\n    showUserCanvas: false,\n\n    rightColumnWidth: device.height * 0.11 * 1.8,\n    rightColumnMargin: device.height * 0.007,\n\n    leftColumnWidth: device.height * 0.25,\n    leftColumnLeftMargin: device.height * 0.007,\n    //device.width - (device.height * (0.85 * 1.25 + 0.11 * 1.8 + 0.25 + 0.007 + 0.3))\n\n    //canvas + small canvas, right col, left col, marginleft of left col\n    AI_CANVASWIDTH: Math.min(\n      (device.width - device.height * (0.11 * 1.8 + 0.25 + 0.007 + 0.15)) * 0.65,\n      device.height * 0.65\n    ),\n    // device.height * (0.85 * 1.25 + 0.11 * 1.8 + 0.25 + 0.007) > device.width\n    //   ? device.height * 0.5\n    //   : device.height * 0.85,\n    AI_CANVASHEIGHT: Math.min(\n      (device.width - device.height * (0.11 * 1.8 + 0.25 + 0.007 + 0.15)) * 0.65,\n      device.height * 0.65\n    ),\n    //AI_CANVASWIDTH: device.height * 0.85,\n    //AI_CANVASHEIGHT: device.height * 0.85,\n\n    //USER_CANVASWIDTH: device.height * 0.85,\n    //USER_CANVASHEIGHT: device.height * 0.85,\n    USER_CANVASWIDTH: Math.min(\n      (device.width - device.height * (0.11 * 1.8 + 0.25 + 0.007 + 0.15)) * 0.65,\n      device.height * 0.65\n    ),\n    USER_CANVASHEIGHT: Math.min(\n      (device.width - device.height * (0.11 * 1.8 + 0.25 + 0.007 + 0.15)) * 0.65,\n      device.height * 0.65\n    ),\n    aiCanvasImageData: \"data:image/png;base64,\", // image data of the ai canvas\n\n    imageData: \"data:image/png;base64,\", // raw image data of the segmentation image\n    generatedImageData: \"data:image/png;base64,\", // raw image data of the generated image\n    stylizedImageData: \"data:image/png;base64,\", // raw image data of stylized generated image\n    displayedImageData: \"data:image/png;base64,\", // raw image data of displayed image\n    finalImageData: \"data:image/png;base64,\", // raw image data of generatedImageData + userCanvasImageData\n    style: \"none\", // selected style\n    color: \"#384f83\", // pen color\n    imageFilter: \"\",\n    userBrushColor: \"#00FF00\",\n    colorPickerDisplay: { r: 0, g: 255, b: 0, a: 1 }, // another color state to keep track of the current color picker state\n\n    userBrushBase64: \"data:image/png;base64,\", // user brush\n    userBrushType: userBrushes.PENCIL,\n    styleBrushType: \"None\",\n    filterBrushType: \"None\",\n    thickness: 10, // stroke thickness\n    ownStroke: [], // client stroke data\n    collaboratorStroke: [], // collaborator data\n    opacity: 1, // Toggle between the drawing canvas and generated image.\n    displayColorPicker: false,\n    disableDrawing: false, // used when eyedropper is active\n    disableButtons: false, // used when the eyedropper is active\n    // 1 = show drawing canvas, 0 = show image\n    // socket: new WebSocket('ws://localhost:8080/ws')\n    // socket:\n    //   Platform.OS === \"web\"\n    //     ? new WebSocket(`ws://${backendConstants.BACKEND_URL}:8080/ws`)\n    //     : new WebSocket(`ws://${backendConstants.BACKEND_URL}:8080/ws`),\n    canvasWidth: CANVASWIDTH,\n    canvasHeight: CANVASHEIGHT,\n    currentBrush: brushTypes.AI,\n\n    showImageForEyeDropper: false,\n    showPreview: true, // show the preview of the other canvas at the top left corner\n\n    isLoading: true, //for loading spinner\n    isChangeSize: false, //for slider\n\n    isFirstLoadDrawCanvas: true, // show a default segmentation map for the first time in the AI canvas\n  };\n\n  constructor(props) {\n    super(props);\n    this.sendRequestHelper = this.sendRequestHelper.bind(this);\n  }\n\n  // Run when component is first rendered\n  componentDidMount() {\n    console.log(\"Attempting connection\");\n\n    this.setState((prevState) => ({\n      ...prevState,\n      isLoading: false,\n      isFirstLoadDrawCanvas: false,\n    }));\n    }\n  // Fetch image data from canvas\n  // Then call sendRequest to send the data to backend\n  grabPixels = async () => {\n    this.setState((prevState) => ({\n      ...prevState,\n      isLoading: true,\n    }));\n    var getImage = this.refs.drawCanvasRef.getBase64().then((value) => {\n      var resultImage = value.split(\";base64,\")[1];\n      console.log(\"result image is\", resultImage);\n      this.setState(\n        (prevState) => ({\n          ...prevState,\n          imageData: resultImage,\n        }),\n        // Do callback to send to server after the imageData is set\n        this.sendRequestHelper\n      );\n    });\n  };\n\n  // Send request to model server to generate painting\n  sendRequestHelper = async () => {\n    this.setState((prevState) => ({\n      ...prevState,\n      isLoading: true,\n    }));\n\n    const response = await fetch('http://127.0.0.1:8000/generate', {\n      method: 'POST',\n      headers: {\n          'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        imageData: this.state.imageData,\n      }),\n    });\n\n    const msg = await response.json()\n    console.log(msg)\n    this.setState((prevState) => ({\n      ...prevState,\n      generatedImageData: msg.data,\n      displayedImageData: msg.data,\n    }));\n\n    this.setState((prevState) => ({\n      ...prevState,\n      isLoading: false,\n    }));\n\n  };\n  // Send a request to the model server to stylize the generated painting\n  sendRequestStyleHelper = async (newStyle) => {\n    this.setState((prevState) => ({\n      ...prevState,\n      isLoading: true,\n    }));\n\n    const response = await fetch('http://127.0.0.1:8000/stylize', {\n      method: 'POST',\n      headers: {\n          'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        imageData: this.state.generatedImageData,\n        style: newStyle,\n      }),\n    });\n\n    const msg = await response.json();\n    console.log(msg)\n    this.setState((prevState) => ({\n      ...prevState,\n      styleBrushType: newStyle,\n      stylizedImageData: msg.data,\n      displayedImageData: msg.data,\n    }));\n\n    this.setState((prevState) => ({\n      ...prevState,\n      isLoading: false,\n    }));\n\n  };\n  // xxxxx\n  saveGeneratedImage = () => {\n    if (this.refs.userCanvasRef == null) {\n      alert(\n        \"Unable to save the painting in AI Brush. Please select 'User Brush' or 'Style' or 'Filter' and try again.\"\n      );\n      return;\n    } else {\n      var getImage = this.refs.userCanvasRef.getBase64().then((value) => {\n        var resultImage = value.split(\";base64,\")[1];\n        var foregroundImageDataStripped =\n          this.state.displayedImageData.split(\";base64,\")[1];\n        this.setState((prevState) => ({\n          ...prevState,\n          isLoading: true,\n        }));\n        this.state.socket.send(\n          JSON.stringify({\n            kind: messageKinds.MESSAGE_SAVE,\n            data: {\n              displayedImageData: foregroundImageDataStripped,\n              userCanvasImageData: resultImage,\n              aiCanvasImageData: this.state.imageData,\n            },\n          })\n        );\n      });\n    }\n  };\n\n  handleThickness = (sliderValue) => {\n    this.setState((prevState) => ({\n      ...prevState,\n      thickness: sliderValue,\n      isChangeSize: true,\n    }));\n    console.log(\"thickness is now\", sliderValue);\n  };\n\n  handleThicknessEnd = (sliderValue) => {\n    this.setState((prevState) => ({\n      ...prevState,\n      isChangeSize: false,\n    }));\n    console.log(\"thickness is done chaging\", sliderValue);\n  };\n\n  handleOpacity = (sliderValue) => {\n    this.setState((prevState) => ({\n      ...prevState,\n      opacity: sliderValue,\n    }));\n    console.log(\"opacity is now\", sliderValue);\n  };\n\n  // Convert object of rgb {r: g: b:} to hex string\n  rgbToHex = (d) => {\n    const red = d.r;\n    const green = d.g;\n    const blue = d.b;\n    const rgb = (red << 16) | (green << 8) | (blue << 0);\n    return \"#\" + (0x1000000 + rgb).toString(16).slice(1);\n  };\n  hex2rgb = (hex) => {\n    const r = parseInt(hex.slice(1, 3), 16);\n    const g = parseInt(hex.slice(3, 5), 16);\n    const b = parseInt(hex.slice(5, 7), 16);\n    // return {r, g, b} // return an object\n    return { r: r, g: g, b: b, a: 1 };\n  };\n\n  // Enable the AI canvas for drawing\n  // Display the\n  enableAICanvas = () => {\n    if (this.state.showAICanvas) {\n      return;\n    }\n\n    // Save the drawcanvas and usercanvas data\n    var getImageUserCanvas = this.refs.userCanvasRef\n      .getBase64()\n      .then((usercanvas) => {\n        this.setState(\n          (prevState) => ({\n            ...prevState,\n            showAICanvas: true,\n            showUserCanvas: false,\n            userCanvasImageData: usercanvas,\n          }),\n          () => {\n            for (var i = 0; i < 2; i++) {\n              setTimeout(() => {\n                this.refs.drawCanvasRef.loadData(this.state.aiCanvasImageData);\n              }, 0);\n            }\n            this.refs.drawCanvasRef.loadData(this.state.aiCanvasImageData);\n          }\n        );\n\n        // Load the data base64\n      });\n  };\n\n  loadUserCanvas = () => {\n    this.setState(\n      (prevState) => ({\n        ...prevState,\n        showUserCanvas: true,\n        isLoading: true,\n      }),\n      () => {\n        for (var i = 0; i < 2; i++) {\n          setTimeout(() => {\n            if (this.refs.userCanvasRef !== null) {\n              console.log(\"Load user canvas\");\n              this.refs.userCanvasRef.loadData(this.state.userCanvasImageData);\n              this.setState(\n                (prevState) => ({\n                  ...prevState,\n                  isLoading: false,\n                  disableDrawing: false,\n                }),\n                () => {\n                  this.refs.userCanvasRef.makeBrushColor(\n                    this.state.userBrushColor\n                  );\n                }\n              );\n            }\n          }, 1500);\n        }\n      }\n    );\n  };\n\n  enableUserCanvas = () => {\n    if (this.state.showUserCanvas) {\n      return;\n    }\n\n    // Save the drawcanvas and usercanvas data\n    var getImageAICanvas = this.refs.drawCanvasRef\n      .getBase64()\n      .then((aicanvas) => {\n        this.setState(\n          (prevState) => ({\n            ...prevState,\n            showAICanvas: false,\n            showUserCanvas: true,\n            aiCanvasImageData: aicanvas,\n          }),\n          () => {\n            for (var i = 0; i < 2; i++) {\n              setTimeout(() => {\n                this.refs.userCanvasRef.loadData(\n                  this.state.userCanvasImageData\n                );\n              }, 0);\n            }\n          }\n        );\n        // Load the data base64\n      });\n  };\n\n  disableUserCanvas = () => {\n    if (this.state.showAICanvas) {\n      return;\n    }\n\n    // Save the usercanvas data\n    var getImageUserCanvas = this.refs.userCanvasRef\n      .getBase64()\n      .then((usercanvas) => {\n        this.setState((prevState) => ({\n          ...prevState,\n          showAICanvas: false,\n          showUserCanvas: false,\n          userCanvasImageData: usercanvas,\n        }));\n      });\n  };\n\n  enableUserCanvas = () => {\n    if (this.state.showUserCanvas) {\n      return;\n    }\n\n    // Save the drawcanvas and usercanvas data\n    var getImageAICanvas = this.refs.drawCanvasRef\n      .getBase64()\n      .then((aicanvas) => {\n        this.setState(\n          (prevState) => ({\n            ...prevState,\n            showAICanvas: false,\n            showUserCanvas: true,\n            aiCanvasImageData: aicanvas,\n          }),\n          () => {\n            for (var i = 0; i < 2; i++) {\n              setTimeout(() => {\n                this.refs.userCanvasRef.loadData(\n                  this.state.userCanvasImageData\n                );\n              }, 0);\n            }\n            // this.refs.userCanvasRef.loadData(this.state.userCanvasImageData);\n          }\n        );\n        // Load the data base64\n      });\n  };\n\n  switchToAICanvas = () => {\n    this.setState((prevState) => ({\n      ...prevState,\n      currentBrush: brushTypes.AI,\n    }));\n    this.enableAICanvas();\n  }\n\n  switchToStyleBrush = () => {\n    this.setState((prevState) => ({\n      ...prevState,\n      currentBrush: brushTypes.STYLE,\n    }));\n    this.enableUserCanvas();\n  }\n\n  switchToFilterBrush = () => {\n    this.setState((prevState) => ({\n      ...prevState,\n      currentBrush: brushTypes.FILTER,\n    }));\n    this.enableUserCanvas();\n\n  }\n\n  switchToUserBrush = () => {\n    this.setState((prevState) => ({\n      ...prevState,\n      currentBrush: brushTypes.USER,\n    }));\n    // Display user canvas\n    this.enableUserCanvas();\n  }\n\n  render() {\n    let brushSlider = (\n      <View\n        style={{\n          backgroundColor: \"#f2f2eb\",\n          width: this.state.leftColumnWidth,\n          marginLeft: this.state.leftColumnLeftMargin,\n          borderRadius: 10,\n          flexDirection: \"column\",\n          padding: 5,\n        }}\n      >\n        <View>\n          <Text\n            style={{\n              textAlign: \"center\",\n              color: \"#363636\",\n              fontWeight: \"bold\",\n              fontSize: 16,\n              padding: 2,\n            }}\n          >\n            Size\n          </Text>\n        </View>\n\n        <Slider\n          style={{\n            width: device.height * 0.22,\n            margin: \"auto\",\n            height: device.height * 0.03,\n          }}\n          value={this.state.thickness}\n          minimumValue={1}\n          maximumValue={CANVASWIDTH / 4}\n          thumbTintColor=\"#4f4f4f\"\n          minimumTrackTintColor=\"#707070\"\n          maximumTrackTintColor=\"#cfcfcf\"\n          onValueChange={this.handleThickness}\n          onSlidingComplete={this.handleThicknessEnd}\n        />\n      </View>\n    );\n\n    // For ipad sizing\n    // prevent bouncing / scroll on ios\n    document.documentElement.style.height = \"100%\";\n    document.documentElement.style.overflow = \"hidden\";\n    document.body.style.height = \"100%\";\n    document.body.style.overflow = \"auto\";\n\n    return (\n      <View style={styles.container}>\n        {/* this View wraps the left column */}\n        <View\n          style={{\n            width: this.state.leftColumnLeftMargin + this.state.leftColumnWidth,\n          }}\n        >\n          <TouchableOpacity\n            onPress={() => {\n              this.switchToAICanvas();\n             \n              // sendSwitchBrush(this.state.socket,brushTypes.AI)\n            }}\n            disabled={this.state.disableButtons}\n          >\n            <Image\n              style={[\n                styles.brushes,\n                {\n                  height:\n                    this.state.currentBrush == brushTypes.AI\n                      ? device.height * 0.10\n                      : device.height * 0.08,\n                  width:\n                    this.state.currentBrush == brushTypes.AI\n                      ? device.height * 0.10 * 1.5\n                      : device.height * 0.08 * 1.5,\n                  opacity: this.state.currentBrush == brushTypes.AI ? 1 : 0.55,\n                },\n              ]}\n              source={require(\"./resources/AIBrush.png\")}\n            />\n          </TouchableOpacity>\n          <TouchableOpacity\n            onPress={() => {\n              this.switchToStyleBrush();\n\n              // sendSwitchBrush(this.state.socket,brushTypes.STYLE)\n            }}\n            disabled={this.state.disableButtons}\n          >\n            <Image\n              style={[\n                styles.brushes,\n                {\n                  height:\n                    this.state.currentBrush == brushTypes.STYLE\n                      ? device.height * 0.10\n                      : device.height * 0.08,\n                  width:\n                    this.state.currentBrush == brushTypes.STYLE\n                      ? device.height * 0.10 * 1.5\n                      : device.height * 0.08 * 1.5,\n                  opacity:\n                    this.state.currentBrush == brushTypes.STYLE ? 1 : 0.55,\n                },\n              ]}\n              source={require(\"./resources/styleBrush.png\")}\n            />\n          </TouchableOpacity>\n          <TouchableOpacity\n            onPress={() => {\n              this.switchToFilterBrush();\n              // sendSwitchBrush(this.state.socket,brushTypes.FILTER)\n\n            }}\n            disabled={this.state.disableButtons}\n          >\n            <Image\n              style={[\n                styles.brushes,\n                {\n                  height:\n                    this.state.currentBrush == brushTypes.FILTER\n                      ? device.height * 0.10\n                      : device.height * 0.08,\n                  width:\n                    this.state.currentBrush == brushTypes.FILTER\n                      ? device.height * 0.10 * 1.5\n                      : device.height * 0.08 * 1.5,\n                  opacity:\n                    this.state.currentBrush == brushTypes.FILTER ? 1 : 0.55,\n                },\n              ]}\n              source={require(\"./resources/filterBrush.png\")}\n            />\n          </TouchableOpacity>\n          <TouchableOpacity\n            onPress={() => {\n              this.switchToUserBrush();\n\n              // sendSwitchBrush(this.state.socket,brushTypes.USER)\n            }}\n            disabled={this.state.disableButtons}\n          >\n            <Image\n              style={[\n                styles.brushes,\n                {\n                  height:\n                    this.state.currentBrush == brushTypes.USER\n                      ? device.height * 0.10\n                      : device.height * 0.08,\n                  width:\n                    this.state.currentBrush == brushTypes.USER\n                      ? device.height * 0.10 * 1.5\n                      : device.height * 0.08 * 1.5,\n                  opacity:\n                    this.state.currentBrush == brushTypes.USER ? 1 : 0.55,\n                },\n              ]}\n              source={require(\"./resources/userBrush.png\")}\n            />\n          </TouchableOpacity>\n\n          {this.state.currentBrush == brushTypes.AI && (\n            <View>{brushSlider}</View>\n          )}\n          {this.state.currentBrush == brushTypes.USER && (\n            <View>\n              <RgbaColorPicker\n                style={{\n                  marginLeft: this.state.leftColumnLeftMargin,\n                  marginBottom: 3,\n                  width: this.state.leftColumnWidth,\n                  height: this.state.leftColumnWidth,\n                }}\n                color={this.state.colorPickerDisplay}\n                onChange={(color) => {\n\n                  this.setState((prevState) => ({\n                    ...prevState,\n                    userBrushColor: this.rgbToHex(color),\n                    opacity: color.a,\n                    colorPickerDisplay: color,\n                  }));\n                  // sendSwitchUserBrush(this.state.socket,this.state.userBrushType,this.rgbToHex(color))\n\n                }}\n              />\n              {brushSlider}\n            </View>\n          )}\n          {/* Save painting button */}\n          {/* <View\n            style={{ padding: \"1em\", marginTop: \"10px\", marginBottom: \"10px\" }}\n          >\n            <Button\n              color=\"#717591\"\n              title=\"Save Painting\"\n              onPress={() => this.saveGeneratedImage()}\n            />\n          </View> */}\n        </View>\n\n        {/* this View wraps middle column */}\n        <View style={{ flexDirection: \"column\" }}>\n          {/* this View wraps around the buttons that changes canva view & camera*/}\n          <View\n            style={{\n              flexDirection: \"row\",\n              paddingTop: device.height * 0.01,\n              alignContent: \"flex-end\",\n              marginLeft: \"auto\",\n            }}\n          ></View>\n\n          {/* this View wraps the two canvas */}\n          <View style={{ flexDirection: \"row\" }}>\n            {/* Canvas previews */}\n            {/* Show the user canvas if we are in the AI canvas main view */}\n            {this.state.showAICanvas && this.state.showPreview && (\n              <View\n                style={[\n                  styles.shadowBoxAICanvas,\n                  {\n                    width: this.state.USER_CANVASHEIGHT / 1.5,\n                    height: this.state.USER_CANVASHEIGHT / 1.5,\n                    marginRight: 5,\n                  },\n                ]}\n              >\n                <ImageBackground\n                  source={this.state.displayedImageData}\n                  style={{ filter: this.state.imageFilter }}\n                >\n                  <Image\n                    style={[\n                      {\n                        width: this.state.USER_CANVASHEIGHT / 1.5,\n                        height: this.state.USER_CANVASHEIGHT / 1.5,\n                      },\n                    ]}\n                    source={this.state.userCanvasImageData}\n                  />\n                </ImageBackground>\n              </View>\n            )}\n            {/* AI Brush preview */}\n            {!this.state.showAICanvas && this.state.showPreview && (\n              // {this.state.showUserCanvas && this.state.showPreview && (\n\n              <View\n                style={[\n                  styles.shadowBoxAICanvas,\n                  {\n                    width: this.state.USER_CANVASHEIGHT / 1.5,\n                    height: this.state.USER_CANVASHEIGHT / 1.5,\n                    marginRight: 5,\n                  },\n                ]}\n              >\n                <Image\n                  style={{\n                    width: this.state.USER_CANVASHEIGHT / 1.5,\n                    height: this.state.USER_CANVASHEIGHT / 1.5,\n                  }}\n                  source={this.state.aiCanvasImageData}\n                />\n              </View>\n            )}\n\n            {/* this wraps the middle big canvas and buttons */}\n            <View style={{ flexDirection: \"column\" }}>\n              {/* this View warps AI canvas */}\n              {this.state.showAICanvas && (\n                <View id=\"drawGroup\" style={styles.drawGroup}>\n                  <View\n                    style={[\n                      styles.shadowBoxAICanvas,\n                      {\n                        width: this.state.AI_CANVASWIDTH,\n                        height: this.state.AI_CANVASHEIGHT,\n                      },\n                    ]}\n                  >\n                    <DrawCanvas\n                      ref=\"drawCanvasRef\"\n                      setClickClear={(click) =>\n                        (this.clearChildAIBrush = click)\n                      }\n                      style={{\n                        backgroundColor: \"black\",\n                        position: \"absolute\",\n                        background: \"transparent\",\n                      }}\n                      brushType={this.state.currentBrush}\n                      thickness={this.state.thickness}\n                      color={this.state.color}\n                      // socket={this.state.socket}\n                      otherStrokes={this.state.collaboratorStroke}\n                      width={this.state.AI_CANVASWIDTH}\n                      height={this.state.AI_CANVASHEIGHT}\n                      opacity={1}\n                      disable={this.state.disableDrawing}\n                      isFirstLoadDrawCanvas={this.state.isFirstLoadDrawCanvas}\n                    />\n                  </View>\n                </View>\n              )}\n              {/* this View wraps generated image & user canvas */}\n              {this.state.showUserCanvas && (\n                <View id=\"drawGroup\" style={styles.drawGroup}>\n                  {/* Displayed image */}\n                  <View\n                    style={[\n                      styles.generatedImageBox,\n                      {\n                        width: this.state.USER_CANVASWIDTH,\n                        height: this.state.USER_CANVASHEIGHT,\n                      },\n                    ]}\n                  >\n                    {this.state.displayedImageData != null ? (\n                      <Image\n                        draggable={false}\n                        style={[\n                          styles.generatedImage,\n                          { filter: this.state.imageFilter },\n                        ]}\n                        source={{ uri: this.state.displayedImageData }}\n                      />\n                    ) : null}\n                  </View>\n                  {/* Main canvas */}\n                  {/* Conditionally render the main canvas if toggleDraw == true */}\n                  <View\n                    style={[\n                      styles.shadowBox,\n                      {\n                        width: this.state.USER_CANVASWIDTH,\n                        height: this.state.USER_CANVASHEIGHT,\n                      },\n                    ]}\n                  >\n                    {/* USER CANVAS */}\n                    <UserCanvas\n                      ref=\"userCanvasRef\"\n                      setClickClear={(click) =>\n                        (this.clearChildUserBrush = click)\n                      }\n                      style={{\n                        position: \"absolute\",\n                        background: \"transparent\",\n                      }}\n                      brushType={this.state.currentBrush}\n                      userBrushType={this.state.userBrushType}\n                      thickness={this.state.thickness}\n                      color={this.state.userBrushColor}\n                      // socket={this.state.socket}\n                      otherStrokes={this.state.collaboratorStroke}\n                      width={this.state.USER_CANVASWIDTH}\n                      height={this.state.USER_CANVASHEIGHT}\n                      opacity={this.state.opacity}\n                      disable={this.state.disableDrawing}\n                      id=\"myCanvas\"\n                    />\n                  </View>\n                </View>\n              )}\n\n              {/* Show the image for the eye dropper */}\n              {this.state.showImageForEyeDropper && (\n                <View style={styles.shadowBox}>\n                  <Image\n                    style={{\n                      width: this.state.USER_CANVASWIDTH,\n                      height: this.state.USER_CANVASHEIGHT,\n                    }}\n                    source={this.state.finalImageData}\n                  />\n                </View>\n              )}\n\n              {/* this wraps the buttons at the bottom of canvas */}\n              {this.state.currentBrush == brushTypes.AI && (\n                <View\n                  style={{\n                    flexDirection: \"row\",\n                    justifyContent: \"space-around\",\n                  }}\n                >\n                  <View style={{ padding: 5, width: \"40%\" }}>\n                    <Button\n                      style={{ marginTop: 10, height: \"80\" }}\n                      color=\"#5e748a\"\n                      title=\"clear\"\n                      onPress={() => this.clearChildAIBrush()}\n                    />\n                  </View>\n\n                  <View style={{ padding: 5, width: \"40%\" }}>\n                    <Button\n                      mode=\"contained\"\n                      style={{ padding: 10 }}\n                      onPress={this.grabPixels.bind(this)}\n                      color=\"#88508c\"\n                      title=\"generate\"\n                      disabled={this.state.isLoading}\n                    />\n                  </View>\n                </View>\n              )}\n              {this.state.currentBrush == brushTypes.USER && (\n                <View\n                  style={{\n                    flexDirection: \"row\",\n                    justifyContent: \"space-around\",\n                  }}\n                >\n                  <View style={{ padding: 5, width: \"40%\" }}>\n                    <Button\n                      color=\"#717591\"\n                      title=\"clear strokes\"\n                      onPress={() => this.clearChildUserBrush()}\n                    />\n                  </View>\n                </View>\n              )}\n            </View>\n          </View>\n        </View>\n\n        {/* this View wraps the right column */}\n        <View style={{ flexDirection: \"row\" }}>\n          {/* AI brush palette buttons */}\n          {this.state.currentBrush == brushTypes.AI && (\n            <View style={styles.brushesContainer}>\n              <ScrollView>\n                {colorMap.colors.map((obj) => {\n                  return (\n                    <View style={{ margin: 2 }}>\n                      <TouchableOpacity\n                        style={{\n                          padding: 4,\n                          borderRadius: 5,\n                          backgroundColor: obj.color,\n                          borderWidth: this.state.color == obj.color ? 10 : 0,\n                          borderColor: \n                            obj.color == \"#efefef\" ? \"#d1d1d1\" : \"#f2f2eb\",\n\n                          // backgroundColor:\n                          //   this.state.color == obj.color\n                          //     ? \"#3d3d3d\"\n                          //     : \"#dbdbdb\", //obj.color == \"#efefef\" ? \"#dbdbdb\" : \"white\",\n                        }}\n                        onPress={() => {\n                          this.setState({ color: obj.color });\n                        }}\n                        disabled={this.state.disableButtons}\n                      >\n                        <Image\n                          draggable={false}\n                          style={styles.brushes}\n                          source={obj.logo}\n                        />\n                        <Text\n                          style={{\n                            fontSize: device.height * 0.015,\n                            color: obj.color == \"#efefef\" ? \"#3d3d3d\" : \"white\",\n\n                            // color:\n                            //   this.state.color == obj.color ? \"white\" : \"black\",\n                            // fontWeight: \"500\",\n                          }}\n                        >\n                          {obj.label}\n                        </Text>\n                      </TouchableOpacity>\n                    </View>\n                  );\n                })}\n              </ScrollView>\n\n              {/* Render the slider and the brush legend */}\n            </View>\n          )}\n\n          {/* Style buttons */}\n          {this.state.currentBrush == brushTypes.STYLE && (\n            <View style={styles.brushesContainer}>\n              <ScrollView>\n                {/* None style button */}\n                <View style={{ margin: 2 }}>\n                  <TouchableOpacity\n                    style={[\n                      styles.functionButton,\n                      {\n                        backgroundColor:\n                          this.state.styleBrushType == \"None\"\n                            ? \"#3d3d3d\"\n                            : \"#dbdbdb\",\n                      },\n                    ]}\n                    onPress={() => {\n                      this.setState((prevState) => ({\n                        ...prevState,\n                        displayedImageData: this.state.generatedImageData,\n                        styleBrushType: \"None\",\n                      }));\n                    }}\n                    disabled={this.state.disableButtons}\n                  >\n                    <Image\n                      style={styles.brushes}\n                      source={require(\"./resources/none_style.png\")}\n                    />\n                    <Text\n                      style={{\n                        color:\n                          this.state.styleBrushType == \"None\"\n                            ? \"white\"\n                            : \"black\",\n                        fontSize: device.height * 0.015,\n                        fontWeight: \"500\",\n                      }}\n                    >\n                      {\" \"}\n                      None{\" \"}\n                    </Text>\n                  </TouchableOpacity>\n                </View>\n                {/* Programmatically render all style options */}\n                {styleTransferOptions.styles.map((obj) => {\n                  return (\n                    <View style={{ margin: 2 }}>\n                      <TouchableOpacity\n                        disabled={this.state.disableButtons}\n                        style={[\n                          styles.functionButton,\n                          {\n                            backgroundColor:\n                              this.state.styleBrushType == obj.name\n                                ? \"#3d3d3d\"\n                                : \"#dbdbdb\",\n                          },\n                        ]}\n                        onPress={() => {\n                          this.sendRequestStyleHelper(obj.name);\n                          this.setState((prevState) => ({\n                            styleBrushType: obj.name,\n                          }));\n                        }}\n                      >\n                        <Image style={styles.brushes} source={obj.image_url} />\n                        <Text\n                          style={{\n                            color:\n                              this.state.styleBrushType == obj.name\n                                ? \"white\"\n                                : \"black\",\n                            fontSize: device.height * 0.015,\n                            fontWeight: \"500\",\n                          }}\n                        >\n                          {obj.label}\n                        </Text>\n                      </TouchableOpacity>\n                    </View>\n                  );\n                })}\n              </ScrollView>\n            </View>\n          )}\n\n          {/* Filter buttons */}\n          {this.state.currentBrush == brushTypes.FILTER && (\n            <View style={styles.brushesContainer}>\n              <ScrollView>\n                {/* None filter button */}\n                <View style={{ margin: 2 }}>\n                  <TouchableOpacity\n                    style={[\n                      styles.functionButton,\n                      {\n                        backgroundColor:\n                          this.state.filterBrushType == \"None\"\n                            ? \"#3d3d3d\"\n                            : \"#dbdbdb\",\n                      },\n                    ]}\n                    onPress={() => {\n                      this.setState((prevState) => ({\n                        ...prevState,\n                        imageFilter: \"\",\n                        filterBrushType: \"None\",\n                      }));\n                      // sendSwitchFilter(this.state.socket, \"\", \"None\")\n                    }}\n                    disabled={this.state.disableButtons}\n                  >\n                    <Image\n                      style={styles.brushes}\n                      source={require(\"./resources/none_style.png\")}\n                    />\n                    <Text\n                      style={{\n                        color:\n                          this.state.filterBrushType == \"None\"\n                            ? \"white\"\n                            : \"black\",\n                        fontSize: device.height * 0.015,\n                        fontWeight: \"500\",\n                      }}\n                    >\n                      {\" \"}\n                      None{\" \"}\n                    </Text>\n                  </TouchableOpacity>\n                </View>\n                {/* Programmatically render all filter options */}\n                {filterOptions.filters.map((obj) => {\n                  return (\n                    <View style={{ margin: 2 }}>\n                      <TouchableOpacity\n                        disabled={this.state.disableButtons}\n                        style={[\n                          styles.functionButton,\n                          {\n                            backgroundColor:\n                              this.state.filterBrushType == obj.name\n                                ? \"#3d3d3d\"\n                                : \"#dbdbdb\",\n                          },\n                        ]}\n                        onPress={() => {\n                          this.setState((prevState) => ({\n                            imageFilter: obj.filter,\n                            filterBrushType: obj.name,\n                          }));\n                          // sendSwitchFilter(this.state.socket, obj.filter, obj.name)\n                        }}\n                      >\n                        <Image style={styles.brushes} source={obj.image_url} />\n                        <Text\n                          style={{\n                            color:\n                              this.state.filterBrushType == obj.name\n                                ? \"white\"\n                                : \"black\",\n                            fontSize: device.height * 0.015,\n                            fontWeight: \"500\",\n                          }}\n                        >\n                          {obj.label}\n                        </Text>\n                      </TouchableOpacity>\n                    </View>\n                  );\n                })}\n              </ScrollView>\n            </View>\n          )}\n        </View>\n\n        {/* User Brush buttons */}\n        {this.state.currentBrush == brushTypes.USER && (\n          <View style={styles.brushesContainer}>\n            {/* <View style={{ height: device.height * 0.4 }}> */}\n            <ScrollView>\n              {/* Programmatically render all options */}\n              {userBrushesOptions.userBrushes.map((obj) => {\n                return (\n                  <View style={{ margin: 2 }}>\n                    <TouchableOpacity\n                      style={[\n                        styles.functionButton,\n                        {\n                          backgroundColor:\n                            this.state.userBrushType == obj.name\n                              ? \"#3d3d3d\"\n                              : \"white\",\n                        },\n                      ]}\n                      onPress={() => {\n                        this.setState((prevState) => ({\n                          ...prevState,\n                          userBrushType: obj.name,\n                        }));\n                        // sendSwitchUserBrush(this.state.socket,obj.name,this.state.userBrushColor)\n                      }}\n                    >\n                      <Image\n                        style={styles.userBrushes}\n                        source={obj.image_url}\n                      />\n                      <Text\n                        style={{\n                          color:\n                            this.state.userBrushType == obj.name\n                              ? \"white\"\n                              : \"#2e2e2e\",\n                          fontSize: device.height * 0.015,\n                        }}\n                      >\n                        {obj.label}\n                      </Text>\n                    </TouchableOpacity>\n                  </View>\n                );\n              })}\n            </ScrollView>\n            {/* </View> */}\n          </View>\n        )}\n\n        {/* this View wraps the spinner */}\n        {/* Spinner is recommended to be at the root level */}\n        <View style={styles.spinnerContainer}>\n          <ActivityIndicator\n            animating={this.state.isLoading}\n            size={\"large\"}\n            color={\"#545454\"}\n            style={{ transform: [{ scale: 3 }] }}\n          />\n        </View>\n\n        {/* this View wraps the size indicator */}\n        {this.state.isChangeSize == true && (\n          <View style={styles.circleContainer}>\n            <Text style={{ color: \"#4d4d4d\", fontWeight: \"bold\" }}>\n              Size Preview:\n            </Text>\n            <Ionicons\n              style={{\n                opacity: this.state.opacity,\n                justifyContent: \"center\",\n                alignItems: \"center\",\n                margin: \"auto\",\n              }}\n              name=\"ellipse\"\n              color={\n                this.state.currentBrush == brushTypes.USER\n                  ? this.state.userBrushColor\n                  : this.state.color\n              }\n              size={this.state.thickness * 1.2}\n            ></Ionicons>\n          </View>\n        )}\n      </View>\n    );\n  }\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    backgroundColor: \"white\",\n  },\n  generatedImageBox: {\n    userDrag: \"none\",\n    userSelect: \"none\",\n    backgroundColor: \"transparent\",\n    position: \"absolute\",\n  },\n  generatedImage: {\n    width: \"100%\",\n    height: \"100%\",\n    userDrag: \"none\",\n    userSelect: \"none\",\n  },\n  shadowBoxAICanvas: {\n    shadowColor: \"grey\",\n    shadowRadius: 20,\n    position: \"relative\",\n  },\n  shadowBox: {\n    shadowColor: \"grey\",\n    shadowRadius: 20,\n    position: \"relative\",\n  },\n  functionButton: {\n    padding: 4,\n    borderRadius: 5,\n  },\n\n  drawGroup: {\n    flexDirection: \"row\",\n    // alignItems: \"center\",\n    // justifyContent: \"center\",\n  },\n  strokeGroup: {\n    flexDirection: \"column\",\n    alignItems: \"center\",\n  },\n  toolGroup: {\n    flexDirection: \"row\",\n    justifyContent: \"space-around\",\n  },\n  brushes: {\n    margin: 0,\n    height: device.height * 0.06,\n    width: device.height * 0.06 * 1.8,\n    padding: 0,\n    userDrag: \"none\",\n    userSelect: \"none\",\n  },\n  donwloadButton: {\n    margin: 0,\n    height: device.height * 0.145 * 0.4,\n    width: device.height * 0.145 * 0.41,\n    padding: 0,\n    userDrag: \"none\",\n    userSelect: \"none\",\n  },\n  brushesContainer: {\n    flexDirection: \"column\",\n    justifyContent: \"space-around\",\n    alignItems: \"center\",\n    height: device.height,\n    borderLeftColor: \"#C8C8C8\",\n    backgroundColor: \"#f2f2eb\",\n    borderLeftWidth: 3,\n  },\n  userBrushes: {\n    justifyContent: \"start\",\n    margin: 0,\n    height: device.height * 0.06,\n    width: device.height * 0.06 * 1.8,\n    paddingTop: 0,\n  },\n  spinnerTextStyle: {\n    color: \"transparent\",\n  },\n  spinnerContainer: {\n    position: \"absolute\",\n    flex: 1,\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    backgroundColor: \"transparent\",\n    left: device.width / 2,\n    top: device.height / 2.5,\n  },\n  circleContainer: {\n    height: device.height * 0.35,\n    width: device.height * 0.3,\n    marginBottom: \"0.5em\",\n    position: \"absolute\",\n    flex: 1,\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    backgroundColor: \"rgba(245, 245, 237, 0.8)\",\n    borderRadius: 10,\n    left: device.width / 2,\n    top: device.height / 3,\n  },\n\n  swatch: {\n    padding: \"5px\",\n    background: \"#fff\",\n    borderRadius: \"1px\",\n    boxShadow: \"0 0 0 1px rgba(0,0,0,.1)\",\n    display: \"inline-block\",\n    cursor: \"pointer\",\n  },\n  popover: {\n    position: \"absolute\",\n    zIndex: \"2\",\n  },\n  cover: {\n    position: \"fixed\",\n    top: \"0px\",\n    right: \"0px\",\n    bottom: \"0px\",\n    left: \"0px\",\n  },\n  color: {\n    width: \"36px\",\n    height: \"14px\",\n    borderRadius: \"2px\",\n  },\n  Cat: {\n    color: \"pink\",\n    backgroundColor: \"pink\",\n  },\n});\n","import 'react-native-gesture-handler';\nimport { registerRootComponent } from 'expo';\n\nimport App from './App';\n\n// registerRootComponent calls AppRegistry.registerComponent('main', () => App);\n// It also ensures that whether you load the app in Expo Go or in a native build,\n// the environment is set up appropriately\nregisterRootComponent(App);\n"],"sourceRoot":""}