{"version":3,"sources":["resources/bushLogo.png","resources/AIBrush.png","resources/none_style.png","resources/seaLogo.png","resources/cloudLogo.png","resources/dirtLogo.png","resources/mountainLogo.png","resources/skyLogo.png","resources/treeLogo.png","resources/hillLogo.png","resources/riverLogo.png","resources/kanagawa.jpg","resources/starry_night.jpg","resources/rain_princess.jpg","resources/candy.jpg","resources/mosaic.jpg","resources/udnie.jpg","resources/brushes/Eraser.png","resources/brushes/Marker.png","resources/brushes/Highlighter.png","resources/brushes/Splotch.png","resources/brushes/Crayon.png","resources/brushes/Charcoal.png","resources/brushes/Ballpoint.png","resources/brushes/Chalk.png","resources/filters/blur.png","resources/filters/sepia.png","resources/filters/grey.png","resources/filters/contrast.png","resources/filters/fade.png","resources/filters/invert.png","resources/styleBrush.png","resources/filterBrush.png","resources/userBrush.png","styles/styles.js","classes/Point.js","constants/messageKinds.js","constants/brushTypes.js","components/DrawCanvas.js","constants/backendUrl.js","constants/userBrushes.js","components/UserCanvas.js","components/InspireMode.js","constants/colorMap.js","constants/styleTransferOptions.js","constants/userBrushesOptions.js","constants/filterBrushOptions.js","App.js","index.js"],"names":["module","exports","generateStyle","device","drawBox","borderColor","borderWidth","position","top","left","drawBoxInner","backgroundColor","width","height","userDrag","userSelect","Point","x","y","thickness","color","type","canvasType","this","messageKinds","MESSAGE_CONNECTED","MESSAGE_USER_JOINED","MESSAGE_USER_LEFT","MESSAGE_STROKE","MESSAGE_CLEAR","MESSAGE_CLIENT_SEND_INFO","MESSAGE_STROKE_START","MESSAGE_STROKE_END","MESSAGE_GENERATE","MESSAGE_STYLIZE","MESSAGE_SAVE","MESSAGE_SWITCH_BRUSH","MESSAGE_SWITCH_FILTER","MESSAGE_SWITCH_USER_BRUSH","Dimensions","get","styles","StyleSheet","create","DrawCanvas","props","state","strokes","loadData","imageData","canvas","canvasRef","current","ctx","getContext","image","Image","src","save","drawImage","restore","onDrawMove","event","disable","brushType","brushTypes","posX","nativeEvent","locationX","posY","locationY","p","updateCanvas","setState","concat","onDrawStart","onDrawEnd","point","client","lastPoint","length","otherStrokes","len","lineWidth","moveTo","beginPath","lineTo","globalCompositeOperation","fillStyle","strokeStyle","lineJoin","lineCap","closePath","stroke","clearCanvas","fillRect","handleCanvas","getPathData","drawer","size","_size","path","data","toString","id","parseInt","Math","random","getPathDataArray","parsedArr","i","push","getBase64","a","async","ret","toDataURL","prevState","imagedata","Promise","resolve","bind","canvasOpacity","prevProps","newStroke","setClickClear","Platform","OS","View","style","opacity","onStartShouldSetResponder","onMoveShouldSetResponder","onResponderStart","onResponderMove","onResponderRelease","draggable","ref","Component","UserCanvas","imageBrush","hexToRGB","hex","alpha","r","slice","g","b","myRand","min","max","myRand2","val","range","makeBrushColor","currentComponent","console","log","fetch","backendConstants","headers","method","body","JSON","stringify","userBrushType","then","res","json","parsedJson","catch","clearRect","clearCanvasKeepState","offset","userBrushes","arc","PI","fill","includes","globalAlpha","translate","angle","atan2","rotate","onStrokeEndHandler","onStrokeStartHandler","defaultWhiteCanvas","Title","Typography","options","value","label","InspireMode","localurl","useState","prompt","setPrompt","setStyle","list","setList","loadings","setLoadings","useEffect","margin","level","map","section","index","flexDirection","onChange","e","olddata","one","target","two","three","marginTop","placeholder","mode","allowClear","maxWidth","marginRight","onClick","prevLoadings","newLoadings","response","msg","handleGenerate","loading","PreviewGroup","colors","logo","require","labelColor","name","image_url","filters","filter","CANVASWIDTH","CANVASHEIGHT","App","showAICanvas","showInspireMode","showUserCanvas","rightColumnWidth","rightColumnMargin","leftColumnWidth","leftColumnLeftMargin","AI_CANVASWIDTH","AI_CANVASHEIGHT","USER_CANVASWIDTH","USER_CANVASHEIGHT","aiCanvasImageData","generatedImageData","stylizedImageData","displayedImageData","finalImageData","imageFilter","userBrushColor","colorPickerDisplay","userBrushBase64","styleBrushType","filterBrushType","ownStroke","collaboratorStroke","displayColorPicker","disableDrawing","disableButtons","canvasWidth","canvasHeight","currentBrush","showPreview","isLoading","isChangeSize","isFirstLoadDrawCanvas","text","flag","grabPixelsGan","refs","drawCanvasRef","resultImage","split","sendRequestHelper","grabPixelsSd","grabPixelsCN","sendRequestStyleHelper","newStyle","saveGeneratedImage","userCanvasRef","foregroundImageDataStripped","socket","send","kind","userCanvasImageData","alert","handleThickness","sliderValue","handleThicknessEnd","handleOpacity","rgbToHex","d","hex2rgb","enableAICanvas","usercanvas","setTimeout","enableUserCanvas","aicanvas","switchToAICanvas","switchToInspireMode","switchToStyleBrush","switchToFilterBrush","switchToUserBrush","brushSlider","marginLeft","borderRadius","padding","Text","textAlign","fontWeight","fontSize","minimumValue","maximumValue","thumbTintColor","minimumTrackTintColor","maximumTrackTintColor","onValueChange","onSlidingComplete","document","documentElement","overflow","container","TouchableOpacity","onPress","disabled","brushes","source","marginBottom","display","paddingTop","alignContent","shadowBoxAICanvas","ImageBackground","drawGroup","click","clearChildAIBrush","background","generatedImageBox","generatedImage","uri","shadowBox","clearChildUserBrush","justifyContent","TextInput","input","onChangeText","Button","title","brushesContainer","colorMap","obj","functionButton","styleTransferOptions","filterOptions","userBrushesOptions","spinnerContainer","ActivityIndicator","animating","transform","scale","circleContainer","Ionicons","alignItems","flex","shadowColor","shadowRadius","strokeGroup","toolGroup","donwloadButton","borderLeftColor","borderLeftWidth","spinnerTextStyle","swatch","boxShadow","cursor","popover","zIndex","cover","right","bottom","Cat","registerRootComponent"],"mappings":"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","file":"static/js/app.19bc2661.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/bushLogo.c006aa6c.png\";","module.exports = __webpack_public_path__ + \"static/media/AIBrush.eb0b1fec.png\";","module.exports = __webpack_public_path__ + \"static/media/none_style.70a5cb7e.png\";","module.exports = __webpack_public_path__ + \"static/media/seaLogo.2178ea2a.png\";","module.exports = __webpack_public_path__ + \"static/media/cloudLogo.5b6fe413.png\";","module.exports = __webpack_public_path__ + \"static/media/dirtLogo.438a7bc6.png\";","module.exports = __webpack_public_path__ + \"static/media/mountainLogo.b051e5b2.png\";","module.exports = __webpack_public_path__ + \"static/media/skyLogo.9f0d6c2c.png\";","module.exports = __webpack_public_path__ + \"static/media/treeLogo.fcc942ee.png\";","module.exports = __webpack_public_path__ + \"static/media/hillLogo.ef3c29a3.png\";","module.exports = __webpack_public_path__ + \"static/media/riverLogo.de091209.png\";","module.exports = __webpack_public_path__ + \"static/media/kanagawa.51983c91.jpg\";","module.exports = __webpack_public_path__ + \"static/media/starry_night.b0b90aef.jpg\";","module.exports = __webpack_public_path__ + \"static/media/rain_princess.1726f27b.jpg\";","module.exports = __webpack_public_path__ + \"static/media/candy.fb7d8168.jpg\";","module.exports = __webpack_public_path__ + \"static/media/mosaic.3cf26242.jpg\";","module.exports = __webpack_public_path__ + \"static/media/udnie.edc8dab6.jpg\";","module.exports = __webpack_public_path__ + \"static/media/Eraser.962677a5.png\";","module.exports = __webpack_public_path__ + \"static/media/Marker.baa7318e.png\";","module.exports = __webpack_public_path__ + \"static/media/Highlighter.8b1ee5a5.png\";","module.exports = __webpack_public_path__ + \"static/media/Splotch.abef5126.png\";","module.exports = __webpack_public_path__ + \"static/media/Crayon.6bcf61dc.png\";","module.exports = __webpack_public_path__ + \"static/media/Charcoal.4df64008.png\";","module.exports = __webpack_public_path__ + \"static/media/Ballpoint.6fc6ee6b.png\";","module.exports = __webpack_public_path__ + \"static/media/Chalk.7ca67c72.png\";","module.exports = __webpack_public_path__ + \"static/media/blur.f3ebcb97.png\";","module.exports = __webpack_public_path__ + \"static/media/sepia.d6640e01.png\";","module.exports = __webpack_public_path__ + \"static/media/grey.0d865fb4.png\";","module.exports = __webpack_public_path__ + \"static/media/contrast.3ca02fc7.png\";","module.exports = __webpack_public_path__ + \"static/media/fade.4d0a33d7.png\";","module.exports = __webpack_public_path__ + \"static/media/invert.9671eb87.png\";","module.exports = __webpack_public_path__ + \"static/media/styleBrush.299130c8.png\";","module.exports = __webpack_public_path__ + \"static/media/filterBrush.29a7a130.png\";","module.exports = __webpack_public_path__ + \"static/media/userBrush.e241a684.png\";","// import { autocrop } from \"jimp\";\n\nexport function generateStyle(device) {\n  return {\n    drawBox: {\n      borderColor: 'black',\n      borderWidth: 2,\n      // padding: 10,\n      position: 'absolute',\n      top: 0,\n      left: 0,\n    },\n    drawBoxInner: {\n      backgroundColor: 'transparent',\n      position:\"absolute\", left: 0, top: 0,\n      // padding: 10,\n      width: device.width * 0.33,\n      height: device.width * 0.33,\n      userDrag: 'none',\n      userSelect: 'none'\n    },\n  };\n}\n","export default class Point {\n    constructor(x, y, thickness, color, type, canvasType) {\n      this.x = x;\n      this.y = y;\n      this.thickness = thickness;\n      this.color = color;\n      this.type = type;\n      this.canvasType = canvasType;\n    }\n  }\n","const messageKinds = {\n  MESSAGE_CONNECTED: 1,\n  MESSAGE_USER_JOINED: 2,\n  MESSAGE_USER_LEFT: 3,\n  MESSAGE_STROKE: 4,\n  MESSAGE_CLEAR: 5,\n  MESSAGE_CLIENT_SEND_INFO: 6,\n  MESSAGE_STROKE_START: 7,\n  MESSAGE_STROKE_END: 8,\n  MESSAGE_GENERATE: 9,\n  MESSAGE_STYLIZE: 10,\n  MESSAGE_SAVE: 11,\n  MESSAGE_SWITCH_BRUSH: 12,\n  MESSAGE_SWITCH_FILTER: 13,\n  MESSAGE_SWITCH_USER_BRUSH: 14\n};\n\nexport default messageKinds;\n","export default {\n        AI: \"ai\",\n        INSPIRE: \"inspire\",\n        STYLE: \"style\",\n        USER: \"user\",\n        FILTER: \"filter\"\n}\n","import React, { Component, useRef } from 'react';\nimport {Text, View, Platform, StyleSheet, Dimensions} from 'react-native';\nimport Canvas, {Image as CanvasImage} from 'react-native-canvas';\nimport { generateStyle } from '../styles/styles';\nimport Point from \"../classes/Point\";\nimport {\n\tsendStroke,\n\tsendStrokeEnd,\n\tsendStrokeStart,\n  } from '../api/websocketApi.js';\nimport brushTypes from \"../constants/brushTypes.js\"\n  \nvar device = Dimensions.get('window');\n\n\nconst styles = StyleSheet.create(generateStyle(device));\n\n\n\nexport default class DrawCanvas extends Component {\n\n\n\tstate = {\n\t\tstrokes: []\n\t}\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.handleCanvas = this.handleCanvas.bind(this);\n\t\tthis.thickness = props.thickness\n\t\tthis.color = props.color\n\t\tthis.canvasRef = null;\n\t\tthis.width = props.width;\n\t\tthis.height = props.height;\n\t\tthis.canvasOpacity = props.canvasOpacity;\n\t\tthis.clearCanvas = this.clearCanvas.bind(this);\n\n\t\tthis.imagedata = \"\";\n\t}\n\n\tcomponentDidUpdate(prevProps) {\n\t\tif (prevProps.otherStrokes != this.props.otherStrokes) {\n\t\t\tif (this.props.otherStrokes.length > 0) {\n\t\t\t\tvar newStroke = this.props.otherStrokes[this.props.otherStrokes.length-1]\n\t\t\t\tif (newStroke.canvasType == brushTypes.AI)\n\t\t\t\t{\n\t\t\t\t\tthis.updateCanvas(newStroke, \"other\")\t\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// // If canvas size has changed\n\t\t// if (prevProps.width != this.props.width) {\n\n\t\t// \t// Get the current canvas data\n\t\t// \tthis.getBase64().then(value => {\n\t\t// \t\tvar canvas = this.canvasRef.current\n\n\n\n\t\t// \t\tcanvas.width = this.props.width;\n\t\t// \t\tcanvas.height = this.props.height;\n\t\t\n\t\t// \t\tthis.canvasRef.current = canvas;\n\t\t// \t\tthis.clearCanvas();\n\n\t\t// \t\tthis.loadData();\n\t\t// \t})\n\t\t// }\n\t\t\n\t}\n\n\tloadData = (imageData) => {\n\t\tvar canvas = this.canvasRef.current\n\n\t\tvar ctx = canvas.getContext(\"2d\");\n\t\tconst image = new Image(canvas);\n\n\t\t// console.log(this.state.imagedata)\n\n\t\timage.src = imageData;\n\t\tctx.save();\n\t\tctx.drawImage(image,0,0, this.props.width, this.props.height);\n\t\tctx.restore();\n\t}\n\t\n    onDrawMove = (event) => {\n\t\tif (this.props.disable ||  this.props.brushType !== brushTypes.AI) {\n\t\t\treturn\n\t\t}\n\t\t// console.log(event.nativeEvent)\n        // console.log(\"hello\");\n\t\tvar posX = event.nativeEvent.locationX\n\t\tvar posY = event.nativeEvent.locationY\n\n\t\tvar p = new Point(posX, posY, this.props.thickness, this.props.color, \"move\", \"ai\")\n\t\tthis.updateCanvas(p, \"self\")\n\n\t\t// Create stroke move object\n\t\tthis.setState({\n\t\t\tstrokes: this.state.strokes.concat(p)\n\t\t})\n\t\t// sendStroke(this.props.socket, {x: posX/this.props.width, y: posY/this.props.height, canvasType: \"ai\"}, this.props.color, this.props.thickness)\n\t\t\n    }\n\n\tonDrawStart = (event) => {\n\t\tif (this.props.disable ||  this.props.brushType !== brushTypes.AI) {\n\t\t\treturn\n\t\t}\n\t\t// console.log(\"Got start event:\", event)\n\t\tvar posX = event.nativeEvent.locationX\n\t\tvar posY = event.nativeEvent.locationY\n\n\t\t// Create stroke move object\n\t\tvar p = new Point(posX, posY, this.props.thickness, this.props.color, \"start\", \"ai\")\n\t\tthis.updateCanvas(p, \"self\")\n\n\t\tthis.setState({\n\t\t\tstrokes: this.state.strokes.concat(p)\n\t\t} )\n\t\t// socket: start stroke\n\t\t// sendStrokeStart(this.props.socket, {x: p.x/this.width, y: p.y/this.height}, p.thickness, p.color);\n\n\t}\n\n\tonDrawEnd = (event) => {\n\t\tif (this.props.disable || this.props.brushType !== brushTypes.AI) {\n\t\t\treturn\n\t\t}\n\t\tvar posX = event.nativeEvent.locationX\n\t\tvar posY = event.nativeEvent.locationY\n\n\t\t// Create stroke move object\n\t\tvar p = new Point(posX, posY, this.props.thickness, this.props.color,  \"end\", \"ai\")\n\t\tthis.updateCanvas(p, \"self\")\n\n\t\tthis.setState({\n\t\t\tstrokes: this.state.strokes.concat(p)\n\t\t})\n\t\t// socket: end stroke\n\t\t// sendStrokeEnd(this.props.socket, this.props.color, this.props.thickness);\n\t}\n\n\tupdateCanvas = (point, client) => {\n\t\t// client: \"self\" | \"other\"\n\t\t// point: Point\n\n\t\t// draw a point\n\t\tif (!this.canvasRef) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar strokes;\n\t\tvar lastPoint;\n\t\t// Error checking\n\t\tif (client == \"self\")\n\t\t{\n\t\t\tif (!this.state.strokes || this.state.strokes.length < 1)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tstrokes = this.state.strokes\n\t\t\t\tlastPoint = strokes[strokes.length-1]\t\n\t\t\t}\n\t\t} else\n\t\t{\n\t\t\tif (!this.props.otherStrokes || this.props.otherStrokes.length < 3)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t} else {\n\t\t\t\tstrokes = this.props.otherStrokes\n\t\t\t\tlastPoint = strokes[strokes.length-2]\t\n\t\t\t}\n\t\t}\n\t\t\n\n\n\n\t\tvar canvas = this.canvasRef.current\n\t\tvar len = strokes.length\n\t\t// console.log(\"canvas is\", canvas == null)\n\n\t\tif (canvas && len > 0) {\n\t\t\tvar {x, y, type, thickness} = point\n\t\t\t// console.log(\"lastpoint is\", lastPoint, \"point is\",)\n\t\t\tvar ctx = canvas.getContext(\"2d\");\n\t\t\tctx.lineWidth = thickness\n\n\t\t\tswitch (type) {\n\t\t\t\tcase \"start\":\n\t\t\t\t\tctx.moveTo(x, y)\n\t\t\t\t\tctx.beginPath();\n\t\t\t\t\tctx.lineTo(x, y);\n\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"end\":\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"move\":\n\t\t\t\t\tctx.beginPath();\n\n\t\t\t\t\tctx.moveTo(lastPoint.x, lastPoint.y)\n\n\t\t\t\t\tctx.globalCompositeOperation = 'source-over';\n\t\t\t\t\tctx.lineTo(x, y);\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\t\t\tctx.fillStyle = point.color;\n\t\t\tctx.strokeStyle = point.color;\n\t\t\tctx.lineJoin = ctx.lineCap = 'round';\n\t\t\tctx.closePath()\n\t\t\tctx.stroke();\t\t\t\n\n\t\t}\n\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.props.setClickClear(this.clearCanvas);\n\t }\n\t clearCanvas = () => {\n\t\tvar canvas = this.canvasRef.current\n\t\tvar ctx = canvas.getContext(\"2d\");\n\n\t\t// Fill upper half of the canvas with sky\n\t\tctx.fillStyle = \"#efefef\";\n\t\tctx.fillRect(0, 0, canvas.width, canvas.height);\n\t\t// if (this.props.isFirstLoadDrawCanvas)\n\t\t// {\n\t\t// \t// Fill bottom half of canvas with sea\n\t\t// \tctx.fillStyle = \"#384f83\";\n\t\t// \tctx.fillRect(0, 3*canvas.height/4, canvas.width, canvas.height/4);\n\t\t// }\n\t}\n\n\n\n\thandleCanvas = (canvas) => {\n\t\t// console.log(\"handling canvas\", canvas)\n\t\tif (canvas === null) {\n\t\t\treturn \n\t\t}\n\n\t\tconst ctx = canvas.getContext('2d');\n\t\tcanvas.width = this.props.width;\n\t\tcanvas.height = this.props.height;\n\n\t\tthis.canvasRef = canvas;\n\t\tthis.canvasRef.current = canvas;\n\n\t\tthis.clearCanvas();\n\t}\n\n\n\tgetPathData = (x, y, width, color) => {\n\t\treturn {\n\t\t  drawer: null,\n\t\t  size: {\n\t\t\twidth: this.canvas._size.width,\n\t\t\theight: this.canvas._size.height,\n\t\t  },\n\t\t  path: {\n\t\t\tdata: [`${x.toString()},${y.toString()}`],\n\t\t\t// eslint-disable-next-line radix\n\t\t\twidth: width,\n\t\t\tcolor: color,\n\t\t\tid: parseInt(Math.random() * 100000000),\n\t\t  },\n\t\t};\n\t  };\n\t\n\t  getPathDataArray = (data, width, color) => {\n\t\tparsedArr = [];\n\t\tfor (var i = 0; i < data.length; i++) {\n\t\t  parsedArr.push(`${data[i].x},${data[i].y}`);\n\t\t}\n\t\treturn {\n\t\t  drawer: null,\n\t\t  size: {\n\t\t\twidth: this.canvas._size.width,\n\t\t\theight: this.canvas._size.height,\n\t\t  },\n\t\t  path: {\n\t\t\tdata: parsedArr,\n\t\t\t// eslint-disable-next-line radix\n\t\t\twidth: width,\n\t\t\tcolor: color,\n\t\t\tid: parseInt(Math.random() * 100000000),\n\t\t  },\n\t\t};\n\t  };\n\n\tgetBase64 = async () => {\n\t\tvar canvas = this.canvasRef.current\n\t\t// console.log(\"Getting base64 is\", canvas.toDataURL());\n\n\t\t// toDataURL is a string on web, and a promise on android/ios\n\t\tvar ret = canvas.toDataURL(1.0) \n\n\t\t// web\n\t\tif (typeof(ret) == \"string\") {\n\t\t\tthis.setState((prevState) => ({\n\t\t\t\t...prevState,\n\t\t\t\timagedata: ret,\n\t\t\t}))\n\n\t\t\treturn Promise.resolve(ret)\n\n\n\t\t\t// android/ios\n\t\t} else {\n\t\t\treturn ret;\n\t\t}\n\t}\n\n\t// Send stroke point data\n\t// onStrokeChangeHandler = (x, y) => {\n\t// \tsendStroke(this.props.socket, {x: x, y: y, canvasType: \"ai\"}, this.props.color, this.props.thickness);\n\t// };\n\n\t// Send stroke end signal\n\t// onStrokeEndHandler = () => {\n\t// \tsendStrokeEnd(this.props.socket, this.props.color, this.props.thickness);\n\t// };\n\t// onStrokeStartHandler = (x, y) => {\n\t// \tsendStrokeStart(this.props.socket);\n\t// };\n   \n    render() {\n      if (Platform.OS === \"web\") {\n\t\treturn (\n\t\t<View\n\t\t\tstyle= {[styles.drawBoxInner, {width: this.props.width, height: this.props.height, opacity: this.props.opacity}]}\n\t\t\tonStartShouldSetResponder={(event) => {return true;}}\n\t\t\tonMoveShouldSetResponder={(event) => {return true;}}\n\t\t\tonResponderStart={this.onDrawStart}\n\t\t\tonResponderMove={this.onDrawMove}\n\t\t\tonResponderRelease={this.onDrawEnd}\n\t\t>\n        <canvas \n\t\tdraggable={false}\n\n\t\tref={this.handleCanvas}/>\n\t\t</View>\n\t\t)\n\t} else {\n\t\treturn (\n\t\t\t<View\n\t\t\tonStartShouldSetResponder={(event) => {return true;}}\n\t\t\tonMoveShouldSetResponder={(event) => {return true;}}\n\t\t\tonResponderStart={this.onDrawStart}\n\t\t\tonResponderMove={this.onDrawMove}\n\t\t\tonResponderRelease={this.onDrawEnd}\n\t\t\tstyle= {styles.drawBox}\n\t\t\t>\n\t\t\t<Canvas \n\t\t\tdraggable={false}\n\t\t\t\n\t\t\twidth={styles.drawBox.width}\n\t\t\t\t\theight={styles.drawBox.height} \n\t\t\t\t\tref={this.handleCanvas} \n\t\t\t/>\n\t\t\t</View>\n\t\t)\n\t}\n    }\n  }\n\n","export default {\n    // BACKEND_URL: \"104.154.79.84\"\n    BACKEND_URL: \"localhost\"\n}\n","export default {\n        ERASER: \"eraser\",\n        PENCIL: \"pencil\",\n        PAINT: \"paint\",\n        SPLOTCH: \"splotch\",\n        IMAGE_BRUSH: \"image_brush\",\n        IMAGE_CHARCOAL: \"image_charcoal\",\n        IMAGE_BALLPOINT: \"image_ballpoint\",\n        IMAGE_CHALK: \"image_chalk\",\n}\n","import React, { Component, useRef } from 'react';\nimport { Text, View, Platform, StyleSheet, Dimensions } from 'react-native';\nimport Canvas, { Image as CanvasImage } from 'react-native-canvas';\nimport { generateStyle } from '../styles/styles';\nimport Point from \"../classes/Point\";\nimport backendConstants from \"../constants/backendUrl\"\nimport { Asset } from 'expo-asset';\nimport {\n\tsendStroke,\n\tsendStrokeEnd,\n\tsendStrokeStart,\n} from '../api/websocketApi.js';\nimport brushTypes from \"../constants/brushTypes.js\"\nimport userBrushes from \"../constants/userBrushes.js\"\nvar device = Dimensions.get('window');\n\nconst styles = StyleSheet.create(generateStyle(device));\n\n\nexport default class UserCanvas extends Component {\n\n\n\tstate = {\n\t\tstrokes: [],\n\t\timageBrush: 'data:image/png;base64,', // raw image data of the image brush\n\t\timagedata: \"\",\n\t}\n\n\thexToRGB = (hex, alpha) => {\n\n\t\tconst r = parseInt(hex.slice(1, 3), 16);\n\t\tconst g = parseInt(hex.slice(3, 5), 16);\n\t\tconst b = parseInt(hex.slice(5, 7), 16);\n\n\t\tif (alpha) {\n\t\t\treturn `rgba(${r}, ${g}, ${b}, ${alpha})`;\n\t\t}\n\n\t\treturn `rgb(${r}, ${g}, ${b})`;\n\t}\n\n\tmyRand = (min, max) => {\n\t\treturn Math.random() * (max - min) + min;\n\t}\n\tmyRand2 = (val, range) => {\n\t\treturn this.myRand(val - range * val, val + range * val)\n\t}\n\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.handleCanvas = this.handleCanvas.bind(this);\n\t\tthis.thickness = props.thickness\n\t\tthis.color = props.color\n\t\tthis.canvasRef = null;\n\t\tthis.width = props.width;\n\t\tthis.height = props.height;\n\t\tthis.canvasOpacity = props.canvasOpacity;\n\n\t\tthis.state = {\n\t\t\tstrokes: [],\n\t\t\timageBrush: 'data:image/png;base64,', // raw image data of the image brush\n\t\t}\n\t\tthis.clearCanvas = this.clearCanvas.bind(this);\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.props.setClickClear(this.clearCanvas);\n\t\tthis.defaultWhiteCanvas()\n\t }\n\t makeBrushColor = (color) => {\n\t\tlet currentComponent = this;\n\t\tconsole.log(\"Making newbrush\")\n\n\t\tfetch(`http://${backendConstants.BACKEND_URL}:8000/makeBrush`,\n\t\t\t{\n\t\t\t\theaders: {\n\t\t\t\t\t'Accept': 'application/json',\n\t\t\t\t\t'Content-Type': 'application/json'\n\t\t\t\t},\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tbody: JSON.stringify(\n\t\t\t\t\t{\n\t\t\t\t\t\t\"brushType\": this.props.userBrushType,\n\t\t\t\t\t\t\"color\": color\n\t\t\t\t\t})\n\n\t\t\t\t\t\n\t\t\t})\n\t\t\t.then(function (res) {\n\t\t\t\tres.json().then(parsedJson => {\n\t\t\t\t\t// image.src = asset.uri ;\n\t\t\t\t\tcurrentComponent.setState((prevState, props) => {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t...prevState,\n\t\t\t\t\t\timageBrush: parsedJson.data.imageData\n\t\t\t\t\t}})\n\t\t\t  \n\n\t\t\t\t})\n\n\n\t\t\t})\n\t\t\t.catch(function (res) { console.log(res) })\n\n\t }\n\n\n\tcomponentDidUpdate(prevProps) {\n\t\tif (prevProps.otherStrokes != this.props.otherStrokes) {\n\t\t\tif (this.props.otherStrokes.length > 0) {\n\t\t\t\tvar newStroke = this.props.otherStrokes[this.props.otherStrokes.length-1]\n\t\t\t\tif (newStroke.canvasType == brushTypes.USER)\n\t\t\t\t{\n\t\t\t\t\tthis.updateCanvas(newStroke, \"other\")\t\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\n\t\t// If canvas size has changed\n\t\tif (prevProps.width != this.props.width || prevProps.height != this.props.height) {\n\n\t\n\t\t\t\tthis.canvasRef.current.width = this.props.width;\n\t\t\t\tthis.canvasRef.current.height = this.props.height;\n\n\t\t\t\t// this.clearCanvasKeepState();\n\t\t\t\tconsole.log(\"RESIZING CANVAS\")\n\t\t\t\t// this.loadData();\n\t\t}\n\n\t\tlet currentComponent = this;\n\t\t// If user changed the brush type to image brush changed color, request a new brush image\n\t\tif (this.props.brushType === brushTypes.USER && \n\t\t\t(this.props.userBrushType.includes(\"image\") &&\n\t\t\tprevProps.userBrushType !== this.props.userBrushType) ||\n\t\t\tprevProps.color !== this.props.color) {\n\t\t\t\tconsole.log(\"Making newbrush\")\n\n\t\t\t\tfetch(`http://${backendConstants.BACKEND_URL}:8000/makeBrush`,\n\t\t\t\t\t{\n\t\t\t\t\t\theaders: {\n\t\t\t\t\t\t\t'Accept': 'application/json',\n\t\t\t\t\t\t\t'Content-Type': 'application/json'\n\t\t\t\t\t\t},\n\t\t\t\t\t\tmethod: \"POST\",\n\t\t\t\t\t\tbody: JSON.stringify(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\"brushType\": this.props.userBrushType,\n\t\t\t\t\t\t\t\t\"color\": this.props.color\n\t\t\t\t\t\t\t})\n\t\t\t\t\t})\n\t\t\t\t\t.then(function (res) {\n\t\t\t\t\t\tres.json().then(parsedJson => {\n\t\t\t\t\t\t\t// image.src = asset.uri ;\n\t\t\t\t\t\t\tcurrentComponent.setState((prevState, props) => {\n\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t...prevState,\n\t\t\t\t\t\t\t\timageBrush: parsedJson.data.imageData\n\t\t\t\t\t\t\t}})\n\t\t\t\t\t  \n\n\t\t\t\t\t\t})\n\n\n\t\t\t\t\t})\n\t\t\t\t\t.catch(function (res) { console.log(res) })\n\n\t\t\t}\n\n\n\n\n\n\n\t\t// Update collaborator's drawings\n\t\t// DEPRECATED FOR NOW\n\t\t// if (prevProps.otherStrokes != this.props.otherStrokes) {\n\t\t// \t//   console.log(\"collaborator\", prevProps.otherStrokes, \"new:\", this.props.otherStrokes)\n\t\t// \tif (this.props.otherStrokes.length > 0) {\n\t\t// \t\tvar newStroke = this.props.otherStrokes[this.props.otherStrokes.length - 1]\n\t\t// \t\tthis.updateCanvas(newStroke, \"other\")\n\t\t// \t}\n\t\t// }\n\t}\n\n\tonDrawMove = (event) => {\n\t\t// Disable drawing on this canvas if brush type not selected\n\t\tif (this.props.disable ||  this.props.brushType !== brushTypes.USER) {\n\t\t\treturn;\n\t\t}\n\t\tvar posX = event.nativeEvent.locationX\n\t\tvar posY = event.nativeEvent.locationY\n\n\t\tvar p = new Point(posX, posY, this.props.thickness, this.hexToRGB(this.props.color, this.props.opacity), \"move\")\n\t\tthis.updateCanvas(p, \"self\")\n\n\t\t// Deprecated multi-brush\n\t\t// var q = new Point(posX, posY, this.props.thickness, this.hexToRGB(this.props.color,0.9), \"move\")\n\t\t// q.offset = this.props.thickness*0.5\n\t\t// this.updateCanvas(q, \"self\")\n\n\t\t// var q = new Point(posX, posY, this.props.thickness*0.4, this.hexToRGB(this.props.color,0.9), \"move\")\n\t\t// q.offset = -this.props.thickness*0.4\n\t\t// this.updateCanvas(q, \"self\")\n\n\t\t// var q = new Point(posX, posY, this.props.thickness*0.4, this.hexToRGB(this.props.color,0.95), \"move\")\n\t\t// q.offset = this.props.thickness*0.4\n\t\t// this.updateCanvas(q, \"self\")\n\n\n\t\t// var r = new Point(posX, posY+this.props.thickness*0.8, this.props.thickness, this.hexToRGB(this.props.color,0.4), \"move\")\n\t\t// this.updateCanvas(r, \"self\")\n\n\n\t\t// Create stroke move object\n\t\tthis.setState(prevState => ({\n\t\t\t...prevState,\n\t\t\tstrokes: this.state.strokes.concat(p)\n\t\t}))\n\t\t// sendStroke(this.props.socket, {x: posX/this.width, y: posY/this.height, canvasType: \"user\"}, this.props.color, this.props.thickness)\n\n\t}\n\n\tonDrawStart = (event) => {\n\t\t// Disable drawing on this canvas if brush type not selected\n\t\tif (this.props.disable ||  this.props.brushType !== brushTypes.USER) {\n\t\t\treturn;\n\t\t}\n\t\t// console.log(\"Got start event:\", event)\n\t\tvar posX = event.nativeEvent.locationX\n\t\tvar posY = event.nativeEvent.locationY\n\n\t\t// Create stroke move object\n\t\tvar p = new Point(posX, posY, this.props.thickness, this.props.color, \"start\", \"user\")\n\t\tthis.updateCanvas(p, \"self\")\n\n\t\tthis.setState(prevState => ({\n\t\t\t...prevState,\n\t\t\tstrokes: this.state.strokes.concat(p)\n\t\t}))\n\t\t// socket: start stroke\n\t\t// sendStrokeStart(this.props.socket, {x: p.x, y: p.y}, p.thickness, p.color);\n\n\t}\n\n\tonDrawEnd = (event) => {\n\t\t// Disable drawing on this canvas if brush type not selected\n\t\tif (this.props.disable ||  this.props.brushType !== brushTypes.USER) {\n\t\t\treturn;\n\t\t}\n\t\tvar posX = event.nativeEvent.locationX\n\t\tvar posY = event.nativeEvent.locationY\n\n\t\t// Create stroke move object\n\t\tvar p = new Point(posX, posY, this.props.thickness, this.props.color, \"end\", \"user\")\n\t\tthis.updateCanvas(p, \"self\")\n\n\t\tthis.setState(prevState => ({\n\t\t\t...prevState,\n\t\t\tstrokes: this.state.strokes.concat(p)\n\t\t}))\n\t\t// socket: end stroke\n\t\t// sendStrokeEnd(this.props.socket, this.props.color, this.props.thickness);\n\t}\n\n\tclearCanvas = () => {\n\n\t\tthis.setState(prevState => ({\n\t\t\t...prevState,\n\t\t\timagedata: \"\"\n\t\t}))\n\t\tvar canvas = this.canvasRef.current\n\t\tvar ctx = canvas.getContext(\"2d\");\n\t\tctx.clearRect(0, 0, canvas.width, canvas.height);\n\t}\n\n\tclearCanvasKeepState = () => {\n\t\tvar canvas = this.canvasRef.current\n\t\tvar ctx = canvas.getContext(\"2d\");\n\t\tctx.clearRect(0, 0, canvas.width, canvas.height);\n\t}\n\n\tupdateCanvas = (point, client) => {\n\t\t// client: \"self\" | \"other\"\n\t\t// point: Point\n\n\t\t// draw a point\n\t\tif (!this.canvasRef) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar offset = point.offset || 0;\n\n\t\tvar strokes;\n\t\tvar lastPoint;\n\t\t// Error checking\n\t\tif (client == \"self\") {\n\t\t\tif (!this.state.strokes || this.state.strokes.length < 1) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tstrokes = this.state.strokes\n\t\t\t\tlastPoint = strokes[strokes.length - 1]\n\t\t\t}\n\t\t} else {\n\t\t\tif (!this.props.otherStrokes || this.props.otherStrokes.length < 3) {\n\t\t\t\treturn;\n\t\t\t} else {\n\t\t\t\tstrokes = this.props.otherStrokes\n\t\t\t\tlastPoint = strokes[strokes.length - 2]\n\t\t\t}\n\t\t}\n\n\n\n\n\t\tvar canvas = this.canvasRef.current\n\t\tvar len = strokes.length\n\t\t// console.log(\"canvas is\", canvas == null)\n\n\t\tif (canvas && len > 0) {\n\t\t\tvar { x, y, type, thickness } = point\n\t\t\t// console.log(\"lastpoint is\", lastPoint, \"point is\",)\n\t\t\tvar ctx = canvas.getContext(\"2d\");\n\t\t\tctx.lineWidth = thickness\n\n\t\t\tswitch (type) {\n\t\t\t\tcase \"start\":\n\t\t\t\t\tctx.moveTo(x - offset, y - offset)\n\t\t\t\t\tctx.beginPath();\n\t\t\t\t\tctx.lineTo(x - offset, y - offset);\n\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"end\":\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"move\":\n\t\t\t\t\tctx.beginPath();\n\n\t\t\t\t\tctx.moveTo(lastPoint.x - offset, lastPoint.y - offset)\n\n\t\t\t\t\tctx.lineTo(x - offset, y - offset);\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tif (this.props.userBrushType == userBrushes.PAINT) {\n\t\t\t\tctx.fillStyle = this.hexToRGB(this.props.color, this.props.opacity);\n\t\t\t\tctx.strokeStyle = this.hexToRGB(this.props.color, this.props.opacity);\n\t\t\t\tctx.lineJoin = 'miter';\n\t\t\t\tctx.lineCap = \"butt\";\n\t\t\t\tconsole.log(\"IANTNT\", ctx.lineJoin, ctx.lineCap)\n\n\t\t\t\tctx.closePath()\n\t\t\t\tctx.stroke();\n\t\t\t}\n\n\t\t\telse if (this.props.userBrushType == userBrushes.PENCIL) {\n\t\t\t\tctx.fillStyle = this.hexToRGB(this.props.color, this.props.opacity);\n\t\t\t\tctx.strokeStyle = this.hexToRGB(this.props.color, this.props.opacity);\n\t\t\t\tctx.lineJoin = ctx.lineCap = 'round';\n\t\t\t\tctx.closePath()\n\t\t\t\tctx.stroke();\n\t\t\t}\n\n\t\t\telse if (this.props.userBrushType == userBrushes.ERASER) {\n\t\t\t\tctx.globalCompositeOperation = \"destination-out\";  \n\t\t\t\tctx.lineJoin = ctx.lineCap = 'round';\n\n\t\t\t\tctx.strokeStyle = \"rgba(255,255,255,1)\";\n\t\t\t\tctx.closePath()\n\t\t\t\tctx.stroke();\n\t\t\t\tctx.globalCompositeOperation = \"source-over\"; // reset to default  \n\n\t\t\t}\n\n\n\n\t\t\t// SPLOTCH BRUSH\n\t\t\telse if (this.props.userBrushType == userBrushes.SPLOTCH) {\n\t\t\t\tif (Math.random() < 0.99) {\n\t\t\t\t\t// ctx.stroke();\t\t\t\n\t\t\t\t\tctx.beginPath()\n\t\t\t\t\tctx.arc(x - offset, y - offset, Math.random() * thickness/2, false, Math.PI * 2, false);\n\t\t\t\t\tctx.fillStyle = this.hexToRGB(this.props.color, Math.random());\n\n\t\t\t\t\tctx.fill();\n\n\t\t\t\t}\n\t\t\t}\n\n\t\t\telse if (this.props.userBrushType.includes(\"image\")) {\n\t\t\t\t// IMAGE BRUSH\n\t\t\t\tctx.globalAlpha = this.props.opacity\n\n\t\t\t\tconst image = new Image(canvas);\n\t\t\t\timage.src = this.state.imageBrush\n\n\t\t\t\tctx.save();\n\n\t\t\t\tctx.translate((x - offset - thickness / 2)+thickness/2, (y - offset - thickness / 2)+thickness/2);\n\t\t\t\tvar angle = Math.atan2(y-lastPoint.y, x-lastPoint.x) * 180 / Math.PI;\n\t\t\t\tctx.rotate(angle*Math.PI/180.0);\n\t\t\t\tctx.translate(-(x - offset - thickness / 2)-thickness/2, -(y - offset - thickness / 2)-thickness/2);\n\t\t\t\tctx.drawImage(image, x - offset - thickness / 2, y - offset - thickness / 2, thickness, thickness);\n\t\t\t\tctx.restore();\n\n\t\t\t\tctx.globalAlpha = 1\n\n\t\t\t}\n\n\n\n\n\n\t\t}\n\n\t}\n\tloadData = (imageData) => {\n\t\t\tvar canvas = this.canvasRef.current\n\n\t\t\tvar ctx = canvas.getContext(\"2d\");\n\t\t\tconst image = new Image(canvas);\n\t\n\t\t\timage.src = imageData\n\t\t\tctx.save();\n\t\t\tctx.drawImage(image,0,0, this.props.width, this.props.height);\n\t\t\tctx.restore();\n\t\t\n\t}\n\n\n\thandleCanvas = (canvas) => {\n\t\tif (canvas === null) {\n\t\t\treturn \n\t\t}\n\t\t// console.log(\"handling canvas\", canvas)\n\n\t\tconst ctx = canvas.getContext('2d');\n\t\tcanvas.width = this.props.width;\n\t\tcanvas.height = this.props.height;\n\n\n\n\t\tthis.canvasRef = canvas;\n\t\tthis.canvasRef.current = canvas;\n\n\n\n\t}\n\n\n\tgetPathData = (x, y, width, color) => {\n\t\treturn {\n\t\t\tdrawer: null,\n\t\t\tsize: {\n\t\t\t\twidth: this.canvas._size.width,\n\t\t\t\theight: this.canvas._size.height,\n\t\t\t},\n\t\t\tpath: {\n\t\t\t\tdata: [`${x.toString()},${y.toString()}`],\n\t\t\t\t// eslint-disable-next-line radix\n\t\t\t\twidth: width,\n\t\t\t\tcolor: color,\n\t\t\t\tid: parseInt(Math.random() * 100000000),\n\t\t\t},\n\t\t};\n\t};\n\n\tgetPathDataArray = (data, width, color) => {\n\t\tparsedArr = [];\n\t\tfor (var i = 0; i < data.length; i++) {\n\t\t\tparsedArr.push(`${data[i].x},${data[i].y}`);\n\t\t}\n\t\treturn {\n\t\t\tdrawer: null,\n\t\t\tsize: {\n\t\t\t\twidth: this.canvas._size.width,\n\t\t\t\theight: this.canvas._size.height,\n\t\t\t},\n\t\t\tpath: {\n\t\t\t\tdata: parsedArr,\n\t\t\t\t// eslint-disable-next-line radix\n\t\t\t\twidth: width,\n\t\t\t\tcolor: color,\n\t\t\t\tid: parseInt(Math.random() * 100000000),\n\t\t\t},\n\t\t};\n\t};\n\n\tgetBase64 = async () => {\n\t\tvar canvas = this.canvasRef.current\n\t\t// console.log(\"Getting base64 is\", canvas.toDataURL());\n\n\t\tvar ret = canvas.toDataURL()\n\n\t\t// web\n\t\tif (typeof (ret) == \"string\") {\n\t\t// toDataURL is a string on web, and a promise on android/ios\n\t\tthis.setState((prevState) => ({\n\t\t\t...prevState,\n\t\t\timagedata: ret,\n\t\t}))\n\t\t\treturn Promise.resolve(ret)\n\t\t\t// android/ios\n\t\t} else {\n\t\t\treturn ret;\n\t\t}\n\t}\n\n\n\t// FOR COLLABORATIVE DRAWING \n\t// DISABLED FOR NOW\n\n\t// Send stroke point data\n\t// onStrokeChangeHandler = (x, y) => {\n\t// \tsendStroke(this.props.socket, { x: x, y: y, canvasType: \"user\"}, this.props.color, this.props.thickness);\n\t// };\n\n\t// Send stroke end signal\n\tonStrokeEndHandler = () => {\n\t\t// sendStrokeEnd(this.props.socket, this.props.color, this.props.thickness);\n\t};\n\tonStrokeStartHandler = (x, y) => {\n\t\t// sendStrokeStart(this.props.socket);\n\t};\n\n\tdefaultWhiteCanvas = () => {\n\t\tvar canvas = this.canvasRef.current\n\t\tvar ctx = canvas.getContext(\"2d\");\n\n\t\t// Fill upper half of the canvas with sky\n\t\tctx.fillStyle = \"rgba(255,255,255,0.0)\";\n\t\tctx.fillRect(0, 0, canvas.width, canvas.height);\n\n\t}\n\n\trender() {\n\t\tif (Platform.OS === \"web\") {\n\t\t\treturn (\n\t\t\t\t<View\n\t\t\t\t\tstyle={[styles.drawBoxInner, { width: this.props.width, height: this.props.height }]}\n\t\t\t\t\tonStartShouldSetResponder={(event) => { return true; }}\n\t\t\t\t\tonMoveShouldSetResponder={(event) => { return true; }}\n\t\t\t\t\tonResponderStart={this.onDrawStart}\n\t\t\t\t\tonResponderMove={this.onDrawMove}\n\t\t\t\t\tonResponderRelease={this.onDrawEnd}\n\t\t\t\t>\n\t\t\t\t\t<canvas \n\t\t\t\t\tdraggable={false}\n\t\t\t\t\tref={this.handleCanvas} id=\"mycanvas\"\n\t\t\t\t\twidth={this.props.width}\n\t\t\t\t\theight={this.props.height}\n\t\t\t\t\t />\n\t\t\t\t</View>\n\t\t\t)\n\t\t} else {\n\t\t\treturn (\n\t\t\t\t<View\n\t\t\t\t\tonStartShouldSetResponder={(event) => { return true; }}\n\t\t\t\t\tonMoveShouldSetResponder={(event) => { return true; }}\n\t\t\t\t\tonResponderStart={this.onDrawStart}\n\t\t\t\t\tonResponderMove={this.onDrawMove}\n\t\t\t\t\tonResponderRelease={this.onDrawEnd}\n\t\t\t\t\tstyle={styles.drawBox}\n\t\t\t\t>\n\t\t\t\t\t<Canvas width={styles.drawBox.width}\n\t\t\t\t\t\theight={styles.drawBox.height}\n\t\t\t\t\t\tref={this.handleCanvas}\n\t\t\t\t\t\tid=\"mycanvas\"\n\t\t\t\t\t\tdraggable={false}\n\t\t\t\t\t/>\n\t\t\t\t</View>\n\t\t\t)\n\t\t}\n\t}\n}\n\n","import React, { useEffect, useState  } from 'react';\nimport {\n  View,\n} from \"react-native\";\nimport { Button, Select, Input, Typography, Card, Image } from 'antd';\nconst { Title } = Typography;\n \nconst options = [\n\t{ value: '油画', label: '油画' },\n\t{ value: '插画', label: '插画' },\n\t{ value: '卡通', label: '卡通' },\n\t{ value: '科幻', label: '科幻' },\n\t{ value: '古风', label: '古风' },\n\t{ value: '高清', label: '高清' },\n\t{ value: '壁纸', label: '壁纸' },\n\t{ value: '色彩艳丽', label: '色彩艳丽' },\n\t{ value: '黑白', label: '黑白' },\n]\n\nconst InspireMode = (props) => {\n\tconst {localurl} = props;\n\tconst [prompt, setPrompt] = useState({\n\t\t\"one\": '',\n\t\t\"two\": '',\n\t\t\"three\": ''\n\t});\n\tconst [style, setStyle] = useState({\n\t\t\"one\": '',\n\t\t\"two\": '',\n\t\t\"three\": ''\n\t}) ;\n\tconst [list, setList] = useState({\n\t\t\"one\": [],\n\t\t\"two\": [],\n\t\t\"three\": []\n\t});\n\tconst [loadings, setLoadings] = useState([]);\n\n\tconst sections = [\"one\", \"two\", \"three\"];\n\n  useEffect(() => {\n    console.log(\"Mounting...\");\n  },[]);\n\n\tconst handleGenerate = async (section, index) => {\n\t\tconsole.log(section);\n\t\tconsole.log(`${prompt[section]},${style[section]}`);\n\n\t\tsetLoadings((prevLoadings) => {\n      const newLoadings = [...prevLoadings];\n      newLoadings[index] = true;\n      return newLoadings;\n    });\n\n\t\tconst response = await fetch(`${localurl}/inspire`, {\n      method: 'POST',\n      headers: {\n          'Content-Type': 'application/json',\n          'Authorization': 'Token f40e401a60e03f6ae459a36e1faa4e5c575819f5'\n      },\n      body: JSON.stringify({\n        prompt: `${prompt[section]},${style[section]}`,\n      }),\n    });\n\n    const msg = await response.json()\n    console.log(msg.data)\n\n\t\tif(section === \"one\") {\n\t\t\tsetList((olddata)=>{\n\t\t\t\treturn{\n\t\t\t\t...olddata,\n\t\t\t\tone: msg.data\n\t\t\t\t}\n\t\t\t})\n\t\t}else if(section === \"two\"){\n\t\t\tsetList((olddata)=>{\n\t\t\t\treturn{\n\t\t\t\t...olddata,\n\t\t\t\ttwo: msg.data\n\t\t\t\t}\n\t\t\t})\n\t\t}else{\n\t\t\tsetList((olddata)=>{\n\t\t\t\treturn{\n\t\t\t\t...olddata,\n\t\t\t\tthree: msg.data\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\n\t\tsetLoadings((prevLoadings) => {\n\t\t\tconst newLoadings = [...prevLoadings];\n\t\t\tnewLoadings[index] = false;\n\t\t\treturn newLoadings;\n\t\t});\n\n\t};\n\n\treturn (\n\t\t<>\n\t\t\t<Title style={{ margin: 10 }} level={3}>AI艺术疗愈</Title>\n\t\t\t{sections.map((section, index) => (\n\t\t\t\t<View style={{ flexDirection: \"row\", margin: \"2%\" }}>\n\t\t\t\t\t<Card style={{ width: \"40%\" }}>\n\t\t\t\t\t\t<Title style={{ margin: 10 }} level={5}>图片{index+1}</Title>\n\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\tsize=\"large\"\n\t\t\t\t\t\t\tonChange={(e) => {\n\t\t\t\t\t\t\t\tif(section === \"one\") {\n\t\t\t\t\t\t\t\t\tsetPrompt((olddata)=>{\n\t\t\t\t\t\t\t\t\t\treturn{\n\t\t\t\t\t\t\t\t\t\t...olddata,\n\t\t\t\t\t\t\t\t\t\tone: e.target.value\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t}else if(section === \"two\"){\n\t\t\t\t\t\t\t\t\tsetPrompt((olddata)=>{\n\t\t\t\t\t\t\t\t\t\treturn{\n\t\t\t\t\t\t\t\t\t\t...olddata,\n\t\t\t\t\t\t\t\t\t\ttwo: e.target.value\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\tsetPrompt((olddata)=>{\n\t\t\t\t\t\t\t\t\t\treturn{\n\t\t\t\t\t\t\t\t\t\t...olddata,\n\t\t\t\t\t\t\t\t\t\tthree: e.target.value\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tstyle={{ width: '100%', marginTop: \"10px\" }}\n\t\t\t\t\t\t\tplaceholder=\"文字描述\"\n\t\t\t\t\t\t\tvalue={prompt[section]}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<Select\n\t\t\t\t\t\t\tsize=\"large\"\n\t\t\t\t\t\t\tmode=\"multiple\"\n\t\t\t\t\t\t\tallowClear\n\t\t\t\t\t\t\tstyle={{ width: '60%', maxWidth: '70%', marginTop: \"15px\", marginRight: \"10px\" }}\n\t\t\t\t\t\t\tonChange={(value) => {\n\t\t\t\t\t\t\t\tif(section === \"one\") {\n\t\t\t\t\t\t\t\t\tsetStyle((olddata)=>{\n\t\t\t\t\t\t\t\t\t\treturn{\n\t\t\t\t\t\t\t\t\t\t...olddata,\n\t\t\t\t\t\t\t\t\t\tone: `${value}`\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t}else if(section === \"two\"){\n\t\t\t\t\t\t\t\t\tsetStyle((olddata)=>{\n\t\t\t\t\t\t\t\t\t\treturn{\n\t\t\t\t\t\t\t\t\t\t...olddata,\n\t\t\t\t\t\t\t\t\t\ttwo: `${value}`\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\tsetStyle((olddata)=>{\n\t\t\t\t\t\t\t\t\t\treturn{\n\t\t\t\t\t\t\t\t\t\t...olddata,\n\t\t\t\t\t\t\t\t\t\tthree: `${value}`\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tplaceholder=\"风格，多选\"\n\t\t\t\t\t\t\toptions={options}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<Button \n\t\t\t\t\t\t\ttype=\"primary\" \n\t\t\t\t\t\t\tstyle={{ width: '30%', marginTop: \"15px\" }} \n\t\t\t\t\t\t\tonClick = {() => handleGenerate(section, index)}\n\t\t\t\t\t\t\tloading={loadings[index]}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t生成 / 换一批\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</Card>\n\t\t\t\t\t<Card style={{ width: \"60%\" }}>\n\t\t\t\t\t\t<Image.PreviewGroup>\n\t\t\t\t\t\t\t<Image width={\"33%\"} src={list[section][0]} />\n\t\t\t\t\t\t\t<Image width={\"33%\"} src={list[section][1]} />\n\t\t\t\t\t\t\t<Image width={\"33%\"} src={list[section][2]} />\n\t\t\t\t\t\t</Image.PreviewGroup>\n\t\t\t\t\t</Card>\n\t\t\t\t</View>\n      ))}\n\t\t</>\n\t);\n}\n \nexport default InspireMode;\n\n","export default {\n  colors: [\n    {\n      color: '#384f83',\n      id: 154,\n      label: 'Sea',\n      logo: require('../resources/seaLogo.png'),\n      // logo: require('../resources/tmp/seaLogo2.png'),\n    },\n    {\n      color: '#efefef',\n      id: 105,\n      label: 'Cloud',\n      logo: require('../resources/cloudLogo.png'),\n      // logo: require('../resources/tmp/cloudLogo2.png'),\n      labelColor: \"#d3d3d3\"\n    },\n    {\n      color: '#2c1e16',\n      id: 110,\n      label: 'Dirt',\n      logo: require('../resources/dirtLogo.png'),\n      // logo: require('../resources/tmp/dirtLogo2.png'),\n    },\n    {\n      color: '#5d6e32',\n      id: 96,\n      label: 'Bush',\n      logo: require('../resources/bushLogo.png'),\n      // logo: require('../resources/tmp/bushLogo2.png'),\n    },\n    {\n      color: '#b7d24e',\n      id: 123,\n      label: 'grass',\n      labelColor: 'black',\n      logo: require('../resources/bushLogo.png'),\n    },\n    {\n      color: '#3c3b4b',\n      id: 134,\n      label: 'Mountain',\n      logo: require('../resources/mountainLogo.png'),\n      // logo: require('../resources/tmp/mountainLogo2.png'),\n    },\n    // {\n    //   color: '#987e6a',\n    //   id: 148,\n    //   label: 'road',\n    //   logo: './resources/roadLogo.png',\n    // },\n    {\n      color: '#759edf',\n      id: 156,\n      label: 'Sky',\n      logo: require('../resources/skyLogo.png'),\n      // logo: require('../resources/tmp/skyLogo2.png'),\n    },\n    {\n      color: '#352613',\n      id: 168,\n      label: 'Tree',\n      logo: require('../resources/treeLogo.png'),\n      // logo: require('../resources/tmp/treeLogo2.png'),\n    },\n    // {\n    //   color: '#c1c3c9',\n    //   id: 119,\n    //   label: 'fog',\n    //   logo: './resources/fogLogo.png',\n    // },\n    {\n      color: '#776c2d',\n      id: 126,\n      label: 'Hill',\n      logo: require('../resources/hillLogo.png'),\n      // logo: require('../resources/tmp/hillLogo2.png'),\n    },\n    // {\n    //   color: '#bf602c', \n    //   id: 128,\n    //   label: 'leaves',\n    //   logo: './resources/leavesLogo.png',\n    // },\n    {\n      color: '#32604d',\n      id: 147,\n      label: 'River',\n      logo: require('../resources/riverLogo.png'),\n      // logo: require('../resources/tmp/riverLogo2.png'),\n    },\n    {\n      color: '#000000',\n      id: 100,\n      label: 'user brush',\n      // logo: './resources/flowerLogo.png',\n    },\n    // {\n    //   color: '#fafafa',\n    //   id: 158,\n    //   label: 'snow',\n    //   labelColor: 'black',\n    //   logo: './resources/snowLogo.png',\n    // },\n  ],\n};\n","export default {\n  styles: [\n    {\n      name: 'kanagawa',\n      label: 'Kanagawa',\n      image_url: require('../resources/kanagawa.jpg'),\n    },\n    {\n      name: 'starry_night',\n      label: 'Starry Night',\n      image_url: require('../resources/starry_night.jpg'),\n    },\n    {\n      name: 'rain_princess',\n      label: 'Rain Princess',\n      image_url: require('../resources/rain_princess.jpg'),\n    },\n    {\n      name: 'candy',\n      label: 'Candy',\n      image_url: require('../resources/candy.jpg'),\n    },\n    {\n      name: 'mosaic',\n      label: 'Mosaic',\n      image_url: require('../resources/mosaic.jpg'),\n    },\n    {\n      name: 'udnie',\n      label: 'Udnie',\n      image_url: require('../resources/udnie.jpg'),\n    },\n  ],\n};\n","export default {\n  userBrushes: [\n    {\n      name: 'eraser',\n      label: 'Eraser',\n      image_url: require('../resources/brushes/Eraser.png'),\n    },\n    {\n      name: 'pencil',\n      label: 'Marker',\n      image_url: require('../resources/brushes/Marker.png'),\n    },\n    {\n      name: 'paint',\n      label: 'Highlighter',\n      image_url: require('../resources/brushes/Highlighter.png'),\n    },\n    {\n      name: 'splotch',\n      label: 'Splotch',\n      image_url: require('../resources/brushes/Splotch.png'),\n    },\n    {\n      name: 'image_brush',\n      label: 'Crayon',\n      image_url: require('../resources/brushes/Crayon.png'),\n    },\n    {\n      name: 'image_charcoal',\n      label: 'Charcoal',\n      image_url: require('../resources/brushes/Charcoal.png'),\n    },\n    {\n      name: 'image_ballpoint',\n      label: 'Ballpoint',\n      image_url: require('../resources/brushes/Ballpoint.png'),\n    },\n    {\n      name: 'image_chalk',\n      label: 'Chalk',\n      image_url: require('../resources/brushes/Chalk.png'),\n    },\n    ],\n};\n","export default {\n        filters: [\n                {\n                        name: 'blur',\n                        label: 'Blur',\n                        filter: \"blur(2px)\",\n                        image_url: require('../resources/filters/blur.png'),\n                },\n                {\n                        name: 'sepia',\n                        label: 'Sepia',\n                        filter: \"sepia(100)\",\n                        image_url: require('../resources/filters/sepia.png'),\n                },\n                {\n                        name: 'grey',\n                        label: 'Grey',\n                        filter: \"grayscale(80%)\",\n                        image_url: require('../resources/filters/grey.png'),\n                },\n                {\n                        name: 'contrast',\n                        label: 'Contrast',\n                        filter: \"contrast(150%)\",\n                        image_url: require('../resources/filters/contrast.png'),\n                },\n                {\n                        name: 'fade',\n                        label: 'Fade',\n                        filter: \"blur(0.2px) brightness(110%) hue-rotate(5deg) saturate(0.5) opacity(85%)\",\n                        //                         filter: \"blur('0.2px'),brightness(110%),hue-rotate('5deg') opacity(0.9) saturate(1.3) sepia(40)\",\n\n                        image_url: require('../resources/filters/fade.png'),\n                },\n                {\n                        name: 'invert',\n                        label: 'Invert',\n                        filter: \"invert(100%) hue-rotate(90deg)\",\n                        image_url: require('../resources/filters/invert.png'),\n                }\n        ],\n};\n","import React, { Component } from \"react\";\nimport {\n  ActivityIndicator,\n  StyleSheet,\n  View,\n  Button,\n  Dimensions,\n  Image,\n  TouchableOpacity,\n  Text,\n  TextInput,\n  ImageBackground,\n} from \"react-native\";\nimport DrawCanvas from \"./components/DrawCanvas\";\nimport UserCanvas from \"./components/UserCanvas\";\nimport InspireMode from \"./components/InspireMode\";\n\nimport Slider from \"@react-native-community/slider\";\nimport colorMap from \"./constants/colorMap.js\";\nimport brushTypes from \"./constants/brushTypes.js\";\nimport userBrushes from \"./constants/userBrushes.js\";\nimport styleTransferOptions from \"./constants/styleTransferOptions.js\";\nimport userBrushesOptions from \"./constants/userBrushesOptions.js\";\nimport filterOptions from \"./constants/filterBrushOptions.js\";\n\nimport messageKinds from \"./constants/messageKinds.js\";\nimport { ScrollView } from \"react-native-gesture-handler\";\nimport { Ionicons } from \"@expo/vector-icons\";\nimport { RgbaColorPicker } from \"react-colorful\";\n\nvar device = Dimensions.get(\"window\");\nconst CANVASWIDTH = device.height * 0.8;\nconst CANVASHEIGHT = device.height * 0.8;\n\n// const LOCALURL = \"http://127.0.0.1:8000\";\n// const LOCALURL = \"http://region-11.autodl.com:25172\"\nconst LOCALURL = \"\"\n\n// Connect to Go backend\n// for web\n// for android\n// let this.state.socket = new WebSocket('ws://10.0.2.2:8080/ws');\n\n// Create dynamic style based on device width/height\n// const styles = StyleSheet.create(generateStyle(device));\n\nexport default class App extends Component {\n  // React state: store the image data\n  state = {\n    showAICanvas: true,\n    showInspireMode: false,\n    showUserCanvas: false,\n\n    rightColumnWidth: device.height * 0.11 * 1.8,\n    rightColumnMargin: device.height * 0.007,\n\n    leftColumnWidth: device.height * 0.25,\n    leftColumnLeftMargin: device.height * 0.007,\n    //device.width - (device.height * (0.85 * 1.25 + 0.11 * 1.8 + 0.25 + 0.007 + 0.3))\n\n    //canvas + small canvas, right col, left col, marginleft of left col\n    AI_CANVASWIDTH: Math.min(\n      (device.width - device.height * (0.11 * 1.8 + 0.25 + 0.007 + 0.15)) * 0.65,\n      device.height * 0.65\n    ),\n    // device.height * (0.85 * 1.25 + 0.11 * 1.8 + 0.25 + 0.007) > device.width\n    //   ? device.height * 0.5\n    //   : device.height * 0.85,\n    AI_CANVASHEIGHT: Math.min(\n      (device.width - device.height * (0.11 * 1.8 + 0.25 + 0.007 + 0.15)) * 0.65,\n      device.height * 0.65\n    ),\n    //AI_CANVASWIDTH: device.height * 0.85,\n    //AI_CANVASHEIGHT: device.height * 0.85,\n\n    //USER_CANVASWIDTH: device.height * 0.85,\n    //USER_CANVASHEIGHT: device.height * 0.85,\n    USER_CANVASWIDTH: Math.min(\n      (device.width - device.height * (0.11 * 1.8 + 0.25 + 0.007 + 0.15)) * 0.65,\n      device.height * 0.65\n    ),\n    USER_CANVASHEIGHT: Math.min(\n      (device.width - device.height * (0.11 * 1.8 + 0.25 + 0.007 + 0.15)) * 0.65,\n      device.height * 0.65\n    ),\n    aiCanvasImageData: \"data:image/png;base64,\", // image data of the ai canvas\n\n    imageData: \"data:image/png;base64,\", // raw image data of the segmentation image\n    generatedImageData: \"data:image/png;base64,\", // raw image data of the generated image\n    stylizedImageData: \"data:image/png;base64,\", // raw image data of stylized generated image\n    displayedImageData: \"data:image/png;base64,\", // raw image data of displayed image\n    finalImageData: \"data:image/png;base64,\", // raw image data of generatedImageData + userCanvasImageData\n    style: \"none\", // selected style\n    color: \"#384f83\", // pen color\n    imageFilter: \"\",\n    userBrushColor: \"#00FF00\",\n    colorPickerDisplay: { r: 0, g: 255, b: 0, a: 1 }, // another color state to keep track of the current color picker state\n\n    userBrushBase64: \"data:image/png;base64,\", // user brush\n    userBrushType: userBrushes.PENCIL,\n    styleBrushType: \"None\",\n    filterBrushType: \"None\",\n    thickness: 10, // stroke thickness\n    ownStroke: [], // client stroke data\n    collaboratorStroke: [], // collaborator data\n    opacity: 1, // Toggle between the drawing canvas and generated image.\n    displayColorPicker: false,\n    disableDrawing: false, // used when eyedropper is active\n    disableButtons: false, // used when the eyedropper is active\n    // 1 = show drawing canvas, 0 = show image\n    // socket: new WebSocket('ws://localhost:8080/ws')\n    // socket:\n    //   Platform.OS === \"web\"\n    //     ? new WebSocket(`ws://${backendConstants.BACKEND_URL}:8080/ws`)\n    //     : new WebSocket(`ws://${backendConstants.BACKEND_URL}:8080/ws`),\n    canvasWidth: CANVASWIDTH,\n    canvasHeight: CANVASHEIGHT,\n    currentBrush: brushTypes.AI,\n\n    showPreview: true, // show the preview of the other canvas at the top left corner\n\n    isLoading: true, //for loading spinner\n    isChangeSize: false, //for slider\n\n    isFirstLoadDrawCanvas: true, // show a default segmentation map for the first time in the AI canvas\n    text: '',\n    flag: 1\n  };\n\n  constructor(props) {\n    super(props);\n    this.sendRequestHelper = this.sendRequestHelper.bind(this);\n  }\n\n  // Run when component is first rendered\n  componentDidMount() {\n    console.log(\"Attempting connection\");\n\n    this.setState((prevState) => ({\n      ...prevState,\n      isLoading: false,\n      isFirstLoadDrawCanvas: false,\n    }));\n  }\n  // get image data from canvas\n  // Then call sendRequest to send the data to backend\n  grabPixelsGan = async () => {\n    this.setState((prevState) => ({\n      ...prevState,\n      isLoading: true,\n      flag: 1\n    }));\n    var getImage = this.refs.drawCanvasRef.getBase64().then((value) => {\n      var resultImage = value.split(\";base64,\")[1];\n      console.log(\"result image is\", resultImage);\n      this.setState(\n        (prevState) => ({\n          ...prevState,\n          imageData: resultImage,\n        }),\n        // Do callback to send to server after the imageData is set\n        this.sendRequestHelper\n      );\n    });\n  };\n\n  grabPixelsSd = async () => {\n    this.setState((prevState) => ({\n      ...prevState,\n      isLoading: true,\n      flag: 2\n    }));\n    var getImage = this.refs.drawCanvasRef.getBase64().then((value) => {\n      var resultImage = value.split(\";base64,\")[1];\n      console.log(\"result image is\", resultImage);\n      this.setState(\n        (prevState) => ({\n          ...prevState,\n          imageData: resultImage,\n        }),\n        // Do callback to send to server after the imageData is set\n        this.sendRequestHelper\n      );\n    });\n  };\n\n  grabPixelsCN = async () => {\n    this.setState((prevState) => ({\n      ...prevState,\n      isLoading: true,\n      flag: 3\n    }));\n    var getImage = this.refs.drawCanvasRef.getBase64().then((value) => {\n      var resultImage = value.split(\";base64,\")[1];\n      console.log(\"result image is\", resultImage);\n      this.setState(\n        (prevState) => ({\n          ...prevState,\n          imageData: resultImage,\n        }),\n        // Do callback to send to server after the imageData is set\n        this.sendRequestHelper\n      );\n    });\n  };\n\n  // Send request to model server to generate painting\n  sendRequestHelper = async () => {\n    this.setState((prevState) => ({\n      ...prevState,\n      isLoading: true,\n    }));\n\n    const response = await fetch(`${LOCALURL}/generate`, {\n      method: 'POST',\n      headers: {\n          'Content-Type': 'application/json',\n          'Authorization': 'Token f40e401a60e03f6ae459a36e1faa4e5c575819f5'\n      },\n      body: JSON.stringify({\n        imageData: this.state.imageData,\n        prompt: this.state.text,\n        flag: this.state.flag\n      }),\n    });\n\n    const msg = await response.json()\n    console.log(msg)\n    this.setState((prevState) => ({\n      ...prevState,\n      generatedImageData: msg.data,\n      displayedImageData: msg.data,\n    }));\n\n    this.setState((prevState) => ({\n      ...prevState,\n      isLoading: false,\n    }));\n\n  };\n  // Send a request to the model server to stylize the generated painting\n  sendRequestStyleHelper = async (newStyle) => {\n    this.setState((prevState) => ({\n      ...prevState,\n      isLoading: true,\n    }));\n\n    const response = await fetch(`${LOCALURL}/stylize`, {\n      method: 'POST',\n      headers: {\n          'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        imageData: this.state.generatedImageData,\n        style: newStyle,\n      }),\n    });\n\n    const msg = await response.json();\n    console.log(msg)\n    this.setState((prevState) => ({\n      ...prevState,\n      styleBrushType: newStyle,\n      stylizedImageData: msg.data,\n      displayedImageData: msg.data,\n    }));\n\n    this.setState((prevState) => ({\n      ...prevState,\n      isLoading: false,\n    }));\n\n  };\n  // xxxxx\n  saveGeneratedImage = () => {\n    if (this.refs.userCanvasRef == null) {\n      alert(\n        \"Unable to save the painting in AI Brush. Please select 'User Brush' or 'Style' or 'Filter' and try again.\"\n      );\n      return;\n    } else {\n      var getImage = this.refs.userCanvasRef.getBase64().then((value) => {\n        var resultImage = value.split(\";base64,\")[1];\n        var foregroundImageDataStripped =\n          this.state.displayedImageData.split(\";base64,\")[1];\n        this.setState((prevState) => ({\n          ...prevState,\n          isLoading: true,\n        }));\n        this.state.socket.send(\n          JSON.stringify({\n            kind: messageKinds.MESSAGE_SAVE,\n            data: {\n              displayedImageData: foregroundImageDataStripped,\n              userCanvasImageData: resultImage,\n              aiCanvasImageData: this.state.imageData,\n            },\n          })\n        );\n      });\n    }\n  };\n\n  handleThickness = (sliderValue) => {\n    this.setState((prevState) => ({\n      ...prevState,\n      thickness: sliderValue,\n      isChangeSize: true,\n    }));\n    console.log(\"thickness is now\", sliderValue);\n  };\n\n  handleThicknessEnd = (sliderValue) => {\n    this.setState((prevState) => ({\n      ...prevState,\n      isChangeSize: false,\n    }));\n    console.log(\"thickness is done chaging\", sliderValue);\n  };\n\n  handleOpacity = (sliderValue) => {\n    this.setState((prevState) => ({\n      ...prevState,\n      opacity: sliderValue,\n    }));\n    console.log(\"opacity is now\", sliderValue);\n  };\n\n  // Convert object of rgb {r: g: b:} to hex string\n  rgbToHex = (d) => {\n    const red = d.r;\n    const green = d.g;\n    const blue = d.b;\n    const rgb = (red << 16) | (green << 8) | (blue << 0);\n    return \"#\" + (0x1000000 + rgb).toString(16).slice(1);\n  };\n  hex2rgb = (hex) => {\n    const r = parseInt(hex.slice(1, 3), 16);\n    const g = parseInt(hex.slice(3, 5), 16);\n    const b = parseInt(hex.slice(5, 7), 16);\n    // return {r, g, b} // return an object\n    return { r: r, g: g, b: b, a: 1 };\n  };\n\n  // Enable the AI canvas for drawing\n  // Display the\n  enableAICanvas = () => {\n    if (this.state.showAICanvas) {\n      return;\n    }\n\n    // Save the drawcanvas and usercanvas data\n    var getImageUserCanvas = this.refs.userCanvasRef\n      .getBase64()\n      .then((usercanvas) => {\n        this.setState(\n          (prevState) => ({\n            ...prevState,\n            showAICanvas: true,\n            showInspireMode: false,\n            showUserCanvas: false,\n            userCanvasImageData: usercanvas,\n          }),\n          () => {\n            for (var i = 0; i < 2; i++) {\n              setTimeout(() => {\n                this.refs.drawCanvasRef.loadData(this.state.aiCanvasImageData);\n              }, 0);\n            }\n            this.refs.drawCanvasRef.loadData(this.state.aiCanvasImageData);\n          }\n        );\n\n        // Load the data base64\n      });\n  };\n\n  enableUserCanvas = () => {\n    if (this.state.showUserCanvas) {\n      return;\n    }\n\n    // Save the drawcanvas and usercanvas data\n    var getImageAICanvas = this.refs.drawCanvasRef\n      .getBase64()\n      .then((aicanvas) => {\n        this.setState(\n          (prevState) => ({\n            ...prevState,\n            showAICanvas: false,\n            showInspireMode: false,\n            showUserCanvas: true,\n            aiCanvasImageData: aicanvas,\n          }),\n          () => {\n            for (var i = 0; i < 2; i++) {\n              setTimeout(() => {\n                this.refs.userCanvasRef.loadData(\n                  this.state.userCanvasImageData\n                );\n              }, 0);\n            }\n          }\n        );\n        // Load the data base64\n      });\n  };\n\n  switchToAICanvas = () => {\n    this.setState((prevState) => ({\n      ...prevState,\n      currentBrush: brushTypes.AI,\n    }));\n    this.enableAICanvas();\n  }\n\n  switchToInspireMode = () => {\n    this.setState((prevState) => ({\n      ...prevState,\n      showInspireMode: true,\n      currentBrush: brushTypes.INSPIRE,\n    }));\n    // this.enableInspireMode();\n  }\n\n  switchToStyleBrush = () => {\n    this.setState((prevState) => ({\n      ...prevState,\n      currentBrush: brushTypes.STYLE,\n    }));\n    this.enableUserCanvas();\n  }\n\n  switchToFilterBrush = () => {\n    this.setState((prevState) => ({\n      ...prevState,\n      currentBrush: brushTypes.FILTER,\n    }));\n    this.enableUserCanvas();\n\n  }\n\n  switchToUserBrush = () => {\n    this.setState((prevState) => ({\n      ...prevState,\n      currentBrush: brushTypes.USER,\n    }));\n    // Display user canvas\n    this.enableUserCanvas();\n  }\n\n  render() {\n    let brushSlider = (\n      <View\n        style={{\n          backgroundColor: \"#f2f2eb\",\n          width: this.state.leftColumnWidth,\n          marginLeft: this.state.leftColumnLeftMargin,\n          borderRadius: 10,\n          flexDirection: \"column\",\n          padding: 5,\n        }}\n      >\n        <View>\n          <Text\n            style={{\n              textAlign: \"center\",\n              color: \"#363636\",\n              fontWeight: \"bold\",\n              fontSize: 16,\n              padding: 2,\n            }}\n          >\n            Size\n          </Text>\n        </View>\n\n        <Slider\n          style={{\n            width: device.height * 0.22,\n            margin: \"auto\",\n            height: device.height * 0.03,\n          }}\n          value={this.state.thickness}\n          minimumValue={1}\n          maximumValue={CANVASWIDTH / 4}\n          thumbTintColor=\"#4f4f4f\"\n          minimumTrackTintColor=\"#707070\"\n          maximumTrackTintColor=\"#cfcfcf\"\n          onValueChange={this.handleThickness}\n          onSlidingComplete={this.handleThicknessEnd}\n        />\n      </View>\n    );\n\n    // For ipad sizing\n    // prevent bouncing / scroll on ios\n    document.documentElement.style.height = \"100%\";\n    document.documentElement.style.overflow = \"hidden\";\n    document.body.style.height = \"100%\";\n    document.body.style.overflow = \"auto\";\n\n    return (\n      <View style={styles.container}>\n        {/* this View wraps the left column */}\n        <View\n          style={{\n            width: this.state.leftColumnLeftMargin + this.state.leftColumnWidth - 40,\n          }}\n        >\n          <TouchableOpacity\n            onPress={() => {\n              this.switchToAICanvas();\n            }}\n            disabled={this.state.disableButtons}\n          >\n            <Image\n              style={[\n                styles.brushes,\n                {\n                  height:\n                    this.state.currentBrush == brushTypes.AI\n                      ? device.height * 0.10\n                      : device.height * 0.08,\n                  width:\n                    this.state.currentBrush == brushTypes.AI\n                      ? device.height * 0.10 * 1.5\n                      : device.height * 0.08 * 1.5,\n                  opacity: this.state.currentBrush == brushTypes.AI ? 1 : 0.55,\n                },\n              ]}\n              source={require(\"./resources/AIBrush.png\")}\n            />\n          </TouchableOpacity>\n          <TouchableOpacity\n            onPress={() => {\n              this.switchToInspireMode();\n            }}\n            disabled={this.state.disableButtons}\n          >\n            <Image\n              style={[\n                styles.brushes,\n                {\n                  height:\n                    this.state.currentBrush == brushTypes.INSPIRE\n                      ? device.height * 0.10\n                      : device.height * 0.08,\n                  width:\n                    this.state.currentBrush == brushTypes.INSPIRE\n                      ? device.height * 0.10 * 1.5\n                      : device.height * 0.08 * 1.5,\n                  opacity: this.state.currentBrush == brushTypes.INSPIRE ? 1 : 0.55,\n                },\n              ]}\n              source={require(\"./resources/AIBrush.png\")}\n            />\n          </TouchableOpacity>\n          <TouchableOpacity\n            onPress={() => {\n              this.switchToStyleBrush();\n            }}\n            disabled={this.state.disableButtons}\n          >\n            <Image\n              style={[\n                styles.brushes,\n                {\n                  height:\n                    this.state.currentBrush == brushTypes.STYLE\n                      ? device.height * 0.10\n                      : device.height * 0.08,\n                  width:\n                    this.state.currentBrush == brushTypes.STYLE\n                      ? device.height * 0.10 * 1.5\n                      : device.height * 0.08 * 1.5,\n                  opacity:\n                    this.state.currentBrush == brushTypes.STYLE ? 1 : 0.55,\n                },\n              ]}\n              source={require(\"./resources/styleBrush.png\")}\n            />\n          </TouchableOpacity>\n          <TouchableOpacity\n            onPress={() => {\n              this.switchToFilterBrush();\n            }}\n            disabled={this.state.disableButtons}\n          >\n            <Image\n              style={[\n                styles.brushes,\n                {\n                  height:\n                    this.state.currentBrush == brushTypes.FILTER\n                      ? device.height * 0.10\n                      : device.height * 0.08,\n                  width:\n                    this.state.currentBrush == brushTypes.FILTER\n                      ? device.height * 0.10 * 1.5\n                      : device.height * 0.08 * 1.5,\n                  opacity:\n                    this.state.currentBrush == brushTypes.FILTER ? 1 : 0.55,\n                },\n              ]}\n              source={require(\"./resources/filterBrush.png\")}\n            />\n          </TouchableOpacity>\n          <TouchableOpacity\n            onPress={() => {\n              this.switchToUserBrush();\n            }}\n            disabled={this.state.disableButtons}\n          >\n            <Image\n              style={[\n                styles.brushes,\n                {\n                  height:\n                    this.state.currentBrush == brushTypes.USER\n                      ? device.height * 0.10\n                      : device.height * 0.08,\n                  width:\n                    this.state.currentBrush == brushTypes.USER\n                      ? device.height * 0.10 * 1.5\n                      : device.height * 0.08 * 1.5,\n                  opacity:\n                    this.state.currentBrush == brushTypes.USER ? 1 : 0.55,\n                },\n              ]}\n              source={require(\"./resources/userBrush.png\")}\n            />\n          </TouchableOpacity>\n\n          {this.state.currentBrush == brushTypes.AI && (\n            <View>{brushSlider}</View>\n          )}\n          {this.state.currentBrush == brushTypes.USER && (\n            <View>\n              <RgbaColorPicker\n                style={{\n                  marginLeft: this.state.leftColumnLeftMargin,\n                  marginBottom: 3,\n                  width: this.state.leftColumnWidth,\n                  height: this.state.leftColumnWidth,\n                }}\n                color={this.state.colorPickerDisplay}\n                onChange={(color) => {\n\n                  this.setState((prevState) => ({\n                    ...prevState,\n                    userBrushColor: this.rgbToHex(color),\n                    opacity: color.a,\n                    colorPickerDisplay: color,\n                  }));\n                  // sendSwitchUserBrush(this.state.socket,this.state.userBrushType,this.rgbToHex(color))\n\n                }}\n              />\n              {brushSlider}\n            </View>\n          )}\n          {/* Save painting button */}\n          {/* <View\n            style={{ padding: \"1em\", marginTop: \"10px\", marginBottom: \"10px\" }}\n          >\n            <Button\n              color=\"#717591\"\n              title=\"Save Painting\"\n              onPress={() => this.saveGeneratedImage()}\n            />\n          </View> */}\n        </View>\n\n        {/* this View wraps middle column */}\n        <View style={{ flexDirection: \"column\", display: this.state.currentBrush == brushTypes.INSPIRE ? \"none\" : \"block\" }} >\n          {/* this View wraps around the buttons that changes canva view & camera*/}\n          <View\n            style={{\n              flexDirection: \"row\",\n              paddingTop: device.height * 0.01,\n              alignContent: \"flex-end\",\n              marginLeft: \"auto\",\n            }}\n          ></View>\n\n          {/* this View wraps the two canvas */}\n          <View style={{ flexDirection: \"row\" }}>\n            {/* Canvas previews */}\n            {/* Show the user canvas if we are in the AI canvas main view */}\n            {this.state.showAICanvas && this.state.showPreview && (\n              <View\n                style={[\n                  styles.shadowBoxAICanvas,\n                  {\n                    width: this.state.USER_CANVASHEIGHT / 1.5,\n                    height: this.state.USER_CANVASHEIGHT / 1.5,\n                    marginRight: 5,\n                  },\n                ]}\n              >\n                <ImageBackground\n                  source={this.state.displayedImageData}\n                  style={{ filter: this.state.imageFilter }}\n                >\n                  <Image\n                    style={[\n                      {\n                        width: this.state.USER_CANVASHEIGHT / 1.5,\n                        height: this.state.USER_CANVASHEIGHT / 1.5,\n                      },\n                    ]}\n                    source={this.state.userCanvasImageData}\n                  />\n                </ImageBackground>\n              </View>\n            )}\n            {/* AI Brush preview */}\n            {!this.state.showAICanvas && this.state.showPreview && (\n              // {this.state.showUserCanvas && this.state.showPreview && (\n\n              <View\n                style={[\n                  styles.shadowBoxAICanvas,\n                  {\n                    width: this.state.USER_CANVASHEIGHT / 1.5,\n                    height: this.state.USER_CANVASHEIGHT / 1.5,\n                    marginRight: 5,\n                  },\n                ]}\n              >\n                <Image\n                  style={{\n                    width: this.state.USER_CANVASHEIGHT / 1.5,\n                    height: this.state.USER_CANVASHEIGHT / 1.5,\n                  }}\n                  source={this.state.aiCanvasImageData}\n                />\n              </View>\n            )}\n\n            {/* this wraps the middle big canvas and buttons */}\n            <View style={{ flexDirection: \"column\" }}>\n              {/* this View warps AI canvas */}\n              {this.state.showAICanvas && (\n                <View id=\"drawGroup\" style={styles.drawGroup}>\n                  <View\n                    style={[\n                      styles.shadowBoxAICanvas,\n                      {\n                        width: this.state.AI_CANVASWIDTH,\n                        height: this.state.AI_CANVASHEIGHT,\n                      },\n                    ]}\n                  >\n                    <DrawCanvas\n                      ref=\"drawCanvasRef\"\n                      setClickClear={(click) =>\n                        (this.clearChildAIBrush = click)\n                      }\n                      style={{\n                        backgroundColor: \"black\",\n                        position: \"absolute\",\n                        background: \"transparent\",\n                      }}\n                      brushType={this.state.currentBrush}\n                      thickness={this.state.thickness}\n                      color={this.state.color}\n                      // socket={this.state.socket}\n                      otherStrokes={this.state.collaboratorStroke}\n                      width={this.state.AI_CANVASWIDTH}\n                      height={this.state.AI_CANVASHEIGHT}\n                      opacity={1}\n                      disable={this.state.disableDrawing}\n                      isFirstLoadDrawCanvas={this.state.isFirstLoadDrawCanvas}\n                    />\n                  </View>\n                  \n                </View>\n              )}\n              {/* this View wraps generated image & user canvas */}\n              {this.state.showUserCanvas && (\n                <View id=\"drawGroup\" style={styles.drawGroup}>\n                  {/* Displayed image */}\n                  <View\n                    style={[\n                      styles.generatedImageBox,\n                      {\n                        width: this.state.USER_CANVASWIDTH,\n                        height: this.state.USER_CANVASHEIGHT,\n                      },\n                    ]}\n                  >\n                    {this.state.displayedImageData != null ? (\n                      <Image\n                        draggable={false}\n                        style={[\n                          styles.generatedImage,\n                          { filter: this.state.imageFilter },\n                        ]}\n                        source={{ uri: this.state.displayedImageData }}\n                      />\n                    ) : null}\n                  </View>\n                  {/* Main canvas */}\n                  {/* Conditionally render the main canvas if toggleDraw == true */}\n                  <View\n                    style={[\n                      styles.shadowBox,\n                      {\n                        width: this.state.USER_CANVASWIDTH,\n                        height: this.state.USER_CANVASHEIGHT,\n                      },\n                    ]}\n                  >\n                    {/* USER CANVAS */}\n                    <UserCanvas\n                      ref=\"userCanvasRef\"\n                      setClickClear={(click) =>\n                        (this.clearChildUserBrush = click)\n                      }\n                      style={{\n                        position: \"absolute\",\n                        background: \"transparent\",\n                      }}\n                      brushType={this.state.currentBrush}\n                      userBrushType={this.state.userBrushType}\n                      thickness={this.state.thickness}\n                      color={this.state.userBrushColor}\n                      // socket={this.state.socket}\n                      otherStrokes={this.state.collaboratorStroke}\n                      width={this.state.USER_CANVASWIDTH}\n                      height={this.state.USER_CANVASHEIGHT}\n                      opacity={this.state.opacity}\n                      disable={this.state.disableDrawing}\n                      id=\"myCanvas\"\n                    />\n                  </View>\n                </View>\n              )}\n\n              {/* this wraps the buttons at the bottom of canvas */}\n              {this.state.currentBrush == brushTypes.AI && (\n                <View\n                  style={{\n                    flexDirection: \"column\",\n                    justifyContent: \"space-around\",\n                  }}\n                >\n                  <TextInput\n                    style={styles.input}\n                    placeholder=\"文字描述\"\n                    onChangeText={(text) => this.setState({text})}\n                    value={this.state.text}\n                  />\n                  <View style={{\n                    flexDirection: \"row\",\n                    justifyContent: \"space-around\",\n                  }}> \n                    <View style={{ padding: 5, width: \"20%\" }}>\n                      <Button\n                        style={{ marginTop: 10, height: \"80\" }}\n                        color=\"#5e748a\"\n                        title=\"clear\"\n                        onPress={() => this.clearChildAIBrush()}\n                      />\n                    </View>\n\n                    <View style={{ padding: 5, width: \"20%\" }}>\n                      <Button\n                        mode=\"contained\"\n                        style={{ padding: 10 }}\n                        onPress={this.grabPixelsGan.bind(this)}\n                        color=\"#88508c\"\n                        title=\"GauGAN\"\n                        disabled={this.state.isLoading}\n                      />\n                    </View>\n\n                    <View style={{ padding: 5, width: \"30%\" }}>\n                      <Button\n                        mode=\"contained\"\n                        style={{ padding: 10 }}\n                        onPress={this.grabPixelsSd.bind(this)}\n                        color=\"#88508c\"\n                        title=\"Stable Diffusion\"\n                        disabled={this.state.isLoading}\n                      />\n                    </View>\n\n                    <View style={{ padding: 5, width: \"25%\" }}>\n                      <Button\n                        mode=\"contained\"\n                        style={{ padding: 10 }}\n                        onPress={this.grabPixelsCN.bind(this)}\n                        color=\"#88508c\"\n                        title=\"Control Net\"\n                        disabled={this.state.isLoading}\n                      />\n                    </View>\n                  </View>\n                </View>\n              )}\n              {this.state.currentBrush == brushTypes.USER && (\n                <View\n                  style={{\n                    flexDirection: \"row\",\n                    justifyContent: \"space-around\",\n                  }}\n                >\n                  <View style={{ padding: 5, width: \"40%\" }}>\n                    <Button\n                      color=\"#717591\"\n                      title=\"clear strokes\"\n                      onPress={() => this.clearChildUserBrush()}\n                    />\n                  </View>\n                </View>\n              )}\n            </View>\n          </View>\n        </View>\n        \n        <View style={{ flexDirection: \"row\", display: this.state.currentBrush == brushTypes.INSPIRE ? \"block\" : \"none\", width: \"80%\" }}>\n            {/* {this.state.currentBrush == brushTypes.INSPIRE && ( */}\n              <View>\n                <InspireMode localurl={LOCALURL}>\n                </InspireMode>\n              </View>\n            {/* )} */}\n          </View>\n\n        {/* this View wraps the right column */}\n        <View style={{ flexDirection: \"row\" }}>\n          {/* AI brush palette buttons */}\n          {this.state.currentBrush == brushTypes.AI && (\n            <View style={styles.brushesContainer}>\n              <ScrollView>\n                {colorMap.colors.map((obj) => {\n                  return (\n                    <View style={{ margin: 2 }}>\n                      <TouchableOpacity\n                        style={{\n                          padding: 2,\n                          borderRadius: 5,\n                          backgroundColor: obj.color,\n                          borderWidth: this.state.color == obj.color ? 10 : 0,\n                          borderColor: \n                            obj.color == \"#efefef\" ? \"#d1d1d1\" : \"#f2f2eb\",\n\n                          // backgroundColor:\n                          //   this.state.color == obj.color\n                          //     ? \"#3d3d3d\"\n                          //     : \"#dbdbdb\", //obj.color == \"#efefef\" ? \"#dbdbdb\" : \"white\",\n                        }}\n                        onPress={() => {\n                          this.setState({ color: obj.color });\n                        }}\n                        disabled={this.state.disableButtons}\n                      >\n                        <Image\n                          draggable={false}\n                          style={styles.brushes}\n                          source={obj.logo}\n                        />\n                        <Text\n                          style={{\n                            fontSize: device.height * 0.012,\n                            color: obj.color == \"#efefef\" ? \"#3d3d3d\" : \"white\",\n\n                            // color:\n                            //   this.state.color == obj.color ? \"white\" : \"black\",\n                            // fontWeight: \"500\",\n                          }}\n                        >\n                          {obj.label}\n                        </Text>\n                      </TouchableOpacity>\n                    </View>\n                  );\n                })}\n              </ScrollView>\n\n              {/* Render the slider and the brush legend */}\n            </View>\n          )}\n\n          {/* Style buttons */}\n          {this.state.currentBrush == brushTypes.STYLE && (\n            <View style={styles.brushesContainer}>\n              <ScrollView>\n                {/* None style button */}\n                <View style={{ margin: 2 }}>\n                  <TouchableOpacity\n                    style={[\n                      styles.functionButton,\n                      {\n                        backgroundColor:\n                          this.state.styleBrushType == \"None\"\n                            ? \"#3d3d3d\"\n                            : \"#dbdbdb\",\n                      },\n                    ]}\n                    onPress={() => {\n                      this.setState((prevState) => ({\n                        ...prevState,\n                        displayedImageData: this.state.generatedImageData,\n                        styleBrushType: \"None\",\n                      }));\n                    }}\n                    disabled={this.state.disableButtons}\n                  >\n                    <Image\n                      style={styles.brushes}\n                      source={require(\"./resources/none_style.png\")}\n                    />\n                    <Text\n                      style={{\n                        color:\n                          this.state.styleBrushType == \"None\"\n                            ? \"white\"\n                            : \"black\",\n                        fontSize: device.height * 0.015,\n                        fontWeight: \"500\",\n                      }}\n                    >\n                      {\" \"}\n                      None{\" \"}\n                    </Text>\n                  </TouchableOpacity>\n                </View>\n                {/* Programmatically render all style options */}\n                {styleTransferOptions.styles.map((obj) => {\n                  return (\n                    <View style={{ margin: 2 }}>\n                      <TouchableOpacity\n                        disabled={this.state.disableButtons}\n                        style={[\n                          styles.functionButton,\n                          {\n                            backgroundColor:\n                              this.state.styleBrushType == obj.name\n                                ? \"#3d3d3d\"\n                                : \"#dbdbdb\",\n                          },\n                        ]}\n                        onPress={() => {\n                          this.sendRequestStyleHelper(obj.name);\n                          this.setState((prevState) => ({\n                            styleBrushType: obj.name,\n                          }));\n                        }}\n                      >\n                        <Image style={styles.brushes} source={obj.image_url} />\n                        <Text\n                          style={{\n                            color:\n                              this.state.styleBrushType == obj.name\n                                ? \"white\"\n                                : \"black\",\n                            fontSize: device.height * 0.015,\n                            fontWeight: \"500\",\n                          }}\n                        >\n                          {obj.label}\n                        </Text>\n                      </TouchableOpacity>\n                    </View>\n                  );\n                })}\n              </ScrollView>\n            </View>\n          )}\n\n          {/* Filter buttons */}\n          {this.state.currentBrush == brushTypes.FILTER && (\n            <View style={styles.brushesContainer}>\n              <ScrollView>\n                {/* None filter button */}\n                <View style={{ margin: 2 }}>\n                  <TouchableOpacity\n                    style={[\n                      styles.functionButton,\n                      {\n                        backgroundColor:\n                          this.state.filterBrushType == \"None\"\n                            ? \"#3d3d3d\"\n                            : \"#dbdbdb\",\n                      },\n                    ]}\n                    onPress={() => {\n                      this.setState((prevState) => ({\n                        ...prevState,\n                        imageFilter: \"\",\n                        filterBrushType: \"None\",\n                      }));\n                      // sendSwitchFilter(this.state.socket, \"\", \"None\")\n                    }}\n                    disabled={this.state.disableButtons}\n                  >\n                    <Image\n                      style={styles.brushes}\n                      source={require(\"./resources/none_style.png\")}\n                    />\n                    <Text\n                      style={{\n                        color:\n                          this.state.filterBrushType == \"None\"\n                            ? \"white\"\n                            : \"black\",\n                        fontSize: device.height * 0.015,\n                        fontWeight: \"500\",\n                      }}\n                    >\n                      {\" \"}\n                      None{\" \"}\n                    </Text>\n                  </TouchableOpacity>\n                </View>\n                {/* Programmatically render all filter options */}\n                {filterOptions.filters.map((obj) => {\n                  return (\n                    <View style={{ margin: 2 }}>\n                      <TouchableOpacity\n                        disabled={this.state.disableButtons}\n                        style={[\n                          styles.functionButton,\n                          {\n                            backgroundColor:\n                              this.state.filterBrushType == obj.name\n                                ? \"#3d3d3d\"\n                                : \"#dbdbdb\",\n                          },\n                        ]}\n                        onPress={() => {\n                          this.setState((prevState) => ({\n                            imageFilter: obj.filter,\n                            filterBrushType: obj.name,\n                          }));\n                          // sendSwitchFilter(this.state.socket, obj.filter, obj.name)\n                        }}\n                      >\n                        <Image style={styles.brushes} source={obj.image_url} />\n                        <Text\n                          style={{\n                            color:\n                              this.state.filterBrushType == obj.name\n                                ? \"white\"\n                                : \"black\",\n                            fontSize: device.height * 0.015,\n                            fontWeight: \"500\",\n                          }}\n                        >\n                          {obj.label}\n                        </Text>\n                      </TouchableOpacity>\n                    </View>\n                  );\n                })}\n              </ScrollView>\n            </View>\n          )}\n        </View>\n\n        {/* User Brush buttons */}\n        {this.state.currentBrush == brushTypes.USER && (\n          <View style={styles.brushesContainer}>\n            {/* <View style={{ height: device.height * 0.4 }}> */}\n            <ScrollView>\n              {/* Programmatically render all options */}\n              {userBrushesOptions.userBrushes.map((obj) => {\n                return (\n                  <View style={{ margin: 2 }}>\n                    <TouchableOpacity\n                      style={[\n                        styles.functionButton,\n                        {\n                          backgroundColor:\n                            this.state.userBrushType == obj.name\n                              ? \"#3d3d3d\"\n                              : \"white\",\n                        },\n                      ]}\n                      onPress={() => {\n                        this.setState((prevState) => ({\n                          ...prevState,\n                          userBrushType: obj.name,\n                        }));\n                        // sendSwitchUserBrush(this.state.socket,obj.name,this.state.userBrushColor)\n                      }}\n                    >\n                      <Image\n                        style={styles.userBrushes}\n                        source={obj.image_url}\n                      />\n                      <Text\n                        style={{\n                          color:\n                            this.state.userBrushType == obj.name\n                              ? \"white\"\n                              : \"#2e2e2e\",\n                          fontSize: device.height * 0.015,\n                        }}\n                      >\n                        {obj.label}\n                      </Text>\n                    </TouchableOpacity>\n                  </View>\n                );\n              })}\n            </ScrollView>\n            {/* </View> */}\n          </View>\n        )}\n\n        {/* this View wraps the spinner */}\n        {/* Spinner is recommended to be at the root level */}\n        <View style={styles.spinnerContainer}>\n          <ActivityIndicator\n            animating={this.state.isLoading}\n            size={\"large\"}\n            color={\"#545454\"}\n            style={{ transform: [{ scale: 3 }] }}\n          />\n        </View>\n\n        {/* this View wraps the size indicator */}\n        {this.state.isChangeSize == true && (\n          <View style={styles.circleContainer}>\n            <Text style={{ color: \"#4d4d4d\", fontWeight: \"bold\" }}>\n              Size Preview:\n            </Text>\n            <Ionicons\n              style={{\n                opacity: this.state.opacity,\n                justifyContent: \"center\",\n                alignItems: \"center\",\n                margin: \"auto\",\n              }}\n              name=\"ellipse\"\n              color={\n                this.state.currentBrush == brushTypes.USER\n                  ? this.state.userBrushColor\n                  : this.state.color\n              }\n              size={this.state.thickness * 1.2}\n            ></Ionicons>\n          </View>\n        )}\n      </View>\n    );\n  }\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    backgroundColor: \"white\",\n  },\n  generatedImageBox: {\n    userDrag: \"none\",\n    userSelect: \"none\",\n    backgroundColor: \"transparent\",\n    position: \"absolute\",\n  },\n  generatedImage: {\n    width: \"100%\",\n    height: \"100%\",\n    userDrag: \"none\",\n    userSelect: \"none\",\n  },\n  shadowBoxAICanvas: {\n    shadowColor: \"grey\",\n    shadowRadius: 20,\n    position: \"relative\",\n  },\n  shadowBox: {\n    shadowColor: \"grey\",\n    shadowRadius: 20,\n    position: \"relative\",\n  },\n  functionButton: {\n    padding: 4,\n    borderRadius: 5,\n  },\n\n  drawGroup: {\n    flexDirection: \"row\",\n    // alignItems: \"center\",\n    // justifyContent: \"center\",\n  },\n  strokeGroup: {\n    flexDirection: \"column\",\n    alignItems: \"center\",\n  },\n  toolGroup: {\n    flexDirection: \"row\",\n    justifyContent: \"space-around\",\n  },\n  brushes: {\n    margin: 0,\n    height: device.height * 0.06,\n    width: device.height * 0.06 * 1.8,\n    padding: 0,\n    userDrag: \"none\",\n    userSelect: \"none\",\n  },\n  donwloadButton: {\n    margin: 0,\n    height: device.height * 0.145 * 0.4,\n    width: device.height * 0.145 * 0.41,\n    padding: 0,\n    userDrag: \"none\",\n    userSelect: \"none\",\n  },\n  brushesContainer: {\n    flexDirection: \"column\",\n    justifyContent: \"space-around\",\n    alignItems: \"center\",\n    height: device.height,\n    borderLeftColor: \"#C8C8C8\",\n    backgroundColor: \"#f2f2eb\",\n    borderLeftWidth: 3,\n  },\n  userBrushes: {\n    justifyContent: \"start\",\n    margin: 0,\n    height: device.height * 0.06,\n    width: device.height * 0.06 * 1.8,\n    paddingTop: 0,\n  },\n  spinnerTextStyle: {\n    color: \"transparent\",\n  },\n  spinnerContainer: {\n    position: \"absolute\",\n    flex: 1,\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    backgroundColor: \"transparent\",\n    left: device.width / 2,\n    top: device.height / 2.5,\n  },\n  circleContainer: {\n    height: device.height * 0.35,\n    width: device.height * 0.3,\n    marginBottom: \"0.5em\",\n    position: \"absolute\",\n    flex: 1,\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    backgroundColor: \"rgba(245, 245, 237, 0.8)\",\n    borderRadius: 10,\n    left: device.width / 2,\n    top: device.height / 3,\n  },\n\n  swatch: {\n    padding: \"5px\",\n    background: \"#fff\",\n    borderRadius: \"1px\",\n    boxShadow: \"0 0 0 1px rgba(0,0,0,.1)\",\n    display: \"inline-block\",\n    cursor: \"pointer\",\n  },\n  popover: {\n    position: \"absolute\",\n    zIndex: \"2\",\n  },\n  cover: {\n    position: \"fixed\",\n    top: \"0px\",\n    right: \"0px\",\n    bottom: \"0px\",\n    left: \"0px\",\n  },\n  color: {\n    width: \"36px\",\n    height: \"14px\",\n    borderRadius: \"2px\",\n  },\n  Cat: {\n    color: \"pink\",\n    backgroundColor: \"pink\",\n  },\n  input: {\n    height: 45,\n    margin: 12,\n    borderRadius: 5,\n    borderWidth: 1,\n    padding: 8,\n  },\n});\n","import 'react-native-gesture-handler';\nimport { registerRootComponent } from 'expo';\n\nimport App from './App';\n\n// registerRootComponent calls AppRegistry.registerComponent('main', () => App);\n// It also ensures that whether you load the app in Expo Go or in a native build,\n// the environment is set up appropriately\nregisterRootComponent(App);\n"],"sourceRoot":""}